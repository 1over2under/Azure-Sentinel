id: cc8aeea6-07a2-430a-808e-41ad5b91f08d
displayName: NetworkSummary_Threat_Severity_Action
description: |
  'This summary rule aggregates recent network session data using the ASIM normalized _Im_NetworkSession function. It creates 20-minute summaries grouped by threat identifier or name, threat category, event severity, and device action. This enables efficient monitoring of threat-related network activity and supports detection of patterns across severity levels and response actions.'
destinationTable: NetworkSummary_Threat_CL
query: |
  _Im_NetworkSession(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m))
  | where TimeGenerated < bin(nowTime,20m)
  | extend Threat = coalesce(ThreatId, ThreatName)
  | where isnotempty(Threat) or isnotempty(ThreatCategory)
  | summarize count() by Threat, ThreatCategory, EventSeverity, DvcAction, bin(TimeGenerated, 20m)
  | extend EventTime = TimeGenerated
binSize: 20
version: 1.0.0