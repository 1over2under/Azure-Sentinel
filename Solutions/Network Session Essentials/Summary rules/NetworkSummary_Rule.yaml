id: a31660b8-b5a1-4b0e-9341-b9b132efa9a7
displayName: NetworkSummary_Rule_Direction_Action
description: |
  'This summary rule aggregates recent network session data using the ASIM normalized _Im_NetworkSession function. It creates 20-minute summaries grouped by rule name, network direction, and device action. This helps track which rules are generating traffic events and supports analysis of rule effectiveness and policy enforcement.'
destinationTable: NetworkSummary_Rule_CL
query: |
  _Im_NetworkSession(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m))
  | where TimeGenerated < bin(nowTime,20m)
  | summarize count() by Rule, NetworkDirection, DvcAction, bin(TimeGenerated, 20m)
  | extend EventTime = TimeGenerated
binSize: 20
version: 1.0.0