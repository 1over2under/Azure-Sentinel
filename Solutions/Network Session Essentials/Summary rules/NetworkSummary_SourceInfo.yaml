id: 81337036-2a9c-4677-a426-f2fbd79c346f
displayName: NetworkSession EventProduct Summary
description: |
  'This summary rule aggregates recent network session data using the ASIM normalized _Im_NetworkSession function. It creates 20-minute summaries grouped by product name (vendor-product combination) and device hostname. This helps identify which products and hosts are actively generating network session events in near real time.'
destinationTable: NetworkSummary_SourceInfo_CL
query: |
  union isfuzzy=true
  _Im_NetworkSession_EmptyV03,
  _Im_NetworkSession_AppGateSDPV02(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_AWSVPCV03(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_CheckPointFirewallV11(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_CiscoASAV10(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_CiscoFirepowerV01(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_CiscoISEV11(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_ForcePointFirewallV01(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_FortinetFortiGateV04(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_Microsoft365DefenderV04(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_LinuxSysmonV04(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_MicrosoftWindowsEventFirewallV04(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_NativeV03(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_PaloAltoCEFV07(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_SonicWallFirewallV01(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_VMConnectionV02(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_WatchGuardFirewareOSV01(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m)),
  _Im_NetworkSession_ZscalerZIAV04(starttime=bin(now(-20m), 20m), endtime=bin(now(), 20m))
    | where TimeGenerated < bin(now(),20m)
    | extend EventProduct = strcat(EventVendor, "-", EventProduct)
    | summarize count() by EventProduct, DvcHostname, bin(TimeGenerated, 20m)
    | extend EventTime = TimeGenerated
binSize: 20
version: 1.0.0