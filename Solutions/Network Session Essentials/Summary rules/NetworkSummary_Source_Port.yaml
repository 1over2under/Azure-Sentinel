id: 1347d3bc-080a-49bf-a1f0-b430a5fa6475
displayName: NetworkSession Source Port Summary
description: |
  'This summary rule aggregates network session data using the ASIM normalized _Im_NetworkSession function. It creates hourly summaries of traffic grouped by source port, network direction, and device action. The output helps identify traffic patterns by port usage and action types over time, enabling efficient detection of unusual behavior or port-based anomalies.'
destinationTable: NetworkSummary_Source_Port_CL
query: |
  _Im_NetworkSession(starttime=bin(now(-1h), 1h), endtime=bin(now(), 1h))
  | where TimeGenerated < bin(nowTime,1h)
  | summarize count() by SrcPortNumber, NetworkDirection, DvcAction, bin(TimeGenerated, 1h)
  | extend EventTime = TimeGenerated
binSize: 60
version: 1.0.0