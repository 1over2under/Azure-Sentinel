{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "Netskope",
    "comments": "Solution template for Netskopev2"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    },
    "workbook1-name": {
      "type": "string",
      "defaultValue": "NetskopeDashboard",
      "minLength": 1,
      "metadata": {
        "description": "Name for the workbook"
      }
    },
    "resourceGroupName": {
      "type": "string",
      "defaultValue": "[resourceGroup().name]",
      "metadata": {
        "description": "resource group name where Microsoft Sentinel is setup"
      }
    },
    "subscription": {
      "type": "string",
      "defaultValue": "[last(split(subscription().id, '/'))]",
      "metadata": {
        "description": "subscription id where Microsoft Sentinel is setup"
      }
    }
  },
  "variables": {
    "_solutionName": "Netskopev2",
    "_solutionVersion": "3.0.0",
    "solutionId": "netskope.netskope_mss",
    "_solutionId": "[variables('solutionId')]",
    "workbookVersion1": "1.0.0",
    "workbookContentId1": "NetskopeDashboard",
    "workbookId1": "[resourceId('Microsoft.Insights/workbooks', variables('workbookContentId1'))]",
    "workbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-wb-',uniquestring(variables('_workbookContentId1'))))]",
    "_workbookContentId1": "[variables('workbookContentId1')]",
    "workspaceResourceId": "[resourceId('microsoft.OperationalInsights/Workspaces', parameters('workspace'))]",
    "_workbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','wb','-', uniqueString(concat(variables('_solutionId'),'-','Workbook','-',variables('_workbookContentId1'),'-', variables('workbookVersion1'))))]",
    "NetskopeDataConnectorsTriggerSync": "NetskopeDataConnectorsTriggerSync",
    "_NetskopeDataConnectorsTriggerSync": "[variables('NetskopeDataConnectorsTriggerSync')]",
    "TemplateEmptyArray": "[json('[]')]",
    "playbookVersion1": "1.0",
    "playbookContentId1": "NetskopeDataConnectorsTriggerSync",
    "_playbookContentId1": "[variables('playbookContentId1')]",
    "playbookId1": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId1'))]",
    "playbookTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId1'))))]",
    "_playbookcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId1'),'-', variables('playbookVersion1'))))]",
    "blanks": "[replace('b', 'b', '')]",
    "NetskopeWebTxErrorEmail": "NetskopeWebTxErrorEmail",
    "_NetskopeWebTxErrorEmail": "[variables('NetskopeWebTxErrorEmail')]",
    "playbookVersion2": "1.0",
    "playbookContentId2": "NetskopeWebTxErrorEmail",
    "_playbookContentId2": "[variables('playbookContentId2')]",
    "playbookId2": "[resourceId('Microsoft.Logic/workflows', variables('playbookContentId2'))]",
    "playbookTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-pl-',uniquestring(variables('_playbookContentId2'))))]",
    "_playbookcontentProductId2": "[concat(take(variables('_solutionId'),50),'-','pl','-', uniqueString(concat(variables('_solutionId'),'-','Playbook','-',variables('_playbookContentId2'),'-', variables('playbookVersion2'))))]",
    "uiConfigId1": "NetskopeDataConnector",
    "_uiConfigId1": "[variables('uiConfigId1')]",
    "dataConnectorContentId1": "NetskopeDataConnector",
    "_dataConnectorContentId1": "[variables('dataConnectorContentId1')]",
    "dataConnectorId1": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
    "_dataConnectorId1": "[variables('dataConnectorId1')]",
    "dataConnectorTemplateSpecName1": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId1'))))]",
    "dataConnectorVersion1": "1.0.0",
    "_dataConnectorcontentProductId1": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId1'),'-', variables('dataConnectorVersion1'))))]",
    "uiConfigId2": "NetskopeWebTransactionsDataConnector",
    "_uiConfigId2": "[variables('uiConfigId2')]",
    "dataConnectorContentId2": "NetskopeWebTransactionsDataConnector",
    "_dataConnectorContentId2": "[variables('dataConnectorContentId2')]",
    "dataConnectorId2": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId2'))]",
    "_dataConnectorId2": "[variables('dataConnectorId2')]",
    "dataConnectorTemplateSpecName2": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentId2'))))]",
    "dataConnectorVersion2": "1.0.0",
    "_dataConnectorcontentProductId2": "[concat(take(variables('_solutionId'),50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentId2'),'-', variables('dataConnectorVersion2'))))]",
    "dataConnectorCCPVersion": "1.0.0",
    "_dataConnectorContentIdConnectorDefinition3": "NetskopeCCP",
    "dataConnectorTemplateNameConnectorDefinition3": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnectorDefinition3')))]",
    "_dataConnectorContentIdConnections3": "NetskopeCCPConnections",
    "dataConnectorTemplateNameConnections3": "[concat(parameters('workspace'),'-dc-',uniquestring(variables('_dataConnectorContentIdConnections3')))]",
    "dataCollectionEndpointId3": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]",
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('workbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "NetskopeDashboard Workbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('workbookVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "type": "Microsoft.Insights/workbooks",
              "name": "[variables('workbookContentId1')]",
              "location": "[parameters('workspace-location')]",
              "kind": "shared",
              "apiVersion": "2021-08-01",
              "metadata": {
                "description": "A workbook providing insights into Netskope Alerts, Events and WebTransactions."
              },
              "properties": {
                "displayName": "[parameters('workbook1-name')]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"bea257bd-19ed-4afd-b2db-817eb5aced6f\",\"cellValue\":\"view\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Application Overview\",\"subTarget\":\"tab1\",\"style\":\"link\"},{\"id\":\"61b82b1b-1290-4757-b181-a3fa015b5aae\",\"cellValue\":\"view\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Alert Overview\",\"subTarget\":\"tab2\",\"style\":\"link\"},{\"id\":\"d33934aa-be63-4925-826c-54dcc185e4c9\",\"cellValue\":\"view\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Web Transactions Overview\",\"subTarget\":\"tab3\",\"style\":\"link\"}]},\"name\":\"links - 2\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"66dab7e6-5f19-48d6-b11c-5a94f84dafdb\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000},\"label\":\"Time Range\"}],\"style\":\"pills\",\"doNotRunWhenHidden\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"TimeRange\",\"comparison\":\"isNotEqualTo\",\"value\":\"None\"},\"name\":\"parameters - 11\",\"styleSettings\":{\"margin\":\"5px\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication\\n| where isnotempty(App)\\n| summarize arg_max(TimeGenerated,*) by Id\\n| summarize Count = count() by Application = App\\n| sort by Count desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top Applications By Usage\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"Application\",\"exportParameterName\":\"ApplicationName1\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"rowLimit\":10000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"$gen_bar_Count_1\",\"sortOrder\":2}]},\"sortBy\":[{\"itemKey\":\"$gen_bar_Count_1\",\"sortOrder\":2}]},\"customWidth\":\"50\",\"name\":\"Top Applications By Usage\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where App == '{ApplicationName1}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by User\\r\\n| top 50 by Count\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 50 Users Of {ApplicationName1}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"50\",\"conditionalVisibility\":{\"parameterName\":\"ApplicationName1\",\"comparison\":\"isNotEqualTo\",\"value\":\"\"},\"name\":\"Top 50 Users Of Application : {ApplicationName1}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where isnotempty(App)\\r\\n| summarize arg_max(TimeGenerated,*) by App\\r\\n| sort by CCI desc\\r\\n| project Application = App, ['CCI SCORE'] = CCI\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top Applications By CCI Score\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"Application\",\"exportParameterName\":\"ApplicationName2\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"CCI SCORE\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\"Top Applications By CCI Score\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where App == '{ApplicationName2}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by User\\r\\n| top 50 by Count\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 50 Users Of {ApplicationName2}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"50\",\"conditionalVisibility\":{\"parameterName\":\"ApplicationName2\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Top 50 Users Of {ApplicationName2}\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 _Click on a row in the above 'Top Applications By Usage' and 'Top Applications By CCI score' grid to view more details_\\r\\n\"},\"name\":\"text - 24\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where isnotempty(AppCategory)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by AppCategory\\r\\n| sort by Count desc\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top Categories\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"CategoryName\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true},\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"Top Categories\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where isnotempty(Browser)\\r\\n| summarize arg_max(TimeGenerated,*) by Id   \\r\\n| summarize Count = count() by Browser\\r\\n| sort by Count desc\",\"size\":3,\"showAnalytics\":true,\"title\":\"Browser Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"BrowserName\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"Browser Breakdown\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Top Categories' pie chart to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 25\"},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Browser Breakdown' pie chart to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 26\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where AppCategory == '{CategoryName}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id\",\"size\":0,\"showAnalytics\":true,\"title\":\"Application Details For {CategoryName}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"CategoryName\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Applications Data For Category : {CategoryName}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where Browser == '{BrowserName}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id  \",\"size\":0,\"showAnalytics\":true,\"title\":\"Application Details For {BrowserName}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"BrowserName\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Application Details For {BrowserName}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication\\r\\n| where isnotempty(DeviceClassification)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by DeviceClassification\\r\\n| sort by Count desc\",\"size\":3,\"showAnalytics\":true,\"title\":\"Device Classification\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"DeviceClassificationName\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true,\"seriesLabelSettings\":[{\"seriesName\":\"\",\"label\":\"<empty>\"}]}},\"customWidth\":\"50\",\"name\":\"query - 8\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where isnotempty(CCL)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by CCL\\r\\n| sort by Count desc\",\"size\":3,\"showAnalytics\":true,\"title\":\"Cloud Confidence Level Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"CCL\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 6\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Device Classification' pie chart to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 27\"},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Cloud Confidence Level Breakdown' pie chart to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 28\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication\\r\\n| where DeviceClassification == '{DeviceClassificationName}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id\",\"size\":0,\"showAnalytics\":true,\"title\":\"Application Details For {DeviceClassificationName}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"DeviceClassificationName\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Application Details For {DeviceClassificationName}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where CCL == \\\"{CCL}\\\"\\r\\n| summarize arg_max(TimeGenerated,*) by Id\",\"size\":0,\"showAnalytics\":true,\"title\":\"Application Details For Cloud Confidence Level {CCL}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"CCL\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Application Details For Cloud Confidence Level {CCL}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where isnotempty(Device)\\r\\n| extend Device = iff(Device == \\\"Other\\\", \\\"Other (value in Data)\\\", Device)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by Device\\r\\n| sort by Count desc\",\"size\":3,\"showAnalytics\":true,\"title\":\"Device Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"DeviceName\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":11,\"showMetrics\":false,\"showLegend\":true,\"seriesLabelSettings\":[{\"seriesName\":\"Other\",\"label\":\"Other (grouped other values)\"}]}},\"customWidth\":\"50\",\"name\":\"query - 7\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where isnotempty(Activity)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count()  by Activity\\r\\n| top 10 by Count\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 10 Application Activities\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"x\",\"exportParameterName\":\"ActivityName\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\",\"chartSettings\":{\"createOtherGroup\":11}},\"customWidth\":\"50\",\"name\":\"query - 7\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Device Breakdown' pie chart to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 29\"},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Top 10 Application Activities' bar chart to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 30\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication\\r\\n| where Device == (case(\\\"{DeviceName}\\\"==\\\"Other\\\",\\\"Other(Grouped Value)\\\",\\\"{DeviceName}\\\"==\\\"Other (value in Data)\\\",\\\"Other\\\",\\\"{DeviceName}\\\"))\\r\\n| summarize arg_max(TimeGenerated,*) by Id\",\"size\":0,\"showAnalytics\":true,\"title\":\"Application Details For Device {DeviceName}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"DeviceName\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Application Details For Device {DeviceName}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where Activity == '{ActivityName}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id\",\"size\":0,\"showAnalytics\":true,\"title\":\"Application Details For Activity {ActivityName}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"ActivityName\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Application Details For Activity {ActivityName}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where isnotempty(User)and isnotempty(AccessMethod)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by User, ['Access Method'] = AccessMethod\\r\\n| sort by Count desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top Users By Access Method\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"User\",\"parameterName\":\"UserName\",\"parameterType\":1,\"defaultValue\":\"none\"},{\"fieldName\":\"Access Method\",\"parameterName\":\"AccessMethod\",\"parameterType\":1,\"defaultValue\":\"none\"}],\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"100\",\"name\":\"Top Users By Access Method\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Top Users By Access Method' grid to view more details_\"},\"name\":\"text - 31\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where User == '{UserName}'\\r\\n    and AccessMethod == '{AccessMethod}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id\",\"size\":0,\"showAnalytics\":true,\"title\":\"Application Details For User {UserName} And Access Method {AccessMethod}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"100\",\"conditionalVisibilities\":[{\"parameterName\":\"UserName\",\"comparison\":\"isNotEqualTo\",\"value\":\"none\"},{\"parameterName\":\"AccessMethod\",\"comparison\":\"isNotEqualTo\",\"value\":\"none\"}],\"name\":\"query - 24\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where isnotempty(User) and isnotempty( App)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize ['Total Client Bytes'] = sum(todecimal(ClientBytes)),['Total Server Bytes'] =sum(todecimal(ServerBytes)) by User,Application = App\\r\\n \",\"size\":0,\"showAnalytics\":true,\"title\":\"Bytes Transferred\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total Client Bytes\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}},{\"columnMatch\":\"Total Server Bytes\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"rowLimit\":10000,\"filter\":true}},\"name\":\"query - 10\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where isnotempty(OS)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by OS\\r\\n| sort by Count desc\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"OS Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"OS\",\"exportParameterName\":\"os\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\"OS Breakdown\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where isnotempty(App) and isnotempty(Category)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by Application = App, Category\\r\\n| sort by Count desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Applications Accessed (w/App Category)\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"Category\",\"parameterName\":\"category\",\"defaultValue\":\"none\"},{\"fieldName\":\"Application\",\"parameterName\":\"app\",\"parameterType\":1}],\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\"Applications Accessed (w/App Category)\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'OS Breakdown' grid to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 32\"},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Applications Accessed (w/App Category)' grid to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 33\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication\\r\\n| where OS == '{os}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id\",\"size\":0,\"showAnalytics\":true,\"title\":\"Application Details For {os}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"100\",\"conditionalVisibility\":{\"parameterName\":\"os\",\"comparison\":\"isNotEqualTo\",\"value\":\"\"},\"name\":\"Application Details For {os}\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"100%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"EventsApplication \\r\\n| where App == '{app}'\\r\\n    and Category == '{category}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id\",\"size\":0,\"showAnalytics\":true,\"title\":\"Application Details For Application {app} And Category {category}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibilities\":[{\"parameterName\":\"category\",\"comparison\":\"isNotEqualTo\",\"value\":\"none\"},{\"parameterName\":\"app\",\"comparison\":\"isNotEqualTo\",\"value\":\"none\"}],\"name\":\"Application Details For Application {app} And Category {category}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"view\",\"comparison\":\"isEqualTo\",\"value\":\"tab1\"},\"name\":\"group - 11\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"66dab7e6-5f19-48d6-b11c-5a94f84dafdb\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000},\"label\":\"Time Range\"},{\"id\":\"2f85800e-e576-4669-b72d-2527981dc15d\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TypeOfAlert\",\"label\":\"Type Of Alert\",\"type\":2,\"description\":\"Select Alert Type to visualize data related to specific type of alert\",\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where isnotempty(AlertType)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| distinct tolower(AlertType)\",\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"selectAllValue\":\"*\",\"showDefault\":false},\"timeContext\":{\"durationMs\":0},\"timeContextFromParameter\":\"TimeRange\",\"defaultValue\":\"value::all\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"pills\",\"doNotRunWhenHidden\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"conditionalVisibility\":{\"parameterName\":\"TimeRange\",\"comparison\":\"isNotEqualTo\",\"value\":\"None\"},\"name\":\"parameters - 11\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\n| where isnotempty(DlpFile)\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\n| summarize arg_max(TimeGenerated,*) by Id\\n| summarize Count = count() by DlpFile\\n| top 10 by Count\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 File Matches For DLP\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\r\\n| where isnotempty(App)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize  Count = count() by App\\r\\n| top 10 by Count\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Applications Triggering Alerts\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"AppName\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"app_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"app_s\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"count_\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true,\"seriesLabelSettings\":[{\"seriesName\":\"Other\",\"label\":\"Others\"},{\"seriesName\":\"Other\",\"label\":\"Other Data\"}]},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"count_\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"count_\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"count_\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"50\",\"name\":\"query - 2\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"\"},\"customWidth\":\"50\",\"name\":\"text - 12\"},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Top 10 Applications Triggering Alerts' pie chart to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 13\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where App == \\\"{AppName}\\\"\\r\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| sort by TimeGenerated desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Alert Details For {AppName}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"AppName\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 8\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by tolower(AlertType)\\r\\n| sort by Count desc\",\"size\":3,\"showAnalytics\":true,\"title\":\"Alert Type Breakdown\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true,\"seriesLabelSettings\":[{\"seriesName\":\"Other\",\"label\":\"other\",\"color\":\"gray\"}]}},\"customWidth\":\"50\",\"name\":\"query - 3\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\r\\n| where isnotempty(DlpProfile)\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by DlpProfile\\r\\n| top 10 by Count\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 DLP Profiles\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 4\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where isnotempty(DlpRule) and isnotempty(DlpRuleSeverity)\\r\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize  Count = count() by Rule = DlpRule, Severity = DlpRuleSeverity\\r\\n| top 10 by Count\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 10 DLP Rules\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"Rule\",\"parameterName\":\"DlpRuleSelected\",\"parameterType\":1},{\"fieldName\":\"Severity\",\"parameterName\":\"DlpSeveritySelected\",\"parameterType\":1}],\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"filter\":true}},\"customWidth\":\"33.34\",\"name\":\"query - 6\",\"styleSettings\":{\"margin\":\"3px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where isnotempty(Policy)\\r\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by Policy\\r\\n| top 10 by Count\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top 10 Policy Hits\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportFieldName\":\"Policy\",\"exportParameterName\":\"PolicyName\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"filter\":true}},\"customWidth\":\"33.33\",\"showPin\":false,\"name\":\"query - 7\",\"styleSettings\":{\"margin\":\"3px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where isnotempty(AccessMethod) and isnotempty(Policy)\\r\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| summarize Count = count() by Policy,Method = AccessMethod\\r\\n| sort by Count desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Policy Alerts by Access Method\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"Policy\",\"parameterName\":\"PolicyName2\"},{\"fieldName\":\"Method\",\"parameterName\":\"AccessMethodName\",\"parameterType\":1}],\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"filter\":true}},\"customWidth\":\"33.33\",\"name\":\"query - 11\",\"styleSettings\":{\"margin\":\"3px\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Top 10 DLP Rules' grid to view more details_\"},\"customWidth\":\"33.34\",\"name\":\"text - 16\"},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Top 10 Policy Hits' grid to view more details_\"},\"customWidth\":\"33.33\",\"name\":\"text - 17\"},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Policy Alerts by Access Method' grid to view more details_\"},\"customWidth\":\"33.33\",\"name\":\"text - 18\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\r\\n| where DlpRule =~ \\\"{DlpRuleSelected}\\\" and DlpRuleSeverity =~ '{DlpSeveritySelected}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| sort by TimeGenerated desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Alert Details For Dlp Rule {DlpRuleSelected} and Severity {DlpSeveritySelected}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"DlpRuleSelected\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Alert Details For Dlp Rule {DlpRuleSelected} and Severity {DlpSeveritySelected}\",\"styleSettings\":{\"margin\":\"5\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\r\\n| where Policy =~ \\\"{PolicyName}\\\"\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| sort by TimeGenerated desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Alert Details For {PolicyName}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"PolicyName\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 9\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union isfuzzy=true AlertsDLP,AlertsCtep,AlertsCompromisedCredential,AlertsMalsite,AlertsMalware,AlertsPolicy,AlertsQuarantine,AlertsRemediation,AlertsSecurityAssessment,AlertsUba\\r\\n| where ('{TypeOfAlert:escapejson}' == '*' or AlertType in~ ({TypeOfAlert}))\\r\\n| where Policy =~ \\\"{PolicyName2}\\\" and AccessMethod =~ '{AccessMethodName}'\\r\\n| summarize arg_max(TimeGenerated,*) by Id\\r\\n| sort by TimeGenerated desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Alert Details For Policy {PolicyName2} and Access Method {AccessMethodName}\",\"timeContextFromParameter\":\"TimeRange\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"PolicyName2\",\"comparison\":\"isNotEqualTo\"},\"name\":\"query - 11\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"view\",\"comparison\":\"isEqualTo\",\"value\":\"tab2\"},\"name\":\"group - 11\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"e9fc5159-d3fe-4011-8dd5-7ee37332612c\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Time_Range\",\"label\":\"Time Range\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":300000},{\"durationMs\":900000},{\"durationMs\":1800000},{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":1209600000}}],\"style\":\"pills\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 0\",\"styleSettings\":{\"margin\":\"5px\"}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| top 1 by TimeGenerated\\r\\n| extend DateTime = todatetime(strcat(Date,\\\" \\\", Time))\\r\\n| extend ['Time Difference'] = datetime_diff('Minute',TimeGenerated,DateTime)\\r\\n| project ['Time Difference']\\r\\n| extend ['Time Difference'] = strcat(['Time Difference'],' Minutes')\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Latency of last ingested event (in minutes)\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"card\",\"gridSettings\":{\"rowLimit\":10000},\"tileSettings\":{\"showBorder\":false},\"textSettings\":{\"style\":\"bignumber\"}},\"name\":\"query - 6\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"30px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where ClientBrowser != '-' and isnotempty(ClientBrowser)\\r\\n| summarize Count = count() by ClientBrowser\\r\\n| sort by Count desc\",\"size\":3,\"showAnalytics\":true,\"title\":\"Browser Breakdown\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"Browser\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 5\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where ClientDeviceType != '-' and isnotempty(ClientDeviceType)\\r\\n| summarize Count = count() by ClientDeviceType\\r\\n| sort by Count desc\",\"size\":3,\"showAnalytics\":true,\"title\":\"Device Breakdown\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"DeviceName\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 8\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Browser Breakdown' pie chart to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 13\"},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Device Breakdown' pie chart to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 14\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where ClientBrowser == '{Browser}'\\r\\n| sort by TimeGenerated desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Transactions Details For {Browser}\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"Browser\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Web Transactions Details For {Browser}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where ClientDeviceType == '{DeviceName}'\\r\\n| sort by TimeGenerated desc\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Transactions Details For {DeviceName}\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"DeviceName\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Web Transactions Details For {DeviceName}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where ClientUsername != '-' and ClientMethod != '-' and isnotempty(ClientUsername) and isnotempty(ClientMethod)\\r\\n| summarize Count = count() by ['User Name'] = ClientUsername, Method = ClientMethod \\r\\n| sort by Count desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Top Users By Access Method\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportedParameters\":[{\"fieldName\":\"User Name\",\"parameterName\":\"UserName\",\"parameterType\":1},{\"fieldName\":\"Method\",\"parameterName\":\"Method\",\"parameterType\":1}],\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"rowLimit\":10000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\"query - 10\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where ClientCloudApp !='-' and ClientUsername != '-' and isnotempty(ClientCloudApp) and isnotempty(ClientUsername)\\r\\n| summarize ['Total Client Bytes'] = sum(todecimal(ClientBytes)), ['Total Server Bytes'] = sum(todecimal(ServerBytes)) by Application = ClientCloudApp,['User Name'] = ClientUsername\\r\\n| sort by ['Total Client Bytes'] desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Bytes Transferred\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Total Client Bytes\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}},{\"columnMatch\":\"Total Server Bytes\",\"formatter\":4,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}}],\"rowLimit\":10000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"Application\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"Application\",\"sortOrder\":1}]},\"customWidth\":\"50\",\"name\":\"query - 11\",\"styleSettings\":{\"margin\":\"5px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 _Click on the above 'Top Users By Access Method' grid to view more details_\"},\"customWidth\":\"50\",\"name\":\"text - 15\"},{\"type\":1,\"content\":{\"json\":\"\"},\"customWidth\":\"50\",\"name\":\"text - 16\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where ClientUsername == '{UserName}' and ClientMethod == '{Method}'\\r\\n| sort by TimeGenerated desc\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Transactions Details For User {UserName} and Method {Method}\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibilities\":[{\"parameterName\":\"UserName\",\"comparison\":\"isNotEqualTo\"},{\"parameterName\":\"Method\",\"comparison\":\"isNotEqualTo\"}],\"name\":\"Web Transactions Details For User {UserName} and Method {Method}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where Site != '-' and isnotempty(Site)\\r\\n| summarize Count = count() by Site\\r\\n| top 10 by Count\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Sites\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"SiteName\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 12\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where ClientHost != '-' and isnotempty(ClientHost)\\r\\n| summarize Count = count() by ClientHost\\r\\n| top 10 by Count\\r\\n\",\"size\":3,\"showAnalytics\":true,\"title\":\"Top 10 Hosts\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"exportFieldName\":\"series\",\"exportParameterName\":\"HostName\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\",\"chartSettings\":{\"createOtherGroup\":10,\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"50\",\"name\":\"query - 13\",\"styleSettings\":{\"margin\":\"5px\",\"padding\":\"50px\",\"maxWidth\":\"50%\",\"showBorder\":true}},{\"type\":1,\"content\":{\"json\":\"💡 Click on the above 'Top 10 Sites' pie chart to view more details\"},\"customWidth\":\"50\",\"name\":\"text - 17\"},{\"type\":1,\"content\":{\"json\":\"💡 Click on the above 'Top 10 Hosts' pie chart to view more details\"},\"customWidth\":\"50\",\"name\":\"text - 18\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where Site == '{SiteName}'\\r\\n| sort by TimeGenerated desc\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Transactions Details For {SiteName}\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"SiteName\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Web Transactions Details For {SiteName}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"NetskopeWebTransactions\\r\\n| where ClientHost == '{HostName}'\\r\\n| sort by TimeGenerated desc\\r\\n\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Transactions Details For {HostName}\",\"timeContextFromParameter\":\"Time_Range\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"HostName\",\"comparison\":\"isNotEqualTo\"},\"name\":\"Web Transactions Details For {HostName}\",\"styleSettings\":{\"margin\":\"5px\",\"showBorder\":true}}]},\"conditionalVisibility\":{\"parameterName\":\"view\",\"comparison\":\"isEqualTo\",\"value\":\"tab3\"},\"name\":\"Web Transactions Overview\"}],\"fromTemplateId\":\"sentinel-NetskopeDashboard\",\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}\r\n",
                "version": "1.0",
                "sourceId": "[variables('workspaceResourceId')]",
                "category": "sentinel"
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Workbook-', last(split(variables('workbookId1'),'/'))))]",
              "properties": {
                "description": "@{workbookKey=NetskopeDashboard; logoFileName=Netskope.svg; description=A workbook providing insights into Netskope Alerts, Events and WebTransactions.; dataConnectorsDependencies=System.Object[]; dataTypesDependencies=System.Object[]; previewImagesFileNames=System.Object[]; version=1.0.0; title=NetskopeDashboard; templateRelativePath=NetskopeDashboard.json; subtitle=Netskope Dashboard for Alerts, Events and WebTransactions; provider=Netskope}.description",
                "parentId": "[variables('workbookId1')]",
                "contentId": "[variables('_workbookContentId1')]",
                "kind": "Workbook",
                "version": "[variables('workbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Netskopev2",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Netskope"
                },
                "support": {
                  "name": "Netskope",
                  "tier": "Partner",
                  "link": "https://www.netskope.com/services#support"
                },
                "dependencies": {
                  "operator": "AND",
                  "criteria": [
                    {
                      "contentId": "eventsapplicationdata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "alertscompromisedcredentialdata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "alertsctepdata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "alertsdlpdata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "alertsmalsitedata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "alertsmalwaredata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "alertspolicydata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "alertsquarantinedata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "alertsremediationdata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "alertssecurityassessmentdata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "alertsubadata_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "NetskopeWebtxData_CL",
                      "kind": "DataType"
                    },
                    {
                      "contentId": "NetskopeDataConnector",
                      "kind": "DataConnector"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_workbookContentId1')]",
        "contentKind": "Workbook",
        "displayName": "[parameters('workbook1-name')]",
        "contentProductId": "[variables('_workbookcontentProductId1')]",
        "id": "[variables('_workbookcontentProductId1')]",
        "version": "[variables('workbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "NetskopeDataConnectorsTriggerSync Playbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion1')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "NetskopeDataConnectorsTriggerSync",
              "type": "string",
              "metadata": {
                "description": "Enter the playbook name"
              }
            },
            "TenantID": {
              "type": "string",
              "metadata": {
                "description": "Enter the Azure Tenant ID"
              }
            },
            "ClientID": {
              "type": "string",
              "metadata": {
                "description": "Enter the Azure Client ID"
              }
            },
            "ClientSecret": {
              "type": "securestring",
              "metadata": {
                "description": "Enter the Azure Client Secret"
              }
            },
            "ResourceGroupName": {
              "type": "string",
              "metadata": {
                "description": "Enter the Azure Resource Group Name in which your Netskope data connectors are available"
              }
            },
            "SubscriptionID": {
              "type": "string",
              "metadata": {
                "description": "Enter the Azure Subscription ID in which your Netskope data connectors are available, make sure that the subscription id is as per the Azure portal at all places"
              }
            }
          },
          "variables": {
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "properties": {
                "provisioningState": "Succeeded",
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "triggers": {
                    "manual": {
                      "type": "Request",
                      "kind": "Http"
                    }
                  },
                  "actions": {
                    "For_each_app": {
                      "foreach": "@body('Get_all_Netskope_Function_apps')",
                      "actions": {
                        "Sync_timer_trigger_request": {
                          "type": "Http",
                          "inputs": {
                            "headers": {
                              "Authorization": "Bearer @{body('Parse_Auth_token')?['access_token']} "
                            },
                            "method": "POST",
                            "uri": "https://@{variables('Manage')}.azure.com/subscriptions/@{variables('Subscription Id')}/resourceGroups/@{variables('Resource Group Name')}/providers/Microsoft.Web/sites/@{items('For_each_app')?['name']}/syncfunctiontriggers?api-version=2022-03-01"
                          }
                        }
                      },
                      "runAfter": {
                        "Get_all_Netskope_Function_apps": [
                          "Succeeded"
                        ]
                      },
                      "type": "Foreach"
                    },
                    "Get_Auth_token": {
                      "runAfter": {
                        "Initialize_Management_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "Http",
                      "inputs": {
                        "body": "client_id=@{variables('Client Id')}&\nclient_secret=@{variables('Client Secret')}&\ngrant_type=client_credentials&\nscope=https://@{variables('Manage')}.azure.com/.default",
                        "headers": {
                          "Content-Type": "application/x-www-form-urlencoded"
                        },
                        "method": "POST",
                        "uri": "https://login.@{variables('MicrosoftOnline')}.com/@{variables('Tenant Id')}/oauth2/v2.0/token"
                      }
                    },
                    "Get_all_Netskope_Function_apps": {
                      "runAfter": {
                        "Get_all_running_function_app": [
                          "Succeeded"
                        ]
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@body('Get_all_running_function_app')",
                        "where": "@or(startsWith(item()?['name'], 'NtoS'), startsWith(item()?['name'], 'StoS'),startsWith(item()?['name'], 'WebTxMetric'))"
                      }
                    },
                    "Get_all_running_function_app": {
                      "runAfter": {
                        "Parse_function_app_list": [
                          "Succeeded"
                        ]
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@body('Parse_function_app_list')?['value']",
                        "where": "@equals(item()?['properties']?['state'], 'Running')"
                      }
                    },
                    "Get_function_app_list": {
                      "runAfter": {
                        "Parse_Auth_token": [
                          "Succeeded"
                        ]
                      },
                      "type": "Http",
                      "inputs": {
                        "headers": {
                          "Authorization": "Bearer @{body('Parse_Auth_token')?['access_token']} "
                        },
                        "method": "GET",
                        "uri": "https://@{variables('Manage')}.azure.com/subscriptions/@{variables('Subscription Id')}/resourceGroups/@{variables('Resource Group Name')}/providers/Microsoft.Web/sites?api-version=2022-03-01"
                      }
                    },
                    "Initialize_Client_Id": {
                      "runAfter": {
                        "Initialize_Tenant_Id": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Client Id",
                            "type": "string",
                            "value": "[[parameters('ClientID')]"
                          }
                        ]
                      }
                    },
                    "Initialize_Client_Secret": {
                      "runAfter": {
                        "Initialize_Client_Id": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Client Secret",
                            "type": "string",
                            "value": "[[parameters('ClientSecret')]"
                          }
                        ]
                      }
                    },
                    "Initialize_Management_variable": {
                      "runAfter": {
                        "Initialize_Microsoftonline_variable": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Manage",
                            "type": "string",
                            "value": "management"
                          }
                        ]
                      }
                    },
                    "Initialize_Microsoftonline_variable": {
                      "runAfter": {
                        "Subscription_Id": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "MicrosoftOnline",
                            "type": "string",
                            "value": "microsoftonline"
                          }
                        ]
                      }
                    },
                    "Initialize_Resource_Group": {
                      "runAfter": {
                        "Initialize_Client_Secret": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Resource Group Name",
                            "type": "string",
                            "value": "[[parameters('ResourceGroupName')]"
                          }
                        ]
                      }
                    },
                    "Initialize_Tenant_Id": {
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Tenant Id",
                            "type": "string",
                            "value": "[[parameters('TenantID')]"
                          }
                        ]
                      }
                    },
                    "Parse_Auth_token": {
                      "runAfter": {
                        "Get_Auth_token": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('Get_Auth_token')",
                        "schema": {
                          "properties": {
                            "access_token": {
                              "type": "string"
                            },
                            "expires_in": {
                              "type": "integer"
                            },
                            "ext_expires_in": {
                              "type": "integer"
                            },
                            "token_type": {
                              "type": "string"
                            }
                          },
                          "type": "object"
                        }
                      }
                    },
                    "Parse_function_app_list": {
                      "runAfter": {
                        "Get_function_app_list": [
                          "Succeeded"
                        ]
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@body('Get_function_app_list')",
                        "schema": {
                          "properties": {
                            "value": {
                              "items": {
                                "properties": {
                                  "id": {
                                    "type": "string"
                                  },
                                  "identity": {
                                    "properties": {
                                      "principalId": {
                                        "type": "string"
                                      },
                                      "tenantId": {
                                        "type": "string"
                                      },
                                      "type": {
                                        "type": "string"
                                      }
                                    },
                                    "type": "object"
                                  },
                                  "kind": {
                                    "type": "string"
                                  },
                                  "location": {
                                    "type": "string"
                                  },
                                  "name": {
                                    "type": "string"
                                  },
                                  "properties": {
                                    "properties": {
                                      "adminEnabled": {
                                        "type": "boolean"
                                      },
                                      "afdEnabled": {
                                        "type": "boolean"
                                      },
                                      "availabilityState": {
                                        "type": "string"
                                      },
                                      "clientAffinityEnabled": {
                                        "type": "boolean"
                                      },
                                      "clientCertEnabled": {
                                        "type": "boolean"
                                      },
                                      "clientCertMode": {
                                        "type": "string"
                                      },
                                      "containerSize": {
                                        "type": "integer"
                                      },
                                      "contentAvailabilityState": {
                                        "type": "string"
                                      },
                                      "csrs": {
                                        "type": "array"
                                      },
                                      "customDomainVerificationId": {
                                        "type": "string"
                                      },
                                      "dailyMemoryTimeQuota": {
                                        "type": "integer"
                                      },
                                      "defaultHostName": {
                                        "type": "string"
                                      },
                                      "defaultHostNameScope": {
                                        "type": "string"
                                      },
                                      "deploymentId": {
                                        "type": "string"
                                      },
                                      "dnsConfiguration": {
                                        "type": "object"
                                      },
                                      "eligibleLogCategories": {
                                        "type": "string"
                                      },
                                      "enabled": {
                                        "type": "boolean"
                                      },
                                      "enabledHostNames": {
                                        "items": {
                                          "type": "string"
                                        },
                                        "type": "array"
                                      },
                                      "endToEndEncryptionEnabled": {
                                        "type": "boolean"
                                      },
                                      "ftpUsername": {
                                        "type": "string"
                                      },
                                      "ftpsHostName": {
                                        "type": "string"
                                      },
                                      "functionsRuntimeAdminIsolationEnabled": {
                                        "type": "boolean"
                                      },
                                      "homeStamp": {
                                        "type": "string"
                                      },
                                      "hostNameSslStates": {
                                        "items": {
                                          "properties": {
                                            "hostType": {
                                              "type": "string"
                                            },
                                            "ipBasedSslState": {
                                              "type": "string"
                                            },
                                            "name": {
                                              "type": "string"
                                            },
                                            "sslState": {
                                              "type": "string"
                                            }
                                          },
                                          "required": [
                                            "name",
                                            "sslState",
                                            "ipBasedSslResult",
                                            "virtualIP",
                                            "virtualIPv6",
                                            "thumbprint",
                                            "certificateResourceId",
                                            "toUpdate",
                                            "toUpdateIpBasedSsl",
                                            "ipBasedSslState",
                                            "hostType"
                                          ],
                                          "type": "object"
                                        },
                                        "type": "array"
                                      },
                                      "hostNames": {
                                        "items": {
                                          "type": "string"
                                        },
                                        "type": "array"
                                      },
                                      "hostNamesDisabled": {
                                        "type": "boolean"
                                      },
                                      "httpsOnly": {
                                        "type": "boolean"
                                      },
                                      "hyperV": {
                                        "type": "boolean"
                                      },
                                      "inboundIpAddress": {
                                        "type": "string"
                                      },
                                      "ipMode": {
                                        "type": "string"
                                      },
                                      "isXenon": {
                                        "type": "boolean"
                                      },
                                      "keyVaultReferenceIdentity": {
                                        "type": "string"
                                      },
                                      "kind": {
                                        "type": "string"
                                      },
                                      "lastModifiedTimeUtc": {
                                        "type": "string"
                                      },
                                      "name": {
                                        "type": "string"
                                      },
                                      "outboundIpAddresses": {
                                        "type": "string"
                                      },
                                      "possibleInboundIpAddresses": {
                                        "type": "string"
                                      },
                                      "possibleOutboundIpAddresses": {
                                        "type": "string"
                                      },
                                      "redundancyMode": {
                                        "type": "string"
                                      },
                                      "repositorySiteName": {
                                        "type": "string"
                                      },
                                      "reserved": {
                                        "type": "boolean"
                                      },
                                      "resourceGroup": {
                                        "type": "string"
                                      },
                                      "runtimeAvailabilityState": {
                                        "type": "string"
                                      },
                                      "scmSiteAlsoStopped": {
                                        "type": "boolean"
                                      },
                                      "secretsCollection": {
                                        "type": "array"
                                      },
                                      "selfLink": {
                                        "type": "string"
                                      },
                                      "serverFarmId": {
                                        "type": "string"
                                      },
                                      "siteConfig": {
                                        "properties": {
                                          "acrUseManagedIdentityCreds": {
                                            "type": "boolean"
                                          },
                                          "alwaysOn": {
                                            "type": "boolean"
                                          },
                                          "functionAppScaleLimit": {
                                            "type": "integer"
                                          },
                                          "http20Enabled": {
                                            "type": "boolean"
                                          },
                                          "linuxFxVersion": {
                                            "type": "string"
                                          },
                                          "minimumElasticInstanceCount": {
                                            "type": "integer"
                                          },
                                          "numberOfWorkers": {
                                            "type": "integer"
                                          }
                                        },
                                        "type": "object"
                                      },
                                      "siteDisabledReason": {
                                        "type": "integer"
                                      },
                                      "siteProperties": {
                                        "properties": {
                                          "properties": {
                                            "items": {
                                              "properties": {
                                                "name": {
                                                  "type": "string"
                                                },
                                                "value": {
                                                  "type": [
                                                    "string",
                                                    "null"
                                                  ]
                                                }
                                              },
                                              "required": [
                                                "name",
                                                "value"
                                              ],
                                              "type": "object"
                                            },
                                            "type": "array"
                                          }
                                        },
                                        "type": "object"
                                      },
                                      "sku": {
                                        "type": "string"
                                      },
                                      "state": {
                                        "type": "string"
                                      },
                                      "storageAccountRequired": {
                                        "type": "boolean"
                                      },
                                      "storageRecoveryDefaultState": {
                                        "type": "string"
                                      },
                                      "usageState": {
                                        "type": "string"
                                      },
                                      "vnetBackupRestoreEnabled": {
                                        "type": "boolean"
                                      },
                                      "vnetContentShareEnabled": {
                                        "type": "boolean"
                                      },
                                      "vnetImagePullEnabled": {
                                        "type": "boolean"
                                      },
                                      "vnetRouteAllEnabled": {
                                        "type": "boolean"
                                      },
                                      "webSpace": {
                                        "type": "string"
                                      }
                                    },
                                    "type": "object"
                                  },
                                  "tags": {
                                    "properties": {
                                      "Jira": {
                                        "type": "string"
                                      }
                                    },
                                    "type": "object"
                                  },
                                  "type": {
                                    "type": "string"
                                  }
                                },
                                "required": [
                                  "id",
                                  "name",
                                  "type",
                                  "kind",
                                  "location",
                                  "properties"
                                ],
                                "type": "object"
                              },
                              "type": "array"
                            }
                          },
                          "type": "object"
                        }
                      }
                    },
                    "Subscription_Id": {
                      "runAfter": {
                        "Initialize_Resource_Group": [
                          "Succeeded"
                        ]
                      },
                      "type": "InitializeVariable",
                      "inputs": {
                        "variables": [
                          {
                            "name": "Subscription Id",
                            "type": "string",
                            "value": "[[parameters('SubscriptionID')]"
                          }
                        ]
                      }
                    }
                  }
                }
              },
              "name": "[[parameters('PlaybookName')]",
              "type": "Microsoft.Logic/workflows",
              "location": "[[variables('workspace-location-inline')]",
              "tags": {
                "hidden-SentinelTemplateName": "NetskopeDataConnectorsTriggerSync",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              },
              "identity": {
                "type": "SystemAssigned"
              },
              "apiVersion": "2017-07-01",
              "dependsOn": "[variables('TemplateEmptyArray')]"
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId1'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId1')]",
                "contentId": "[variables('_playbookContentId1')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Netskopev2",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Netskope"
                },
                "support": {
                  "name": "Netskope",
                  "tier": "Partner",
                  "link": "https://www.netskope.com/services#support"
                }
              }
            }
          ],
          "metadata": {
            "title": "NetskopeDataConnectorsTriggerSync",
            "description": "Playbook to sync timer trigger of all Netskope data connectors.",
            "prerequisites": [
              "Users must have a below Microsoft credentials:",
              "1.Tenant ID",
              "2.Client ID",
              "3.Client Secret",
              "4.Resource Group Name",
              "5.Subscription ID"
            ],
            "postDeployment": [
              "Run the playbook to sync timer trigger of all Netskope data connectors."
            ],
            "tags": [
              "Netskope",
              "Sync",
              "Timer",
              "Trigger"
            ],
            "lastUpdateTime": "2025-02-05T18:06:18.136Z",
            "releaseNotes": {
              "version": "1.0",
              "title": "[variables('blanks')]",
              "notes": [
                "Initial version"
              ]
            }
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId1')]",
        "contentKind": "Playbook",
        "displayName": "NetskopeDataConnectorsTriggerSync",
        "contentProductId": "[variables('_playbookcontentProductId1')]",
        "id": "[variables('_playbookcontentProductId1')]",
        "version": "[variables('playbookVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('playbookTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "NetskopeWebTxErrorEmail Playbook with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('playbookVersion2')]",
          "parameters": {
            "PlaybookName": {
              "defaultValue": "NetskopeWebTxErrorEmail",
              "type": "string",
              "metadata": {
                "description": "Enter the playbook name."
              }
            },
            "ReceiverEmailId": {
              "type": "string",
              "metadata": {
                "description": "Enter the receiver email id to receive error mails."
              }
            }
          },
          "variables": {
            "MicrosoftSentinelConnectionName": "[[concat('MicrosoftSentinel-', parameters('PlaybookName'))]",
            "OutlookConnectionName": "[[concat('Outlook-', parameters('PlaybookName'))]",
            "connection-2": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/Azuresentinel')]",
            "_connection-2": "[[variables('connection-2')]",
            "connection-3": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/Outlook')]",
            "_connection-3": "[[variables('connection-3')]",
            "workspace-location-inline": "[concat('[resourceGroup().locatio', 'n]')]",
            "workspace-name": "[parameters('workspace')]",
            "workspaceResourceId": "[[resourceId('microsoft.OperationalInsights/Workspaces', variables('workspace-name'))]"
          },
          "resources": [
            {
              "properties": {
                "provisioningState": "Succeeded",
                "state": "Enabled",
                "definition": {
                  "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                  "contentVersion": "1.0.0.0",
                  "parameters": {
                    "$connections": {
                      "type": "Object"
                    }
                  },
                  "triggers": {
                    "Microsoft_Sentinel_incident": {
                      "type": "ApiConnectionWebhook",
                      "inputs": {
                        "body": {
                          "callback_url": "@{listCallbackUrl()}"
                        },
                        "host": {
                          "connection": {
                            "name": "@parameters('$connections')['azuresentinel_1']['connectionId']"
                          }
                        },
                        "path": "/incident-creation"
                      }
                    }
                  },
                  "actions": {
                    "For_each_alert": {
                      "foreach": "@triggerBody()?['object']?['properties']?['Alerts']",
                      "actions": {
                        "Send_email_(V2)": {
                          "type": "ApiConnection",
                          "inputs": {
                            "body": {
                              "Body": "<p>@{items('For_each_alert')?['properties']?['alertDisplayName']} @{items('For_each_alert')?['properties']?['description']}</p>",
                              "Importance": "High",
                              "Subject": "Netskope Webtx Error Encountered",
                              "To": "[[parameters('ReceiverEmailId')]"
                            },
                            "host": {
                              "connection": {
                                "name": "@parameters('$connections')['outlook']['connectionId']"
                              }
                            },
                            "method": "post",
                            "path": "/v2/Mail"
                          }
                        }
                      },
                      "type": "Foreach"
                    }
                  }
                },
                "parameters": {
                  "$connections": {
                    "value": {
                      "azuresentinel_1": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                        "connectionName": "[[variables('MicrosoftSentinelConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/Azuresentinel')]",
                        "connectionProperties": {
                          "authentication": {
                            "type": "ManagedServiceIdentity"
                          }
                        }
                      },
                      "outlook": {
                        "connectionId": "[[resourceId('Microsoft.Web/connections', variables('OutlookConnectionName'))]",
                        "connectionName": "[[variables('OutlookConnectionName')]",
                        "id": "[[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', variables('workspace-location-inline'), '/managedApis/Outlook')]"
                      }
                    }
                  }
                }
              },
              "name": "[[parameters('PlaybookName')]",
              "type": "Microsoft.Logic/workflows",
              "location": "[[variables('workspace-location-inline')]",
              "tags": {
                "hidden-SentinelTemplateName": "NetskopeWebTxErrorEmail",
                "hidden-SentinelTemplateVersion": "1.0",
                "hidden-SentinelWorkspaceId": "[[variables('workspaceResourceId')]"
              },
              "identity": {
                "type": "SystemAssigned"
              },
              "apiVersion": "2017-07-01",
              "dependsOn": [
                "[[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                "[[resourceId('Microsoft.Web/connections', variables('OutlookConnectionName'))]"
              ]
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('MicrosoftSentinelConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('MicrosoftSentinelConnectionName')]",
                "parameterValueType": "Alternative",
                "api": {
                  "id": "[[variables('_connection-2')]"
                }
              }
            },
            {
              "type": "Microsoft.Web/connections",
              "apiVersion": "2016-06-01",
              "name": "[[variables('OutlookConnectionName')]",
              "location": "[[variables('workspace-location-inline')]",
              "kind": "V1",
              "properties": {
                "displayName": "[[variables('OutlookConnectionName')]",
                "api": {
                  "id": "[[variables('_connection-3')]"
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2022-01-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('Playbook-', last(split(variables('playbookId2'),'/'))))]",
              "properties": {
                "parentId": "[variables('playbookId2')]",
                "contentId": "[variables('_playbookContentId2')]",
                "kind": "Playbook",
                "version": "[variables('playbookVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "Netskopev2",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Netskope"
                },
                "support": {
                  "name": "Netskope",
                  "tier": "Partner",
                  "link": "https://www.netskope.com/services#support"
                }
              }
            }
          ],
          "metadata": {
            "title": "NetskopeWebTxErrorEmail",
            "description": "This playbook sends email when Netskope Web Transaction data connector error is detected.",
            "postDeployment": [
              "**Authorize connections**",
              "Once deployment is complete, authorize each connection.",
              "1. Click the MicrosoftSentinelConnection resource",
              "2. Click edit API connections",
              "3. Click Authorize",
              "4. Provide Required Parameters",
              "5. Click Save",
              "6. Repeat same steps for OutlookConnection",
              "**In Microsoft Sentinel, analytics rules should be configured to trigger an incident.**",
              "1. Select the  **Netskope - WebTx Error Detection** analytic rule you have deployed.",
              "2. Click on **Edit**",
              "3. Go to **Automated response** tab",
              "4. Click on **Add new**",
              "5. Provide name for your rule, In Actions dropdown select **Run playbook**",
              "6. In second dropdown select your deployed playbook",
              "7. Click on **Apply**",
              "8. Save the Analytic rule."
            ],
            "tags": [
              "Netskope",
              "Email",
              "WebTransaction"
            ],
            "lastUpdateTime": "2025-02-05T18:06:18.848Z",
            "releaseNotes": {
              "version": "1.0",
              "title": "[variables('blanks')]",
              "notes": [
                "Initial version"
              ]
            }
          }
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_playbookContentId2')]",
        "contentKind": "Playbook",
        "displayName": "NetskopeWebTxErrorEmail",
        "contentProductId": "[variables('_playbookcontentProductId2')]",
        "id": "[variables('_playbookcontentProductId2')]",
        "version": "[variables('playbookVersion2')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName1')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Netskopev2 data connector with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion1')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId1')]",
                  "title": "Netskope Data Connector (using Azure Functions)",
                  "publisher": "Netskope",
                  "descriptionMarkdown": "The [Netskope](https://docs.netskope.com/en/netskope-help/admin-console/rest-api/rest-api-v2-overview-312207/) data connector provides the following capabilities: \n 1. NetskopeToAzureStorage : \n >* Get the Netskope Alerts and Events data from Netskope and post to Azure storage. \n 2. StorageToSentinel : \n >* Get the Netskope Alerts and Events data from Azure storage and post to custom log table in log analytics workspace. \n 3. WebTxMetrics : \n >* Get the WebTxMetrics data from Netskope and post to custom log table in log analytics workspace.\n\n\n For more details of REST APIs refer to the below documentations: \n 1. Netskope API documentation: \n> https://docs.netskope.com/en/netskope-help/admin-console/rest-api/rest-api-v2-overview-312207/ \n 2. Azure storage documentation: \n> https://learn.microsoft.com/azure/storage/common/storage-introduction \n 3. Microsoft log analytic documentation: \n> https://learn.microsoft.com/azure/azure-monitor/logs/log-analytics-overview",
                  "graphQueries": [
                    {
                      "metricName": "Compromised Credential data received",
                      "legend": "alertscompromisedcredentialdata_CL",
                      "baseQuery": "alertscompromisedcredentialdata_CL"
                    },
                    {
                      "metricName": "CTEP data received",
                      "legend": "alertsctepdata_CL",
                      "baseQuery": "alertsctepdata_CL"
                    },
                    {
                      "metricName": "DLP data received",
                      "legend": "alertsdlpdata_CL",
                      "baseQuery": "alertsdlpdata_CL"
                    },
                    {
                      "metricName": "Malsite data received",
                      "legend": "alertsmalsitedata_CL",
                      "baseQuery": "alertsmalsitedata_CL"
                    },
                    {
                      "metricName": "Malware data received",
                      "legend": "alertsmalwaredata_CL",
                      "baseQuery": "alertsmalwaredata_CL"
                    },
                    {
                      "metricName": "Policy data received",
                      "legend": "alertspolicydata_CL",
                      "baseQuery": "alertspolicydata_CL"
                    },
                    {
                      "metricName": "Quarantine data received",
                      "legend": "alertsquarantinedata_CL",
                      "baseQuery": "alertsquarantinedata_CL"
                    },
                    {
                      "metricName": "Remediation data received",
                      "legend": "alertsremediationdata_CL",
                      "baseQuery": "alertsremediationdata_CL"
                    },
                    {
                      "metricName": "SecurityAssessment data received",
                      "legend": "alertssecurityassessmentdata_CL",
                      "baseQuery": "alertssecurityassessmentdata_CL"
                    },
                    {
                      "metricName": "UBA data received",
                      "legend": "alertsubadata_CL",
                      "baseQuery": "alertsubadata_CL"
                    },
                    {
                      "metricName": "Application data received",
                      "legend": "eventsapplicationdata_CL",
                      "baseQuery": "eventsapplicationdata_CL"
                    },
                    {
                      "metricName": "Audit data received",
                      "legend": "eventsauditdata_CL",
                      "baseQuery": "eventsauditdata_CL"
                    },
                    {
                      "metricName": "Connection data received",
                      "legend": "eventsconnectiondata_CL",
                      "baseQuery": "eventsconnectiondata_CL"
                    },
                    {
                      "metricName": "Incident data received",
                      "legend": "eventsincidentdata_CL",
                      "baseQuery": "eventsincidentdata_CL"
                    },
                    {
                      "metricName": "Network data received",
                      "legend": "eventsnetworkdata_CL",
                      "baseQuery": "eventsnetworkdata_CL"
                    },
                    {
                      "metricName": "Page data received",
                      "legend": "eventspagedata_CL",
                      "baseQuery": "eventspagedata_CL"
                    },
                    {
                      "metricName": "WebTxMetrics data received",
                      "legend": "Netskope_WebTx_metrics_CL",
                      "baseQuery": "Netskope_WebTx_metrics_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Netskope CompromisedCredential Alerts Data",
                      "query": "alertscompromisedcredentialdata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope CTEP Alerts Data",
                      "query": "alertsctepdata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope DLP Alerts Data",
                      "query": "alertsdlpdata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Malsite Alerts Data",
                      "query": "alertsmalsitedata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Malware Alerts Data",
                      "query": "alertsmalwaredata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Policy Alerts Data",
                      "query": "alertspolicydata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Quarantine Alerts Data",
                      "query": "alertsquarantinedata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Remediation Alerts Data",
                      "query": "alertsremediationdata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope SecurityAssessment Alerts Data",
                      "query": "alertssecurityassessmentdata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Uba Alerts Data",
                      "query": "alertsubadata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Application Events Data.",
                      "query": "eventsapplicationdata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Audit Events Data",
                      "query": "eventsauditdata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Connection Events Data",
                      "query": "eventsconnectiondata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Incident Events Data",
                      "query": "eventsincidentdata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Network Events Data",
                      "query": "eventsnetworkdata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Page Events Data",
                      "query": "eventspagedata_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope WebTransactions Metrics Data",
                      "query": "Netskope_WebTx_metrics_CL\n | sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "alertscompromisedcredentialdata_CL",
                      "lastDataReceivedQuery": "alertscompromisedcredentialdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "alertsctepdata_CL",
                      "lastDataReceivedQuery": "alertsctepdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "alertsdlpdata_CL",
                      "lastDataReceivedQuery": "alertsdlpdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "alertsmalsitedata_CL",
                      "lastDataReceivedQuery": "alertsmalsitedata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "alertsmalwaredata_CL",
                      "lastDataReceivedQuery": "alertsmalwaredata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "alertspolicydata_CL",
                      "lastDataReceivedQuery": "alertspolicydata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "alertsquarantinedata_CL",
                      "lastDataReceivedQuery": "alertsquarantinedata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "alertsremediationdata_CL",
                      "lastDataReceivedQuery": "alertsremediationdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "alertssecurityassessmentdata_CL",
                      "lastDataReceivedQuery": "alertssecurityassessmentdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "alertsubadata_CL",
                      "lastDataReceivedQuery": "alertsubadata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "eventsapplicationdata_CL",
                      "lastDataReceivedQuery": "eventsapplicationdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "eventsauditdata_CL",
                      "lastDataReceivedQuery": "eventsauditdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "eventsconnectiondata_CL",
                      "lastDataReceivedQuery": "eventsconnectiondata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "eventsincidentdata_CL",
                      "lastDataReceivedQuery": "eventsincidentdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "eventsnetworkdata_CL",
                      "lastDataReceivedQuery": "eventsnetworkdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "eventspagedata_CL",
                      "lastDataReceivedQuery": "eventspagedata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "Netskope_WebTx_metrics_CL",
                      "lastDataReceivedQuery": "Netskope_WebTx_metrics_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "alertscompromisedcredentialdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "alertsctepdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "alertsdlpdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "alertsmalsitedata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "alertsmalwaredata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "alertspolicydata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "alertsquarantinedata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "alertsremediationdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "alertssecurityassessmentdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "alertsubadata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "eventsapplicationdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "eventsauditdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "eventsconnectiondata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "eventsincidentdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "eventsnetworkdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "eventspagedata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "Netskope_WebTx_metrics_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Azure Subscription",
                        "description": "Azure Subscription with owner role is required to register an application in azure active directory() and assign role of contributor to app in resource group."
                      },
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      },
                      {
                        "name": "REST API Credentials/permissions",
                        "description": "**Netskope Tenant** and **Netskope API Token** is required.  See the documentation to learn more about API on the [Rest API reference](https://docs.netskope.com/en/netskope-help/admin-console/rest-api/rest-api-v2-overview-312207/)"
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": ">**NOTE:** This connector uses Azure Functions to connect to the Netskope APIs to pull its Alerts and Events data into custom log table. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
                    },
                    {
                      "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
                    },
                    {
                      "description": "**STEP 1 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of the TriggersSync playbook. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
                    },
                    {
                      "description": "**STEP 2 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of TriggersSync playbook. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of TriggersSync playbook. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
                    },
                    {
                      "description": "**STEP 3 - Assign role of Contributor to application in Microsoft Entra ID**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
                    },
                    {
                      "description": "**STEP 4 - Steps to create/get Credentials for the Netskope account** \n\n Follow the steps in this section to create/get **Netskope Hostname** and **Netskope API Token**:\n 1. Login to your **Netskope Tenant** and go to the **Settings menu** on the left navigation bar.\n 2. Click on Tools and then **REST API v2**\n 3. Now, click on the new token button. Then it will ask for token name, expiration duration and the endpoints that you want to fetch data from.\n 5. Once that is done click the save button, the token will be generated. Copy the token and save at a secure place for further usage."
                    },
                    {
                      "description": "**STEP 5 - Steps to create the azure functions for Netskope Alerts and Events Data Collection**\n\n>**IMPORTANT:** Before deploying Netskope data connector, have the  Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the Netskope API Authorization Key(s).",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "fillWith": [
                              "PrimaryKey"
                            ],
                            "label": "Primary Key"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "Using the ARM template deploy the function apps for ingestion of Netskope events and alerts data to Sentinel.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-NetskopeV2-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tNetskope HostName \n\t\tNetskope API Token \n\t\tSelect Yes in Alerts and Events types dropdown for that endpoint you want to fetch Alerts and Events \n\t\tLog Level \n\t\tWorkspace ID \n\t\tWorkspace Key \n4. Click on **Review+Create**. \n5. Then after validation click on **Create** to deploy."
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
                "contentId": "[variables('_dataConnectorContentId1')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion1')]",
                "source": {
                  "kind": "Solution",
                  "name": "Netskopev2",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Netskope"
                },
                "support": {
                  "name": "Netskope",
                  "tier": "Partner",
                  "link": "https://www.netskope.com/services#support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "contentKind": "DataConnector",
        "displayName": "Netskope Data Connector (using Azure Functions)",
        "contentProductId": "[variables('_dataConnectorcontentProductId1')]",
        "id": "[variables('_dataConnectorcontentProductId1')]",
        "version": "[variables('dataConnectorVersion1')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId1'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId1')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId1'))]",
        "contentId": "[variables('_dataConnectorContentId1')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion1')]",
        "source": {
          "kind": "Solution",
          "name": "Netskopev2",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Netskope"
        },
        "support": {
          "name": "Netskope",
          "tier": "Partner",
          "link": "https://www.netskope.com/services#support"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId1'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Netskope Data Connector (using Azure Functions)",
          "publisher": "Netskope",
          "descriptionMarkdown": "The [Netskope](https://docs.netskope.com/en/netskope-help/admin-console/rest-api/rest-api-v2-overview-312207/) data connector provides the following capabilities: \n 1. NetskopeToAzureStorage : \n >* Get the Netskope Alerts and Events data from Netskope and post to Azure storage. \n 2. StorageToSentinel : \n >* Get the Netskope Alerts and Events data from Azure storage and post to custom log table in log analytics workspace. \n 3. WebTxMetrics : \n >* Get the WebTxMetrics data from Netskope and post to custom log table in log analytics workspace.\n\n\n For more details of REST APIs refer to the below documentations: \n 1. Netskope API documentation: \n> https://docs.netskope.com/en/netskope-help/admin-console/rest-api/rest-api-v2-overview-312207/ \n 2. Azure storage documentation: \n> https://learn.microsoft.com/azure/storage/common/storage-introduction \n 3. Microsoft log analytic documentation: \n> https://learn.microsoft.com/azure/azure-monitor/logs/log-analytics-overview",
          "graphQueries": [
            {
              "metricName": "Compromised Credential data received",
              "legend": "alertscompromisedcredentialdata_CL",
              "baseQuery": "alertscompromisedcredentialdata_CL"
            },
            {
              "metricName": "CTEP data received",
              "legend": "alertsctepdata_CL",
              "baseQuery": "alertsctepdata_CL"
            },
            {
              "metricName": "DLP data received",
              "legend": "alertsdlpdata_CL",
              "baseQuery": "alertsdlpdata_CL"
            },
            {
              "metricName": "Malsite data received",
              "legend": "alertsmalsitedata_CL",
              "baseQuery": "alertsmalsitedata_CL"
            },
            {
              "metricName": "Malware data received",
              "legend": "alertsmalwaredata_CL",
              "baseQuery": "alertsmalwaredata_CL"
            },
            {
              "metricName": "Policy data received",
              "legend": "alertspolicydata_CL",
              "baseQuery": "alertspolicydata_CL"
            },
            {
              "metricName": "Quarantine data received",
              "legend": "alertsquarantinedata_CL",
              "baseQuery": "alertsquarantinedata_CL"
            },
            {
              "metricName": "Remediation data received",
              "legend": "alertsremediationdata_CL",
              "baseQuery": "alertsremediationdata_CL"
            },
            {
              "metricName": "SecurityAssessment data received",
              "legend": "alertssecurityassessmentdata_CL",
              "baseQuery": "alertssecurityassessmentdata_CL"
            },
            {
              "metricName": "UBA data received",
              "legend": "alertsubadata_CL",
              "baseQuery": "alertsubadata_CL"
            },
            {
              "metricName": "Application data received",
              "legend": "eventsapplicationdata_CL",
              "baseQuery": "eventsapplicationdata_CL"
            },
            {
              "metricName": "Audit data received",
              "legend": "eventsauditdata_CL",
              "baseQuery": "eventsauditdata_CL"
            },
            {
              "metricName": "Connection data received",
              "legend": "eventsconnectiondata_CL",
              "baseQuery": "eventsconnectiondata_CL"
            },
            {
              "metricName": "Incident data received",
              "legend": "eventsincidentdata_CL",
              "baseQuery": "eventsincidentdata_CL"
            },
            {
              "metricName": "Network data received",
              "legend": "eventsnetworkdata_CL",
              "baseQuery": "eventsnetworkdata_CL"
            },
            {
              "metricName": "Page data received",
              "legend": "eventspagedata_CL",
              "baseQuery": "eventspagedata_CL"
            },
            {
              "metricName": "WebTxMetrics data received",
              "legend": "Netskope_WebTx_metrics_CL",
              "baseQuery": "Netskope_WebTx_metrics_CL"
            }
          ],
          "dataTypes": [
            {
              "name": "alertscompromisedcredentialdata_CL",
              "lastDataReceivedQuery": "alertscompromisedcredentialdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "alertsctepdata_CL",
              "lastDataReceivedQuery": "alertsctepdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "alertsdlpdata_CL",
              "lastDataReceivedQuery": "alertsdlpdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "alertsmalsitedata_CL",
              "lastDataReceivedQuery": "alertsmalsitedata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "alertsmalwaredata_CL",
              "lastDataReceivedQuery": "alertsmalwaredata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "alertspolicydata_CL",
              "lastDataReceivedQuery": "alertspolicydata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "alertsquarantinedata_CL",
              "lastDataReceivedQuery": "alertsquarantinedata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "alertsremediationdata_CL",
              "lastDataReceivedQuery": "alertsremediationdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "alertssecurityassessmentdata_CL",
              "lastDataReceivedQuery": "alertssecurityassessmentdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "alertsubadata_CL",
              "lastDataReceivedQuery": "alertsubadata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "eventsapplicationdata_CL",
              "lastDataReceivedQuery": "eventsapplicationdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "eventsauditdata_CL",
              "lastDataReceivedQuery": "eventsauditdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "eventsconnectiondata_CL",
              "lastDataReceivedQuery": "eventsconnectiondata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "eventsincidentdata_CL",
              "lastDataReceivedQuery": "eventsincidentdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "eventsnetworkdata_CL",
              "lastDataReceivedQuery": "eventsnetworkdata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "eventspagedata_CL",
              "lastDataReceivedQuery": "eventspagedata_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "Netskope_WebTx_metrics_CL",
              "lastDataReceivedQuery": "Netskope_WebTx_metrics_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "alertscompromisedcredentialdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "alertsctepdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "alertsdlpdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "alertsmalsitedata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "alertsmalwaredata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "alertspolicydata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "alertsquarantinedata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "alertsremediationdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "alertssecurityassessmentdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "alertsubadata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "eventsapplicationdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "eventsauditdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "eventsconnectiondata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "eventsincidentdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "eventsnetworkdata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "eventspagedata_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "Netskope_WebTx_metrics_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Netskope CompromisedCredential Alerts Data",
              "query": "alertscompromisedcredentialdata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope CTEP Alerts Data",
              "query": "alertsctepdata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope DLP Alerts Data",
              "query": "alertsdlpdata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Malsite Alerts Data",
              "query": "alertsmalsitedata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Malware Alerts Data",
              "query": "alertsmalwaredata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Policy Alerts Data",
              "query": "alertspolicydata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Quarantine Alerts Data",
              "query": "alertsquarantinedata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Remediation Alerts Data",
              "query": "alertsremediationdata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope SecurityAssessment Alerts Data",
              "query": "alertssecurityassessmentdata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Uba Alerts Data",
              "query": "alertsubadata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Application Events Data.",
              "query": "eventsapplicationdata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Audit Events Data",
              "query": "eventsauditdata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Connection Events Data",
              "query": "eventsconnectiondata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Incident Events Data",
              "query": "eventsincidentdata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Network Events Data",
              "query": "eventsnetworkdata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Page Events Data",
              "query": "eventspagedata_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope WebTransactions Metrics Data",
              "query": "Netskope_WebTx_metrics_CL\n | sort by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Azure Subscription",
                "description": "Azure Subscription with owner role is required to register an application in azure active directory() and assign role of contributor to app in resource group."
              },
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              },
              {
                "name": "REST API Credentials/permissions",
                "description": "**Netskope Tenant** and **Netskope API Token** is required.  See the documentation to learn more about API on the [Rest API reference](https://docs.netskope.com/en/netskope-help/admin-console/rest-api/rest-api-v2-overview-312207/)"
              }
            ]
          },
          "instructionSteps": [
            {
              "description": ">**NOTE:** This connector uses Azure Functions to connect to the Netskope APIs to pull its Alerts and Events data into custom log table. Check the [Azure Functions pricing page](https://azure.microsoft.com/pricing/details/functions/) for details."
            },
            {
              "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
            },
            {
              "description": "**STEP 1 - App Registration steps for the Application in Microsoft Entra ID**\n\n This integration requires an App registration in the Azure portal. Follow the steps in this section to create a new application in Microsoft Entra ID:\n 1. Sign in to the [Azure portal](https://portal.azure.com/).\n 2. Search for and select **Microsoft Entra ID**.\n 3. Under **Manage**, select **App registrations > New registration**.\n 4. Enter a display **Name** for your application.\n 5. Select **Register** to complete the initial app registration.\n 6. When registration finishes, the Azure portal displays the app registration's Overview pane. You see the **Application (client) ID** and **Tenant ID**. The client ID and Tenant ID is required as configuration parameters for the execution of the TriggersSync playbook. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app)"
            },
            {
              "description": "**STEP 2 - Add a client secret for application in Microsoft Entra ID**\n\n Sometimes called an application password, a client secret is a string value required for the execution of TriggersSync playbook. Follow the steps in this section to create a new Client Secret:\n 1. In the Azure portal, in **App registrations**, select your application.\n 2. Select **Certificates & secrets > Client secrets > New client secret**.\n 3. Add a description for your client secret.\n 4. Select an expiration for the secret or specify a custom lifetime. Limit is 24 months.\n 5. Select **Add**. \n 6. *Record the secret's value for use in your client application code. This secret value is never displayed again after you leave this page.* The secret value is required as configuration parameter for the execution of TriggersSync playbook. \n\n> **Reference link:** [https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret](https://learn.microsoft.com/azure/active-directory/develop/quickstart-register-app#add-a-client-secret)"
            },
            {
              "description": "**STEP 3 - Assign role of Contributor to application in Microsoft Entra ID**\n\n Follow the steps in this section to assign the role:\n 1. In the Azure portal, Go to **Resource Group** and select your resource group.\n 2. Go to **Access control (IAM)** from left panel.\n 3. Click on **Add**, and then select **Add role assignment**.\n 4. Select **Contributor** as role and click on next.\n 5. In **Assign access to**, select `User, group, or service principal`.\n 6. Click on **add members** and type **your app name** that you have created and select it.\n 7. Now click on **Review + assign** and then again click on **Review + assign**. \n\n> **Reference link:** [https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal](https://learn.microsoft.com/azure/role-based-access-control/role-assignments-portal)"
            },
            {
              "description": "**STEP 4 - Steps to create/get Credentials for the Netskope account** \n\n Follow the steps in this section to create/get **Netskope Hostname** and **Netskope API Token**:\n 1. Login to your **Netskope Tenant** and go to the **Settings menu** on the left navigation bar.\n 2. Click on Tools and then **REST API v2**\n 3. Now, click on the new token button. Then it will ask for token name, expiration duration and the endpoints that you want to fetch data from.\n 5. Once that is done click the save button, the token will be generated. Copy the token and save at a secure place for further usage."
            },
            {
              "description": "**STEP 5 - Steps to create the azure functions for Netskope Alerts and Events Data Collection**\n\n>**IMPORTANT:** Before deploying Netskope data connector, have the  Workspace ID and Workspace Primary Key (can be copied from the following) readily available.., as well as the Netskope API Authorization Key(s).",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "fillWith": [
                      "PrimaryKey"
                    ],
                    "label": "Primary Key"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "Using the ARM template deploy the function apps for ingestion of Netskope events and alerts data to Sentinel.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-NetskopeV2-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tNetskope HostName \n\t\tNetskope API Token \n\t\tSelect Yes in Alerts and Events types dropdown for that endpoint you want to fetch Alerts and Events \n\t\tLog Level \n\t\tWorkspace ID \n\t\tWorkspace Key \n4. Click on **Review+Create**. \n5. Then after validation click on **Create** to deploy."
            }
          ],
          "id": "[variables('_uiConfigId1')]"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[variables('dataConnectorTemplateSpecName2')]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "description": "Netskopev2 data connector with template version 3.0.0",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorVersion2')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId2'))]",
              "apiVersion": "2021-03-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "GenericUI",
              "properties": {
                "connectorUiConfig": {
                  "id": "[variables('_uiConfigId2')]",
                  "title": "Netskope Web Transactions Data Connector (using Azure Functions)",
                  "publisher": "Netskope",
                  "descriptionMarkdown": "The [Netskope Web Transactions](https://docs.netskope.com/en/netskope-help/data-security/transaction-events/netskope-transaction-events/) data connector provides the functionality of a docker image to pull the Netskope Web Transactions data from google pubsublite, process the data and ingest the processed data to Log Analytics. As part of this data connector two tables will be formed in Log Analytics, one for Web Transactions data and other for errors encountered during execution.\n\n\n For more details related to Web Transactions refer to the below documentation: \n 1. Netskope Web Transactions documentation: \n> https://docs.netskope.com/en/netskope-help/data-security/transaction-events/netskope-transaction-events/ \n",
                  "graphQueries": [
                    {
                      "metricName": "Web Transactions data received",
                      "legend": "NetskopeWebtxData_CL",
                      "baseQuery": "NetskopeWebtxData_CL"
                    },
                    {
                      "metricName": "Web Transactions Data Connector Errors",
                      "legend": "NetskopeWebtxErrors_CL",
                      "baseQuery": "NetskopeWebtxErrors_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Netskope Web Transactions Data",
                      "query": "NetskopeWebtxData_CL\n | sort by TimeGenerated desc"
                    },
                    {
                      "description": "Netskope Web Transactions Data Connector Errors",
                      "query": "NetskopeWebtxErrors_CL\n | sort by TimeGenerated desc"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "NetskopeWebtxData_CL",
                      "lastDataReceivedQuery": "NetskopeWebtxData_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    },
                    {
                      "name": "NetskopeWebtxErrors_CL",
                      "lastDataReceivedQuery": "NetskopeWebtxErrors_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriterias": [
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "NetskopeWebtxData_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    },
                    {
                      "type": "IsConnectedQuery",
                      "value": [
                        "NetskopeWebtxErrors_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
                      ]
                    }
                  ],
                  "availability": {
                    "status": 1,
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions on the workspace are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      },
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "action": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Azure Subscription",
                        "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
                      },
                      {
                        "name": "Microsoft.Compute permissions",
                        "description": "Read and write permissions to Azure VMs is required. [See the documentation to learn more about Azure VMs](https://learn.microsoft.com/azure/virtual-machines/overview)."
                      },
                      {
                        "name": "TransactionEvents Credentials and Permissions",
                        "description": "**Netskope Tenant** and **Netskope API Token** is required. [See the documentation to learn more about Transaction Events.](https://docs.netskope.com/en/netskope-help/data-security/transaction-events/netskope-transaction-events/)"
                      },
                      {
                        "name": "Microsoft.Web/sites permissions",
                        "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "description": ">**NOTE:** This connector provides the functionality of ingesting Netskope Web Transactions data using a docker image to be deployed on a virtual machine (Either Azure VM/On Premise VM). Check the [Azure VM pricing page](https://azure.microsoft.com/pricing/details/virtual-machines/linux) for details."
                    },
                    {
                      "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
                    },
                    {
                      "description": "**STEP 1 - Steps to create/get Credentials for the Netskope account** \n\n Follow the steps in this section to create/get **Netskope Hostname** and **Netskope API Token**:\n 1. Login to your **Netskope Tenant** and go to the **Settings menu** on the left navigation bar.\n 2. Click on Tools and then **REST API v2**\n 3. Now, click on the new token button. Then it will ask for token name, expiration duration and the endpoints that you want to fetch data from.\n 5. Once that is done click the save button, the token will be generated. Copy the token and save at a secure place for further usage."
                    },
                    {
                      "description": "**STEP 2 - Choose one from the following two deployment options to deploy the docker based data connector to ingest Netskope Web Transactions data **\n\n>**IMPORTANT:** Before deploying Netskope data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available, as well as the Netskope API Authorization Key(s) [Make sure the token has permissions for transaction events].",
                      "instructions": [
                        {
                          "parameters": {
                            "fillWith": [
                              "WorkspaceId"
                            ],
                            "label": "Workspace ID"
                          },
                          "type": "CopyableLabel"
                        },
                        {
                          "parameters": {
                            "fillWith": [
                              "PrimaryKey"
                            ],
                            "label": "Primary Key"
                          },
                          "type": "CopyableLabel"
                        }
                      ]
                    },
                    {
                      "description": "Using the ARM template deploy an Azure VM, install the prerequisites and start execution.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-NetskopeV2WebTransactions-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tDocker Image Name (mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions)\n\t\tNetskope HostName \n\t\tNetskope API Token \n\t\tSeek Timestamp (The epoch timestamp that you want to seek the pubsublite pointer, can be left empty) \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBackoff Retry Count (The retry count for token related errors before restarting the execution.)  \n\t\tBackoff Sleep Time (Number of seconds to sleep before retrying) \n\t\tIdle Timeout (Number of seconds to wait for Web Transactions Data before restarting execution) \n\t\tVM Name \n\t\tAuthentication Type \n\t\tAdmin Password or Key \n\t\tDNS Label Prefix \n\t\tUbuntu OS Version \n\t\tLocation \n\t\tVM Size \n\t\tSubnet Name \n\t\tNetwork Security Group Name \n\t\tSecurity Type \n4. Click on **Review+Create**. \n5. Then after validation click on **Create** to deploy.",
                      "title": "Option 1 - Using Azure Resource Manager (ARM) Template to deploy VM [Recommended]"
                    },
                    {
                      "description": "Use the following step-by-step instructions to deploy the docker based data connector manually on a previously created virtual machine.",
                      "title": "Option 2 - Manual Deployment on previously created virtual machine"
                    },
                    {
                      "description": "**1. Install docker and pull docker Image**\n\n>**NOTE:** Make sure that the VM is linux based (preferably Ubuntu).\n\n1. Firstly you will need to [SSH into the virtual machine](https://learn.microsoft.com/azure/virtual-machines/linux-vm-connect?tabs=Linux).\n2. Now install [docker engine](https://docs.docker.com/engine/install/).\n3. Now pull the docker image from docker hub using the command: 'sudo docker pull mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions'.\n4. Now to run the docker image use the command: 'sudo docker run -it -v $(pwd)/docker_persistent_volume:/app mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions'. You can replace mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions with the image id. Here docker_persistent_volume is the name of the folder that would be created on the vm in which the files will get stored."
                    },
                    {
                      "description": "**2. Configure the Parameters**\n\n1. Once the docker image is running it will ask for the required parameters.\n2. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tNetskope HostName \n\t\tNetskope API Token \n\t\tSeek Timestamp (The epoch timestamp that you want to seek the pubsublite pointer, can be left empty) \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBackoff Retry Count (The retry count for token related errors before restarting the execution.)  \n\t\tBackoff Sleep Time (Number of seconds to sleep before retrying) \n\t\tIdle Timeout (Number of seconds to wait for Web Transactions Data before restarting execution)\n3. Now the execution has started but is in interactive mode, so that shell cannot be stopped. To run it as a background process, stop the current execution by pressing Ctrl+C and then use the command: 'sudo docker run -d -v $(pwd)/docker_persistent_volume:/app mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions'."
                    },
                    {
                      "description": "**3. Stop the docker container**\n\n1. Use the command 'sudo docker container ps' to list the running docker containers. Note down your container id.\n2. Now stop the container using the command: 'sudo docker stop *<*container-id*>*'."
                    }
                  ]
                }
              }
            },
            {
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "apiVersion": "2023-04-01-preview",
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId2'),'/'))))]",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId2'))]",
                "contentId": "[variables('_dataConnectorContentId2')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorVersion2')]",
                "source": {
                  "kind": "Solution",
                  "name": "Netskopev2",
                  "sourceId": "[variables('_solutionId')]"
                },
                "author": {
                  "name": "Netskope"
                },
                "support": {
                  "name": "Netskope",
                  "tier": "Partner",
                  "link": "https://www.netskope.com/services#support"
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "contentId": "[variables('_dataConnectorContentId2')]",
        "contentKind": "DataConnector",
        "displayName": "Netskope Web Transactions Data Connector (using Azure Functions)",
        "contentProductId": "[variables('_dataConnectorcontentProductId2')]",
        "id": "[variables('_dataConnectorcontentProductId2')]",
        "version": "[variables('dataConnectorVersion2')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', last(split(variables('_dataConnectorId2'),'/'))))]",
      "dependsOn": [
        "[variables('_dataConnectorId2')]"
      ],
      "location": "[parameters('workspace-location')]",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentId2'))]",
        "contentId": "[variables('_dataConnectorContentId2')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorVersion2')]",
        "source": {
          "kind": "Solution",
          "name": "Netskopev2",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Netskope"
        },
        "support": {
          "name": "Netskope",
          "tier": "Partner",
          "link": "https://www.netskope.com/services#support"
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentId2'))]",
      "apiVersion": "2021-03-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
      "location": "[parameters('workspace-location')]",
      "kind": "GenericUI",
      "properties": {
        "connectorUiConfig": {
          "title": "Netskope Web Transactions Data Connector (using Azure Functions)",
          "publisher": "Netskope",
          "descriptionMarkdown": "The [Netskope Web Transactions](https://docs.netskope.com/en/netskope-help/data-security/transaction-events/netskope-transaction-events/) data connector provides the functionality of a docker image to pull the Netskope Web Transactions data from google pubsublite, process the data and ingest the processed data to Log Analytics. As part of this data connector two tables will be formed in Log Analytics, one for Web Transactions data and other for errors encountered during execution.\n\n\n For more details related to Web Transactions refer to the below documentation: \n 1. Netskope Web Transactions documentation: \n> https://docs.netskope.com/en/netskope-help/data-security/transaction-events/netskope-transaction-events/ \n",
          "graphQueries": [
            {
              "metricName": "Web Transactions data received",
              "legend": "NetskopeWebtxData_CL",
              "baseQuery": "NetskopeWebtxData_CL"
            },
            {
              "metricName": "Web Transactions Data Connector Errors",
              "legend": "NetskopeWebtxErrors_CL",
              "baseQuery": "NetskopeWebtxErrors_CL"
            }
          ],
          "dataTypes": [
            {
              "name": "NetskopeWebtxData_CL",
              "lastDataReceivedQuery": "NetskopeWebtxData_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            },
            {
              "name": "NetskopeWebtxErrors_CL",
              "lastDataReceivedQuery": "NetskopeWebtxErrors_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
            }
          ],
          "connectivityCriterias": [
            {
              "type": "IsConnectedQuery",
              "value": [
                "NetskopeWebtxData_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            },
            {
              "type": "IsConnectedQuery",
              "value": [
                "NetskopeWebtxErrors_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
              ]
            }
          ],
          "sampleQueries": [
            {
              "description": "Netskope Web Transactions Data",
              "query": "NetskopeWebtxData_CL\n | sort by TimeGenerated desc"
            },
            {
              "description": "Netskope Web Transactions Data Connector Errors",
              "query": "NetskopeWebtxErrors_CL\n | sort by TimeGenerated desc"
            }
          ],
          "availability": {
            "status": 1,
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions on the workspace are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              },
              {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                  "action": true
                }
              }
            ],
            "customs": [
              {
                "name": "Azure Subscription",
                "description": "Azure Subscription with owner role is required to register an application in Microsoft Entra ID and assign role of contributor to app in resource group."
              },
              {
                "name": "Microsoft.Compute permissions",
                "description": "Read and write permissions to Azure VMs is required. [See the documentation to learn more about Azure VMs](https://learn.microsoft.com/azure/virtual-machines/overview)."
              },
              {
                "name": "TransactionEvents Credentials and Permissions",
                "description": "**Netskope Tenant** and **Netskope API Token** is required. [See the documentation to learn more about Transaction Events.](https://docs.netskope.com/en/netskope-help/data-security/transaction-events/netskope-transaction-events/)"
              },
              {
                "name": "Microsoft.Web/sites permissions",
                "description": "Read and write permissions to Azure Functions to create a Function App is required. [See the documentation to learn more about Azure Functions](https://docs.microsoft.com/azure/azure-functions/)."
              }
            ]
          },
          "instructionSteps": [
            {
              "description": ">**NOTE:** This connector provides the functionality of ingesting Netskope Web Transactions data using a docker image to be deployed on a virtual machine (Either Azure VM/On Premise VM). Check the [Azure VM pricing page](https://azure.microsoft.com/pricing/details/virtual-machines/linux) for details."
            },
            {
              "description": ">**(Optional Step)** Securely store workspace and API authorization key(s) or token(s) in Azure Key Vault. Azure Key Vault provides a secure mechanism to store and retrieve key values. [Follow these instructions](https://docs.microsoft.com/azure/app-service/app-service-key-vault-references) to use Azure Key Vault with an Azure Function App."
            },
            {
              "description": "**STEP 1 - Steps to create/get Credentials for the Netskope account** \n\n Follow the steps in this section to create/get **Netskope Hostname** and **Netskope API Token**:\n 1. Login to your **Netskope Tenant** and go to the **Settings menu** on the left navigation bar.\n 2. Click on Tools and then **REST API v2**\n 3. Now, click on the new token button. Then it will ask for token name, expiration duration and the endpoints that you want to fetch data from.\n 5. Once that is done click the save button, the token will be generated. Copy the token and save at a secure place for further usage."
            },
            {
              "description": "**STEP 2 - Choose one from the following two deployment options to deploy the docker based data connector to ingest Netskope Web Transactions data **\n\n>**IMPORTANT:** Before deploying Netskope data connector, have the Workspace ID and Workspace Primary Key (can be copied from the following) readily available, as well as the Netskope API Authorization Key(s) [Make sure the token has permissions for transaction events].",
              "instructions": [
                {
                  "parameters": {
                    "fillWith": [
                      "WorkspaceId"
                    ],
                    "label": "Workspace ID"
                  },
                  "type": "CopyableLabel"
                },
                {
                  "parameters": {
                    "fillWith": [
                      "PrimaryKey"
                    ],
                    "label": "Primary Key"
                  },
                  "type": "CopyableLabel"
                }
              ]
            },
            {
              "description": "Using the ARM template deploy an Azure VM, install the prerequisites and start execution.\n\n1. Click the **Deploy to Azure** button below. \n\n\t[![Deploy To Azure](https://aka.ms/deploytoazurebutton)](https://aka.ms/sentinel-NetskopeV2WebTransactions-azuredeploy)\n2. Select the preferred **Subscription**, **Resource Group** and **Location**. \n3. Enter the below information : \n\t\tDocker Image Name (mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions)\n\t\tNetskope HostName \n\t\tNetskope API Token \n\t\tSeek Timestamp (The epoch timestamp that you want to seek the pubsublite pointer, can be left empty) \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBackoff Retry Count (The retry count for token related errors before restarting the execution.)  \n\t\tBackoff Sleep Time (Number of seconds to sleep before retrying) \n\t\tIdle Timeout (Number of seconds to wait for Web Transactions Data before restarting execution) \n\t\tVM Name \n\t\tAuthentication Type \n\t\tAdmin Password or Key \n\t\tDNS Label Prefix \n\t\tUbuntu OS Version \n\t\tLocation \n\t\tVM Size \n\t\tSubnet Name \n\t\tNetwork Security Group Name \n\t\tSecurity Type \n4. Click on **Review+Create**. \n5. Then after validation click on **Create** to deploy.",
              "title": "Option 1 - Using Azure Resource Manager (ARM) Template to deploy VM [Recommended]"
            },
            {
              "description": "Use the following step-by-step instructions to deploy the docker based data connector manually on a previously created virtual machine.",
              "title": "Option 2 - Manual Deployment on previously created virtual machine"
            },
            {
              "description": "**1. Install docker and pull docker Image**\n\n>**NOTE:** Make sure that the VM is linux based (preferably Ubuntu).\n\n1. Firstly you will need to [SSH into the virtual machine](https://learn.microsoft.com/azure/virtual-machines/linux-vm-connect?tabs=Linux).\n2. Now install [docker engine](https://docs.docker.com/engine/install/).\n3. Now pull the docker image from docker hub using the command: 'sudo docker pull mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions'.\n4. Now to run the docker image use the command: 'sudo docker run -it -v $(pwd)/docker_persistent_volume:/app mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions'. You can replace mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions with the image id. Here docker_persistent_volume is the name of the folder that would be created on the vm in which the files will get stored."
            },
            {
              "description": "**2. Configure the Parameters**\n\n1. Once the docker image is running it will ask for the required parameters.\n2. Add each of the following application settings individually, with their respective values (case-sensitive): \n\t\tNetskope HostName \n\t\tNetskope API Token \n\t\tSeek Timestamp (The epoch timestamp that you want to seek the pubsublite pointer, can be left empty) \n\t\tWorkspace ID \n\t\tWorkspace Key \n\t\tBackoff Retry Count (The retry count for token related errors before restarting the execution.)  \n\t\tBackoff Sleep Time (Number of seconds to sleep before retrying) \n\t\tIdle Timeout (Number of seconds to wait for Web Transactions Data before restarting execution)\n3. Now the execution has started but is in interactive mode, so that shell cannot be stopped. To run it as a background process, stop the current execution by pressing Ctrl+C and then use the command: 'sudo docker run -d -v $(pwd)/docker_persistent_volume:/app mgulledge/netskope-microsoft-sentinel-plugin:netskopewebtransactions'."
            },
            {
              "description": "**3. Stop the docker container**\n\n1. Use the command 'sudo docker container ps' to list the running docker containers. Note down your container id.\n2. Now stop the container using the command: 'sudo docker stop *<*container-id*>*'."
            }
          ],
          "id": "[variables('_uiConfigId2')]"
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnectorDefinition3'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition3')]",
        "displayName": "Netskope Alerts and Events",
        "contentKind": "DataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {},
          "variables": {},
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition3'))]",
              "apiVersion": "2022-09-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
              "location": "[parameters('workspace-location')]",
              "kind": "Customizable",
              "properties": {
                "connectorUiConfig": {
                  "id": "NetskopeCCP",
                  "title": "Netskope Alerts and Events",
                  "publisher": "Netskope",
                  "descriptionMarkdown": "Netskope Security Alerts and Events",
                  "graphQueriesTableName": "NetskopeAlerts_CL",
                  "graphQueries": [
                    {
                      "metricName": "Total Netskope Alerts received",
                      "legend": "Netskope Alerts",
                      "baseQuery": "NetskopeAlerts_CL"
                    },
                    {
                      "metricName": "Total Netskope Application Events",
                      "legend": "Netskope Application Events",
                      "baseQuery": "NetskopeEventsApplication_CL"
                    },
                    {
                      "metricName": "Total Netskope Audit Events",
                      "legend": "Netskope Audit Events",
                      "baseQuery": "NetskopeEventsAudit_CL"
                    },
                    {
                      "metricName": "Total Netskope Connection Events",
                      "legend": "Netskope Connection Events",
                      "baseQuery": "NetskopeEventsConnection_CL"
                    },
                    {
                      "metricName": "Total Netskope DLP Events",
                      "legend": "Netskope DLP Events",
                      "baseQuery": "NetskopeEventsDLP_CL"
                    },
                    {
                      "metricName": "Total Netskope Endpoint Events",
                      "legend": "Netskope Endpoint Events",
                      "baseQuery": "NetskopeEventsEndpoint_CL"
                    },
                    {
                      "metricName": "Total Netskope Infrastructure Events",
                      "legend": "Netskope Infrastructure Events",
                      "baseQuery": "NetskopeEventsInfrastructure_CL"
                    },
                    {
                      "metricName": "Total Netskope Network Events",
                      "legend": "Netskope Network Events",
                      "baseQuery": "NetskopeEventsNetwork_CL"
                    },
                    {
                      "metricName": "Total Netskope Page Events",
                      "legend": "Netskope Page Events",
                      "baseQuery": "NetskopeEventsPage_CL"
                    }
                  ],
                  "sampleQueries": [
                    {
                      "description": "Get Sample of Netskope events",
                      "query": "NetskopeAlerts_CL\n | take 10"
                    }
                  ],
                  "dataTypes": [
                    {
                      "name": "NetskopeAlerts_CL",
                      "lastDataReceivedQuery": "NetskopeAlerts_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "NetskopeEventsApplication_CL",
                      "lastDataReceivedQuery": "NetskopeEventsApplication_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "NetskopeEventsAudit_CL",
                      "lastDataReceivedQuery": "NetskopeEventsAudit_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "NetskopeEventsConnection_CL",
                      "lastDataReceivedQuery": "NetskopeEventsConnection_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "NetskopeEventsDLP_CL",
                      "lastDataReceivedQuery": "NetskopeEventsDLP_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "NetskopeEventsEndpoint_CL",
                      "lastDataReceivedQuery": "NetskopeEventsEndpoint_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "NetskopeEventsInfrastructure_CL",
                      "lastDataReceivedQuery": "NetskopeEventsInfrastructure_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "NetskopeEventsNetwork_CL",
                      "lastDataReceivedQuery": "NetskopeEventsNetwork_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    },
                    {
                      "name": "NetskopeEventsPage_CL",
                      "lastDataReceivedQuery": "NetskopeEventsPage_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                    }
                  ],
                  "connectivityCriteria": [
                    {
                      "type": "HasDataConnectors"
                    }
                  ],
                  "availability": {
                    "isPreview": false
                  },
                  "permissions": {
                    "resourceProvider": [
                      {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                          "write": true,
                          "read": true,
                          "delete": true
                        }
                      }
                    ],
                    "customs": [
                      {
                        "name": "Netskope organisation url",
                        "description": "The Netskope data connector requires you to provide your organisation url. You can find your organisation url by signing into the Netskope portal."
                      },
                      {
                        "name": "Netskope API key",
                        "description": "The Netskope data connector requires you to provide a valid API key. You can create one by following the [Netskope documentation](https://docs.netskope.com/en/rest-api-v2-overview-312207/)."
                      }
                    ]
                  },
                  "instructionSteps": [
                    {
                      "title": "STEP 1 - Create a Netskope API key.",
                      "description": "Follow the [Netskope documentation](https://docs.netskope.com/en/rest-api-v2-overview-312207/) for guidance on this step."
                    },
                    {
                      "title": "STEP 2 - Enter your Netskope product Details",
                      "description": "Enter your Netskope organisation url & API Token below:",
                      "instructions": [
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "Organisation URL",
                            "placeholder": "Enter your organisation url",
                            "type": "text",
                            "name": "OrganisationURL"
                          }
                        },
                        {
                          "type": "Textbox",
                          "parameters": {
                            "label": "API Key",
                            "placeholder": "Enter your API Key",
                            "type": "password",
                            "name": "apikey"
                          }
                        },
                        {
                          "type": "InstructionStepsGroup",
                          "parameters": {
                            "instructionSteps": [
                              {
                                "title": "OPTIONAL: Specify the Index the API uses.",
                                "description": "**Configuring the index is optional and only required in advanced scenario's.** \n Netskope uses an [index](https://docs.netskope.com/en/using-the-rest-api-v2-dataexport-iterator-endpoints/#how-do-iterator-endpoints-function) to retrieve events. In some advanced cases (consuming the event in multiple Microsoft Sentinel workspaces, or pre-fatiguing the index to only retrieve recent data), a customer might want to have direct control over the index.",
                                "instructions": [
                                  {
                                    "type": "Textbox",
                                    "parameters": {
                                      "label": "Index",
                                      "placeholder": "NetskopeCCP",
                                      "type": "text",
                                      "name": "Index"
                                    }
                                  }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    },
                    {
                      "title": "STEP 3 - Click Connect",
                      "description": "Verify all fields above were filled in correctly. Press the Connect to connect Netskope to Microsoft Sentinel.",
                      "instructions": [
                        {
                          "type": "ConnectionToggleButton",
                          "parameters": {
                            "connectLabel": "connect",
                            "name": "connect"
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition3')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition3'))]",
                "contentId": "[variables('_dataConnectorContentIdConnectorDefinition3')]",
                "kind": "DataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Netskope"
                },
                "support": {
                  "name": "Netskope",
                  "tier": "Partner",
                  "link": "https://www.netskope.com/services#support"
                },
                "dependencies": {
                  "criteria": [
                    {
                      "version": "[variables('dataConnectorCCPVersion')]",
                      "contentId": "[variables('_dataConnectorContentIdConnections3')]",
                      "kind": "ResourcesDataConnector"
                    }
                  ]
                }
              }
            },
            {
              "name": "Netskope_DCR",
              "apiVersion": "2022-06-01",
              "type": "Microsoft.Insights/dataCollectionRules",
              "location": "[parameters('workspace-location')]",
              "kind": "[variables('blanks')]",
              "properties": {
                "dataCollectionEndpointId": "[variables('dataCollectionEndpointId3')]",
                "streamDeclarations": {
                  "Custom-NetskopeAlerts": {
                    "columns": [
                      {
                        "name": "_id",
                        "type": "string"
                      },
                      {
                        "name": "access_method",
                        "type": "string"
                      },
                      {
                        "name": "account_id",
                        "type": "string"
                      },
                      {
                        "name": "account_name",
                        "type": "string"
                      },
                      {
                        "name": "acked",
                        "type": "string"
                      },
                      {
                        "name": "action",
                        "type": "string"
                      },
                      {
                        "name": "activity",
                        "type": "string"
                      },
                      {
                        "name": "alert",
                        "type": "string"
                      },
                      {
                        "name": "alert_id",
                        "type": "string"
                      },
                      {
                        "name": "alert_name",
                        "type": "string"
                      },
                      {
                        "name": "alert_type",
                        "type": "string"
                      },
                      {
                        "name": "app",
                        "type": "string"
                      },
                      {
                        "name": "app_activity",
                        "type": "string"
                      },
                      {
                        "name": "app_session_id",
                        "type": "int"
                      },
                      {
                        "name": "appcategory",
                        "type": "string"
                      },
                      {
                        "name": "appsuite",
                        "type": "string"
                      },
                      {
                        "name": "asset_id",
                        "type": "string"
                      },
                      {
                        "name": "asset_object_id",
                        "type": "string"
                      },
                      {
                        "name": "breach_date",
                        "type": "int"
                      },
                      {
                        "name": "breach_description",
                        "type": "string"
                      },
                      {
                        "name": "breach_id",
                        "type": "string"
                      },
                      {
                        "name": "breach_media_references",
                        "type": "string"
                      },
                      {
                        "name": "breach_score",
                        "type": "string"
                      },
                      {
                        "name": "breach_target_references",
                        "type": "string"
                      },
                      {
                        "name": "browser",
                        "type": "string"
                      },
                      {
                        "name": "browser_session_id",
                        "type": "int"
                      },
                      {
                        "name": "browser_version",
                        "type": "string"
                      },
                      {
                        "name": "bypass_traffic",
                        "type": "string"
                      },
                      {
                        "name": "category",
                        "type": "string"
                      },
                      {
                        "name": "cci",
                        "type": "int"
                      },
                      {
                        "name": "ccl",
                        "type": "string"
                      },
                      {
                        "name": "client_bytes",
                        "type": "int"
                      },
                      {
                        "name": "compliance_standards",
                        "type": "dynamic"
                      },
                      {
                        "name": "conn_duration",
                        "type": "int"
                      },
                      {
                        "name": "conn_endtime",
                        "type": "int"
                      },
                      {
                        "name": "conn_starttime",
                        "type": "int"
                      },
                      {
                        "name": "connection_id",
                        "type": "int"
                      },
                      {
                        "name": "CononicalName",
                        "type": "string"
                      },
                      {
                        "name": "count",
                        "type": "int"
                      },
                      {
                        "name": "data_type",
                        "type": "string"
                      },
                      {
                        "name": "device",
                        "type": "string"
                      },
                      {
                        "name": "device_classification",
                        "type": "string"
                      },
                      {
                        "name": "dlp_file",
                        "type": "string"
                      },
                      {
                        "name": "dlp_incident_id",
                        "type": "int"
                      },
                      {
                        "name": "dlp_is_unique_count",
                        "type": "string"
                      },
                      {
                        "name": "dlp_mail_parent_id",
                        "type": "string"
                      },
                      {
                        "name": "dlp_parent_id",
                        "type": "int"
                      },
                      {
                        "name": "dlp_profile",
                        "type": "string"
                      },
                      {
                        "name": "dlp_rule",
                        "type": "string"
                      },
                      {
                        "name": "dlp_rule_count",
                        "type": "int"
                      },
                      {
                        "name": "dlp_rule_severity",
                        "type": "string"
                      },
                      {
                        "name": "dlp_unique_count",
                        "type": "int"
                      },
                      {
                        "name": "domain",
                        "type": "string"
                      },
                      {
                        "name": "dst_country",
                        "type": "string"
                      },
                      {
                        "name": "dst_geoip_src",
                        "type": "int"
                      },
                      {
                        "name": "dst_latitude",
                        "type": "int"
                      },
                      {
                        "name": "dst_location",
                        "type": "string"
                      },
                      {
                        "name": "dst_longitude",
                        "type": "int"
                      },
                      {
                        "name": "dst_region",
                        "type": "string"
                      },
                      {
                        "name": "dst_timezone",
                        "type": "string"
                      },
                      {
                        "name": "dst_zipcode",
                        "type": "string"
                      },
                      {
                        "name": "dstip",
                        "type": "string"
                      },
                      {
                        "name": "dsthost",
                        "type": "string"
                      },
                      {
                        "name": "dstport",
                        "type": "int"
                      },
                      {
                        "name": "email_source",
                        "type": "string"
                      },
                      {
                        "name": "event_type",
                        "type": "string"
                      },
                      {
                        "name": "evt_src_chnl",
                        "type": "string"
                      },
                      {
                        "name": "exposure",
                        "type": "string"
                      },
                      {
                        "name": "external_collaborator_count",
                        "type": "int"
                      },
                      {
                        "name": "external_email",
                        "type": "int"
                      },
                      {
                        "name": "file_cls_encrypted",
                        "type": "boolean"
                      },
                      {
                        "name": "file_lang",
                        "type": "string"
                      },
                      {
                        "name": "file_path",
                        "type": "string"
                      },
                      {
                        "name": "file_size",
                        "type": "int"
                      },
                      {
                        "name": "file_type",
                        "type": "string"
                      },
                      {
                        "name": "from_user",
                        "type": "string"
                      },
                      {
                        "name": "fromlogs",
                        "type": "string"
                      },
                      {
                        "name": "hostname",
                        "type": "string"
                      },
                      {
                        "name": "http_transaction_count",
                        "type": "int"
                      },
                      {
                        "name": "iaas_asset_tags",
                        "type": "dynamic"
                      },
                      {
                        "name": "iaas_remediated",
                        "type": "string"
                      },
                      {
                        "name": "instance",
                        "type": "string"
                      },
                      {
                        "name": "instance_id",
                        "type": "string"
                      },
                      {
                        "name": "internal_collaborator_count",
                        "type": "int"
                      },
                      {
                        "name": "justification_reason",
                        "type": "string"
                      },
                      {
                        "name": "justification_type",
                        "type": "string"
                      },
                      {
                        "name": "last_app",
                        "type": "string"
                      },
                      {
                        "name": "last_country",
                        "type": "string"
                      },
                      {
                        "name": "last_device",
                        "type": "string"
                      },
                      {
                        "name": "last_location",
                        "type": "string"
                      },
                      {
                        "name": "last_region",
                        "type": "string"
                      },
                      {
                        "name": "last_timestamp",
                        "type": "int"
                      },
                      {
                        "name": "log_file_name",
                        "type": "string"
                      },
                      {
                        "name": "malicious",
                        "type": "string"
                      },
                      {
                        "name": "malsite_category",
                        "type": "dynamic"
                      },
                      {
                        "name": "malsite_country",
                        "type": "string"
                      },
                      {
                        "name": "malsite_id",
                        "type": "string"
                      },
                      {
                        "name": "malsite_ip_host",
                        "type": "string"
                      },
                      {
                        "name": "malsite_latitude",
                        "type": "int"
                      },
                      {
                        "name": "malsite_longitude",
                        "type": "int"
                      },
                      {
                        "name": "malsite_region",
                        "type": "string"
                      },
                      {
                        "name": "managed_app",
                        "type": "string"
                      },
                      {
                        "name": "managementID",
                        "type": "string"
                      },
                      {
                        "name": "matched_username",
                        "type": "string"
                      },
                      {
                        "name": "md5",
                        "type": "string"
                      },
                      {
                        "name": "mime_type",
                        "type": "string"
                      },
                      {
                        "name": "modified",
                        "type": "int"
                      },
                      {
                        "name": "netskope_activity",
                        "type": "string"
                      },
                      {
                        "name": "netskope_pop",
                        "type": "string"
                      },
                      {
                        "name": "notify_template",
                        "type": "string"
                      },
                      {
                        "name": "nsdeviceuid",
                        "type": "string"
                      },
                      {
                        "name": "numbytes",
                        "type": "int"
                      },
                      {
                        "name": "object",
                        "type": "string"
                      },
                      {
                        "name": "object_id",
                        "type": "string"
                      },
                      {
                        "name": "object_type",
                        "type": "string"
                      },
                      {
                        "name": "org",
                        "type": "string"
                      },
                      {
                        "name": "organization_unit",
                        "type": "string"
                      },
                      {
                        "name": "orig_ty",
                        "type": "string"
                      },
                      {
                        "name": "orignal_file_path",
                        "type": "string"
                      },
                      {
                        "name": "os",
                        "type": "string"
                      },
                      {
                        "name": "os_version",
                        "type": "string"
                      },
                      {
                        "name": "other_categories",
                        "type": "dynamic"
                      },
                      {
                        "name": "outer_doc_type",
                        "type": "int"
                      },
                      {
                        "name": "owner",
                        "type": "string"
                      },
                      {
                        "name": "page",
                        "type": "string"
                      },
                      {
                        "name": "page_site",
                        "type": "string"
                      },
                      {
                        "name": "parent_id",
                        "type": "string"
                      },
                      {
                        "name": "password_type",
                        "type": "string"
                      },
                      {
                        "name": "policy",
                        "type": "string"
                      },
                      {
                        "name": "policy_actions",
                        "type": "dynamic"
                      },
                      {
                        "name": "policy_id",
                        "type": "string"
                      },
                      {
                        "name": "profile_id",
                        "type": "string"
                      },
                      {
                        "name": "protocol",
                        "type": "string"
                      },
                      {
                        "name": "referer",
                        "type": "string"
                      },
                      {
                        "name": "region_id",
                        "type": "string"
                      },
                      {
                        "name": "region_name",
                        "type": "string"
                      },
                      {
                        "name": "req_cnt",
                        "type": "int"
                      },
                      {
                        "name": "request_id",
                        "type": "int"
                      },
                      {
                        "name": "resource_category",
                        "type": "string"
                      },
                      {
                        "name": "resource_group",
                        "type": "string"
                      },
                      {
                        "name": "resp_cnt",
                        "type": "int"
                      },
                      {
                        "name": "sa_profile_id",
                        "type": "int"
                      },
                      {
                        "name": "sa_profile_name",
                        "type": "string"
                      },
                      {
                        "name": "sa_rule_id",
                        "type": "string"
                      },
                      {
                        "name": "sa_rule_name",
                        "type": "string"
                      },
                      {
                        "name": "sa_rule_severity",
                        "type": "string"
                      },
                      {
                        "name": "sAMAccountName",
                        "type": "string"
                      },
                      {
                        "name": "sanctioned_instance",
                        "type": "string"
                      },
                      {
                        "name": "scan_type",
                        "type": "string"
                      },
                      {
                        "name": "serial",
                        "type": "string"
                      },
                      {
                        "name": "server_bytes",
                        "type": "int"
                      },
                      {
                        "name": "sessionid",
                        "type": "string"
                      },
                      {
                        "name": "severity",
                        "type": "string"
                      },
                      {
                        "name": "severity_level",
                        "type": "string"
                      },
                      {
                        "name": "severity_level_id",
                        "type": "int"
                      },
                      {
                        "name": "sfwder",
                        "type": "string"
                      },
                      {
                        "name": "sha256",
                        "type": "string"
                      },
                      {
                        "name": "shared_domains",
                        "type": "string"
                      },
                      {
                        "name": "shared_with",
                        "type": "string"
                      },
                      {
                        "name": "site",
                        "type": "string"
                      },
                      {
                        "name": "src_country",
                        "type": "string"
                      },
                      {
                        "name": "src_geoip_src",
                        "type": "int"
                      },
                      {
                        "name": "src_latitude",
                        "type": "int"
                      },
                      {
                        "name": "src_location",
                        "type": "string"
                      },
                      {
                        "name": "src_longitude",
                        "type": "int"
                      },
                      {
                        "name": "src_region",
                        "type": "string"
                      },
                      {
                        "name": "src_time",
                        "type": "string"
                      },
                      {
                        "name": "src_timezone",
                        "type": "string"
                      },
                      {
                        "name": "src_zipcode",
                        "type": "string"
                      },
                      {
                        "name": "srcip",
                        "type": "string"
                      },
                      {
                        "name": "suppression_end_time",
                        "type": "int"
                      },
                      {
                        "name": "suppression_key",
                        "type": "string"
                      },
                      {
                        "name": "suppression_start_time",
                        "type": "int"
                      },
                      {
                        "name": "telemetry_app",
                        "type": "string"
                      },
                      {
                        "name": "threat_match_field",
                        "type": "string"
                      },
                      {
                        "name": "threat_match_value",
                        "type": "string"
                      },
                      {
                        "name": "threat_source_id",
                        "type": "int"
                      },
                      {
                        "name": "threshold",
                        "type": "int"
                      },
                      {
                        "name": "threshold_time",
                        "type": "int"
                      },
                      {
                        "name": "timestamp",
                        "type": "int"
                      },
                      {
                        "name": "title",
                        "type": "string"
                      },
                      {
                        "name": "to_object",
                        "type": "string"
                      },
                      {
                        "name": "total_collaborator_count",
                        "type": "int"
                      },
                      {
                        "name": "traffic_type",
                        "type": "string"
                      },
                      {
                        "name": "transaction_id",
                        "type": "int"
                      },
                      {
                        "name": "true_obj_category",
                        "type": "string"
                      },
                      {
                        "name": "true_obj_type",
                        "type": "string"
                      },
                      {
                        "name": "tss_mode",
                        "type": "string"
                      },
                      {
                        "name": "two_factor_auth",
                        "type": "string"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "universal_connector",
                        "type": "string"
                      },
                      {
                        "name": "ur_normalized",
                        "type": "string"
                      },
                      {
                        "name": "url",
                        "type": "string"
                      },
                      {
                        "name": "user",
                        "type": "string"
                      },
                      {
                        "name": "user_generated",
                        "type": "string"
                      },
                      {
                        "name": "user_id",
                        "type": "string"
                      },
                      {
                        "name": "useragent",
                        "type": "string"
                      },
                      {
                        "name": "userip",
                        "type": "string"
                      },
                      {
                        "name": "userkey",
                        "type": "string"
                      },
                      {
                        "name": "userPrincipalName",
                        "type": "string"
                      },
                      {
                        "name": "web_universal_connector",
                        "type": "string"
                      }
                    ]
                  },
                  "Custom-NetskopeEventsApplication": {
                    "columns": [
                      {
                        "name": "_id",
                        "type": "string"
                      },
                      {
                        "name": "access_method",
                        "type": "string"
                      },
                      {
                        "name": "action",
                        "type": "string"
                      },
                      {
                        "name": "activity",
                        "type": "string"
                      },
                      {
                        "name": "alert",
                        "type": "string"
                      },
                      {
                        "name": "alert_type",
                        "type": "string"
                      },
                      {
                        "name": "app",
                        "type": "string"
                      },
                      {
                        "name": "app_activity",
                        "type": "string"
                      },
                      {
                        "name": "app_session_id",
                        "type": "int"
                      },
                      {
                        "name": "appcategory",
                        "type": "string"
                      },
                      {
                        "name": "appsuite",
                        "type": "string"
                      },
                      {
                        "name": "audit_category",
                        "type": "string"
                      },
                      {
                        "name": "audit_type",
                        "type": "string"
                      },
                      {
                        "name": "browser",
                        "type": "string"
                      },
                      {
                        "name": "browser_session_id",
                        "type": "int"
                      },
                      {
                        "name": "browser_version",
                        "type": "string"
                      },
                      {
                        "name": "category",
                        "type": "string"
                      },
                      {
                        "name": "cci",
                        "type": "int"
                      },
                      {
                        "name": "ccl",
                        "type": "string"
                      },
                      {
                        "name": "channel_id",
                        "type": "string"
                      },
                      {
                        "name": "client_bytes",
                        "type": "int"
                      },
                      {
                        "name": "conn_duration",
                        "type": "int"
                      },
                      {
                        "name": "connection_id",
                        "type": "int"
                      },
                      {
                        "name": "CononicalName",
                        "type": "string"
                      },
                      {
                        "name": "count",
                        "type": "int"
                      },
                      {
                        "name": "custom_connector",
                        "type": "string"
                      },
                      {
                        "name": "data_center",
                        "type": "string"
                      },
                      {
                        "name": "data_type",
                        "type": "string"
                      },
                      {
                        "name": "device",
                        "type": "string"
                      },
                      {
                        "name": "device_classification",
                        "type": "string"
                      },
                      {
                        "name": "dlp_file",
                        "type": "string"
                      },
                      {
                        "name": "dlp_incident_id",
                        "type": "int"
                      },
                      {
                        "name": "dlp_is_unique_count",
                        "type": "string"
                      },
                      {
                        "name": "dlp_mail_parent_id",
                        "type": "string"
                      },
                      {
                        "name": "dlp_parent_id",
                        "type": "int"
                      },
                      {
                        "name": "dlp_profile",
                        "type": "string"
                      },
                      {
                        "name": "dlp_rule",
                        "type": "string"
                      },
                      {
                        "name": "dlp_rule_count",
                        "type": "int"
                      },
                      {
                        "name": "dlp_rule_severity",
                        "type": "string"
                      },
                      {
                        "name": "dlp_unique_count",
                        "type": "int"
                      },
                      {
                        "name": "dst_country",
                        "type": "string"
                      },
                      {
                        "name": "dst_geoip_src",
                        "type": "int"
                      },
                      {
                        "name": "dst_latitude",
                        "type": "int"
                      },
                      {
                        "name": "dst_location",
                        "type": "string"
                      },
                      {
                        "name": "dst_longitude",
                        "type": "int"
                      },
                      {
                        "name": "dst_region",
                        "type": "string"
                      },
                      {
                        "name": "dst_timezone",
                        "type": "string"
                      },
                      {
                        "name": "dst_zipcode",
                        "type": "string"
                      },
                      {
                        "name": "dsthost",
                        "type": "string"
                      },
                      {
                        "name": "dstip",
                        "type": "string"
                      },
                      {
                        "name": "dstport",
                        "type": "int"
                      },
                      {
                        "name": "exposure",
                        "type": "string"
                      },
                      {
                        "name": "file_lang",
                        "type": "string"
                      },
                      {
                        "name": "file_path",
                        "type": "string"
                      },
                      {
                        "name": "file_size",
                        "type": "int"
                      },
                      {
                        "name": "file_type",
                        "type": "string"
                      },
                      {
                        "name": "from_user",
                        "type": "string"
                      },
                      {
                        "name": "from_user_category",
                        "type": "string"
                      },
                      {
                        "name": "fromlogs",
                        "type": "string"
                      },
                      {
                        "name": "hostname",
                        "type": "string"
                      },
                      {
                        "name": "instance",
                        "type": "string"
                      },
                      {
                        "name": "instance_id",
                        "type": "string"
                      },
                      {
                        "name": "internal_collaborator_count",
                        "type": "int"
                      },
                      {
                        "name": "log_file_name",
                        "type": "string"
                      },
                      {
                        "name": "logintype",
                        "type": "string"
                      },
                      {
                        "name": "loginurl",
                        "type": "string"
                      },
                      {
                        "name": "managed_app",
                        "type": "string"
                      },
                      {
                        "name": "managementID",
                        "type": "string"
                      },
                      {
                        "name": "md5",
                        "type": "string"
                      },
                      {
                        "name": "mime_type",
                        "type": "string"
                      },
                      {
                        "name": "modified",
                        "type": "int"
                      },
                      {
                        "name": "netskope_activity",
                        "type": "string"
                      },
                      {
                        "name": "netskope_pop",
                        "type": "string"
                      },
                      {
                        "name": "notify_template",
                        "type": "string"
                      },
                      {
                        "name": "nsdeviceuid",
                        "type": "string"
                      },
                      {
                        "name": "numbytes",
                        "type": "int"
                      },
                      {
                        "name": "object",
                        "type": "string"
                      },
                      {
                        "name": "object_id",
                        "type": "string"
                      },
                      {
                        "name": "object_type",
                        "type": "string"
                      },
                      {
                        "name": "org",
                        "type": "string"
                      },
                      {
                        "name": "organization_unit",
                        "type": "string"
                      },
                      {
                        "name": "orignal_file_path",
                        "type": "string"
                      },
                      {
                        "name": "os",
                        "type": "string"
                      },
                      {
                        "name": "os_version",
                        "type": "string"
                      },
                      {
                        "name": "other_categories",
                        "type": "dynamic"
                      },
                      {
                        "name": "outer_doc_type",
                        "type": "int"
                      },
                      {
                        "name": "owner",
                        "type": "string"
                      },
                      {
                        "name": "page",
                        "type": "string"
                      },
                      {
                        "name": "page_site",
                        "type": "string"
                      },
                      {
                        "name": "parent_id",
                        "type": "string"
                      },
                      {
                        "name": "policy",
                        "type": "string"
                      },
                      {
                        "name": "policy_id",
                        "type": "string"
                      },
                      {
                        "name": "protocol",
                        "type": "string"
                      },
                      {
                        "name": "referer",
                        "type": "string"
                      },
                      {
                        "name": "req_cnt",
                        "type": "int"
                      },
                      {
                        "name": "request_id",
                        "type": "int"
                      },
                      {
                        "name": "resp_cnt",
                        "type": "int"
                      },
                      {
                        "name": "sAMAccountName",
                        "type": "string"
                      },
                      {
                        "name": "sanctioned_instance",
                        "type": "string"
                      },
                      {
                        "name": "scan_type",
                        "type": "string"
                      },
                      {
                        "name": "serial",
                        "type": "string"
                      },
                      {
                        "name": "server_bytes",
                        "type": "int"
                      },
                      {
                        "name": "sessionid",
                        "type": "string"
                      },
                      {
                        "name": "severity",
                        "type": "string"
                      },
                      {
                        "name": "sfwder",
                        "type": "string"
                      },
                      {
                        "name": "sha256",
                        "type": "string"
                      },
                      {
                        "name": "shared_with",
                        "type": "string"
                      },
                      {
                        "name": "site",
                        "type": "string"
                      },
                      {
                        "name": "smtp_to",
                        "type": "dynamic"
                      },
                      {
                        "name": "src_country",
                        "type": "string"
                      },
                      {
                        "name": "src_geoip_src",
                        "type": "int"
                      },
                      {
                        "name": "src_latitude",
                        "type": "int"
                      },
                      {
                        "name": "src_location",
                        "type": "string"
                      },
                      {
                        "name": "src_longitude",
                        "type": "int"
                      },
                      {
                        "name": "src_region",
                        "type": "string"
                      },
                      {
                        "name": "src_time",
                        "type": "string"
                      },
                      {
                        "name": "src_timezone",
                        "type": "string"
                      },
                      {
                        "name": "src_zipcode",
                        "type": "string"
                      },
                      {
                        "name": "srcip",
                        "type": "string"
                      },
                      {
                        "name": "suppression_end_time",
                        "type": "int"
                      },
                      {
                        "name": "suppression_key",
                        "type": "string"
                      },
                      {
                        "name": "suppression_start_time",
                        "type": "int"
                      },
                      {
                        "name": "telemetry_app",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "int"
                      },
                      {
                        "name": "title",
                        "type": "string"
                      },
                      {
                        "name": "to_user",
                        "type": "string"
                      },
                      {
                        "name": "total_collaborator_count",
                        "type": "int"
                      },
                      {
                        "name": "traffic_type",
                        "type": "string"
                      },
                      {
                        "name": "transaction_id",
                        "type": "int"
                      },
                      {
                        "name": "true_obj_category",
                        "type": "string"
                      },
                      {
                        "name": "true_obj_type",
                        "type": "string"
                      },
                      {
                        "name": "tss_mode",
                        "type": "string"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "universal_connector",
                        "type": "string"
                      },
                      {
                        "name": "ur_normalized",
                        "type": "string"
                      },
                      {
                        "name": "url",
                        "type": "string"
                      },
                      {
                        "name": "user",
                        "type": "string"
                      },
                      {
                        "name": "user_category",
                        "type": "string"
                      },
                      {
                        "name": "user_id",
                        "type": "string"
                      },
                      {
                        "name": "useragent",
                        "type": "string"
                      },
                      {
                        "name": "userip",
                        "type": "string"
                      },
                      {
                        "name": "userkey",
                        "type": "string"
                      },
                      {
                        "name": "userPrincipalName",
                        "type": "string"
                      },
                      {
                        "name": "web_universal_connector",
                        "type": "string"
                      },
                      {
                        "name": "workspace",
                        "type": "string"
                      },
                      {
                        "name": "workspace_id",
                        "type": "string"
                      }
                    ]
                  },
                  "Custom-NetskopeEventsAudit": {
                    "columns": [
                      {
                        "name": "_id",
                        "type": "string"
                      },
                      {
                        "name": "audit_log_event",
                        "type": "string"
                      },
                      {
                        "name": "ccl",
                        "type": "string"
                      },
                      {
                        "name": "count",
                        "type": "int"
                      },
                      {
                        "name": "organization_unit",
                        "type": "string"
                      },
                      {
                        "name": "sAMAccountName",
                        "type": "string"
                      },
                      {
                        "name": "severity_level",
                        "type": "int"
                      },
                      {
                        "name": "supporting_data",
                        "type": "dynamic"
                      },
                      {
                        "name": "timestamp",
                        "type": "int"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "ur_normalized",
                        "type": "string"
                      },
                      {
                        "name": "user",
                        "type": "string"
                      },
                      {
                        "name": "userPrincipalName",
                        "type": "string"
                      }
                    ]
                  },
                  "Custom-NetskopeEventsConnection": {
                    "columns": [
                      {
                        "name": "_id",
                        "type": "string"
                      },
                      {
                        "name": "access_method",
                        "type": "string"
                      },
                      {
                        "name": "app",
                        "type": "string"
                      },
                      {
                        "name": "app_session_id",
                        "type": "int"
                      },
                      {
                        "name": "appcategory",
                        "type": "string"
                      },
                      {
                        "name": "browser",
                        "type": "string"
                      },
                      {
                        "name": "browser_session_id",
                        "type": "int"
                      },
                      {
                        "name": "browser_version",
                        "type": "string"
                      },
                      {
                        "name": "bypass_reason",
                        "type": "string"
                      },
                      {
                        "name": "bypass_traffic",
                        "type": "string"
                      },
                      {
                        "name": "category",
                        "type": "string"
                      },
                      {
                        "name": "cci",
                        "type": "int"
                      },
                      {
                        "name": "ccl",
                        "type": "string"
                      },
                      {
                        "name": "client_bytes",
                        "type": "int"
                      },
                      {
                        "name": "conn_duration",
                        "type": "int"
                      },
                      {
                        "name": "conn_endtime",
                        "type": "int"
                      },
                      {
                        "name": "conn_starttime",
                        "type": "int"
                      },
                      {
                        "name": "connection_id",
                        "type": "int"
                      },
                      {
                        "name": "CononicalName",
                        "type": "string"
                      },
                      {
                        "name": "count",
                        "type": "int"
                      },
                      {
                        "name": "device",
                        "type": "string"
                      },
                      {
                        "name": "domain",
                        "type": "string"
                      },
                      {
                        "name": "dst_country",
                        "type": "string"
                      },
                      {
                        "name": "dst_geoip_src",
                        "type": "int"
                      },
                      {
                        "name": "dst_latitude",
                        "type": "int"
                      },
                      {
                        "name": "dst_location",
                        "type": "string"
                      },
                      {
                        "name": "dst_longitude",
                        "type": "int"
                      },
                      {
                        "name": "dst_region",
                        "type": "string"
                      },
                      {
                        "name": "dst_timezone",
                        "type": "string"
                      },
                      {
                        "name": "dst_zipcode",
                        "type": "string"
                      },
                      {
                        "name": "dsthost",
                        "type": "string"
                      },
                      {
                        "name": "dstip",
                        "type": "string"
                      },
                      {
                        "name": "dstport",
                        "type": "int"
                      },
                      {
                        "name": "dynamic_classification",
                        "type": "string"
                      },
                      {
                        "name": "forward_to_proxy_profile",
                        "type": "string"
                      },
                      {
                        "name": "fromlogs",
                        "type": "string"
                      },
                      {
                        "name": "hostname",
                        "type": "string"
                      },
                      {
                        "name": "http_transaction_count",
                        "type": "int"
                      },
                      {
                        "name": "log_file_name",
                        "type": "string"
                      },
                      {
                        "name": "netskope_pop",
                        "type": "string"
                      },
                      {
                        "name": "network",
                        "type": "string"
                      },
                      {
                        "name": "numbytes",
                        "type": "int"
                      },
                      {
                        "name": "org",
                        "type": "string"
                      },
                      {
                        "name": "organization_unit",
                        "type": "string"
                      },
                      {
                        "name": "os",
                        "type": "string"
                      },
                      {
                        "name": "os_version",
                        "type": "string"
                      },
                      {
                        "name": "page",
                        "type": "string"
                      },
                      {
                        "name": "policy",
                        "type": "string"
                      },
                      {
                        "name": "protocol",
                        "type": "string"
                      },
                      {
                        "name": "req_cnt",
                        "type": "int"
                      },
                      {
                        "name": "request_id",
                        "type": "int"
                      },
                      {
                        "name": "resp_cnt",
                        "type": "int"
                      },
                      {
                        "name": "resp_content_len",
                        "type": "int"
                      },
                      {
                        "name": "resp_content_type",
                        "type": "string"
                      },
                      {
                        "name": "sAMAccountName",
                        "type": "string"
                      },
                      {
                        "name": "serial",
                        "type": "string"
                      },
                      {
                        "name": "server_bytes",
                        "type": "int"
                      },
                      {
                        "name": "sessionid",
                        "type": "string"
                      },
                      {
                        "name": "severity",
                        "type": "string"
                      },
                      {
                        "name": "sfwder",
                        "type": "string"
                      },
                      {
                        "name": "site",
                        "type": "string"
                      },
                      {
                        "name": "src_country",
                        "type": "string"
                      },
                      {
                        "name": "src_geoip_src",
                        "type": "int"
                      },
                      {
                        "name": "src_latitude",
                        "type": "int"
                      },
                      {
                        "name": "src_location",
                        "type": "string"
                      },
                      {
                        "name": "src_longitude",
                        "type": "int"
                      },
                      {
                        "name": "src_region",
                        "type": "string"
                      },
                      {
                        "name": "src_time",
                        "type": "string"
                      },
                      {
                        "name": "src_timezone",
                        "type": "string"
                      },
                      {
                        "name": "src_zipcode",
                        "type": "string"
                      },
                      {
                        "name": "srcip",
                        "type": "string"
                      },
                      {
                        "name": "ssl_decrypt_policy",
                        "type": "string"
                      },
                      {
                        "name": "suppression_end_time",
                        "type": "int"
                      },
                      {
                        "name": "suppression_start_time",
                        "type": "int"
                      },
                      {
                        "name": "timestamp",
                        "type": "int"
                      },
                      {
                        "name": "traffic_type",
                        "type": "string"
                      },
                      {
                        "name": "transaction_id",
                        "type": "int"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "ur_normalized",
                        "type": "string"
                      },
                      {
                        "name": "url",
                        "type": "string"
                      },
                      {
                        "name": "user",
                        "type": "string"
                      },
                      {
                        "name": "user_generated",
                        "type": "string"
                      },
                      {
                        "name": "useragent",
                        "type": "string"
                      },
                      {
                        "name": "userip",
                        "type": "string"
                      },
                      {
                        "name": "userkey",
                        "type": "string"
                      },
                      {
                        "name": "userPrincipalName",
                        "type": "string"
                      }
                    ]
                  },
                  "Custom-NetskopeEventsDLP": {
                    "columns": [
                      {
                        "name": "_id",
                        "type": "string"
                      },
                      {
                        "name": "title",
                        "type": "string"
                      },
                      {
                        "name": "object",
                        "type": "string"
                      },
                      {
                        "name": "app",
                        "type": "string"
                      },
                      {
                        "name": "site",
                        "type": "string"
                      },
                      {
                        "name": "status",
                        "type": "string"
                      },
                      {
                        "name": "assignee",
                        "type": "string"
                      },
                      {
                        "name": "severity",
                        "type": "string"
                      },
                      {
                        "name": "instance_id",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "int"
                      },
                      {
                        "name": "exposure",
                        "type": "string"
                      },
                      {
                        "name": "acting_user",
                        "type": "string"
                      },
                      {
                        "name": "user",
                        "type": "string"
                      },
                      {
                        "name": "file_path",
                        "type": "string"
                      },
                      {
                        "name": "file_size",
                        "type": "int"
                      },
                      {
                        "name": "file_type",
                        "type": "string"
                      },
                      {
                        "name": "dlp_match_info",
                        "type": "dynamic"
                      },
                      {
                        "name": "inline_dlp_match_info",
                        "type": "dynamic"
                      },
                      {
                        "name": "access_method",
                        "type": "string"
                      },
                      {
                        "name": "activity",
                        "type": "string"
                      },
                      {
                        "name": "instance",
                        "type": "string"
                      },
                      {
                        "name": "url",
                        "type": "string"
                      },
                      {
                        "name": "object_type",
                        "type": "string"
                      },
                      {
                        "name": "owner",
                        "type": "string"
                      },
                      {
                        "name": "owner_pdl",
                        "type": "string"
                      },
                      {
                        "name": "file_lang",
                        "type": "string"
                      },
                      {
                        "name": "true_obj_category",
                        "type": "string"
                      },
                      {
                        "name": "true_obj_type",
                        "type": "string"
                      },
                      {
                        "name": "dlp_incident_id",
                        "type": "int"
                      },
                      {
                        "name": "latest_incident_id",
                        "type": "int"
                      },
                      {
                        "name": "dlp_parent_id",
                        "type": "int"
                      },
                      {
                        "name": "from_user",
                        "type": "string"
                      },
                      {
                        "name": "md5",
                        "type": "string"
                      },
                      {
                        "name": "connection_id",
                        "type": "int"
                      },
                      {
                        "name": "app_session_id",
                        "type": "int"
                      },
                      {
                        "name": "referer",
                        "type": "string"
                      },
                      {
                        "name": "dst_location",
                        "type": "string"
                      },
                      {
                        "name": "src_location",
                        "type": "string"
                      },
                      {
                        "name": "channel",
                        "type": "string"
                      },
                      {
                        "name": "to_user",
                        "type": "string"
                      },
                      {
                        "name": "cc",
                        "type": "string"
                      },
                      {
                        "name": "bcc",
                        "type": "string"
                      },
                      {
                        "name": "classification",
                        "type": "string"
                      },
                      {
                        "name": "user_id",
                        "type": "string"
                      },
                      {
                        "name": "destination_app",
                        "type": "string"
                      },
                      {
                        "name": "destination_instance_id",
                        "type": "string"
                      },
                      {
                        "name": "zip_file_id",
                        "type": "string"
                      },
                      {
                        "name": "original_file_snapshot_id",
                        "type": "string"
                      },
                      {
                        "name": "dlp_file",
                        "type": "string"
                      }
                    ]
                  },
                  "Custom-NetskopeEventsEndpoint": {
                    "columns": [
                      {
                        "name": "_id",
                        "type": "string"
                      },
                      {
                        "name": "access_method",
                        "type": "string"
                      },
                      {
                        "name": "action",
                        "type": "string"
                      },
                      {
                        "name": "activity",
                        "type": "string"
                      },
                      {
                        "name": "activity_type",
                        "type": "string"
                      },
                      {
                        "name": "alert",
                        "type": "string"
                      },
                      {
                        "name": "alert_generated",
                        "type": "boolean"
                      },
                      {
                        "name": "alert_name",
                        "type": "string"
                      },
                      {
                        "name": "alert_type",
                        "type": "string"
                      },
                      {
                        "name": "app",
                        "type": "string"
                      },
                      {
                        "name": "computer_name",
                        "type": "string"
                      },
                      {
                        "name": "connection_type",
                        "type": "string"
                      },
                      {
                        "name": "destination_file_directory",
                        "type": "string"
                      },
                      {
                        "name": "destination_file_name",
                        "type": "string"
                      },
                      {
                        "name": "destination_file_path",
                        "type": "string"
                      },
                      {
                        "name": "device",
                        "type": "string"
                      },
                      {
                        "name": "device_id",
                        "type": "string"
                      },
                      {
                        "name": "device_name",
                        "type": "string"
                      },
                      {
                        "name": "device_sn",
                        "type": "string"
                      },
                      {
                        "name": "device_type",
                        "type": "string"
                      },
                      {
                        "name": "dlp_incident_id",
                        "type": "int"
                      },
                      {
                        "name": "dlp_profile",
                        "type": "string"
                      },
                      {
                        "name": "dlp_profile_name",
                        "type": "string"
                      },
                      {
                        "name": "dlp_rule",
                        "type": "string"
                      },
                      {
                        "name": "driver",
                        "type": "string"
                      },
                      {
                        "name": "event_recovered",
                        "type": "boolean"
                      },
                      {
                        "name": "executable_hash",
                        "type": "string"
                      },
                      {
                        "name": "executable_signed",
                        "type": "boolean"
                      },
                      {
                        "name": "file_origin",
                        "type": "string"
                      },
                      {
                        "name": "file_size",
                        "type": "int"
                      },
                      {
                        "name": "file_type",
                        "type": "string"
                      },
                      {
                        "name": "incident_id",
                        "type": "int"
                      },
                      {
                        "name": "justification",
                        "type": "string"
                      },
                      {
                        "name": "location",
                        "type": "string"
                      },
                      {
                        "name": "md5",
                        "type": "string"
                      },
                      {
                        "name": "os",
                        "type": "string"
                      },
                      {
                        "name": "os_details",
                        "type": "string"
                      },
                      {
                        "name": "os_user_name",
                        "type": "string"
                      },
                      {
                        "name": "pid",
                        "type": "string"
                      },
                      {
                        "name": "policy_action",
                        "type": "string"
                      },
                      {
                        "name": "policy_action_enforced",
                        "type": "string"
                      },
                      {
                        "name": "policy_name",
                        "type": "string"
                      },
                      {
                        "name": "policy_name_enforced",
                        "type": "string"
                      },
                      {
                        "name": "policy_version",
                        "type": "string"
                      },
                      {
                        "name": "port",
                        "type": "string"
                      },
                      {
                        "name": "printer_identifier",
                        "type": "string"
                      },
                      {
                        "name": "process_cert_subject",
                        "type": "string"
                      },
                      {
                        "name": "process_name",
                        "type": "string"
                      },
                      {
                        "name": "process_path",
                        "type": "string"
                      },
                      {
                        "name": "product_id",
                        "type": "string"
                      },
                      {
                        "name": "sha256",
                        "type": "string"
                      },
                      {
                        "name": "source_file_directory",
                        "type": "string"
                      },
                      {
                        "name": "source_file_name",
                        "type": "string"
                      },
                      {
                        "name": "sub_type",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "int"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "unc_path",
                        "type": "string"
                      },
                      {
                        "name": "user",
                        "type": "string"
                      },
                      {
                        "name": "vendor_id",
                        "type": "string"
                      }
                    ]
                  },
                  "Custom-NetskopeEventsInfrastructure": {
                    "columns": [
                      {
                        "name": "_id",
                        "type": "string"
                      },
                      {
                        "name": "boolean_metric_value",
                        "type": "string"
                      },
                      {
                        "name": "hostname",
                        "type": "string"
                      },
                      {
                        "name": "metric_name",
                        "type": "string"
                      },
                      {
                        "name": "metric_true_count",
                        "type": "string"
                      },
                      {
                        "name": "metric_type",
                        "type": "string"
                      },
                      {
                        "name": "metric_value",
                        "type": "string"
                      },
                      {
                        "name": "package_version",
                        "type": "string"
                      },
                      {
                        "name": "serial",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "int"
                      }
                    ]
                  },
                  "Custom-NetskopeEventsNetwork": {
                    "columns": [
                      {
                        "name": "_id",
                        "type": "string"
                      },
                      {
                        "name": "access_method",
                        "type": "string"
                      },
                      {
                        "name": "action",
                        "type": "string"
                      },
                      {
                        "name": "app",
                        "type": "string"
                      },
                      {
                        "name": "appcategory",
                        "type": "string"
                      },
                      {
                        "name": "category",
                        "type": "string"
                      },
                      {
                        "name": "cci",
                        "type": "int"
                      },
                      {
                        "name": "ccl",
                        "type": "string"
                      },
                      {
                        "name": "client_bytes",
                        "type": "int"
                      },
                      {
                        "name": "client_packets",
                        "type": "int"
                      },
                      {
                        "name": "count",
                        "type": "int"
                      },
                      {
                        "name": "device",
                        "type": "string"
                      },
                      {
                        "name": "domain",
                        "type": "string"
                      },
                      {
                        "name": "dst_country",
                        "type": "string"
                      },
                      {
                        "name": "dst_geoip_src",
                        "type": "int"
                      },
                      {
                        "name": "dst_latitude",
                        "type": "int"
                      },
                      {
                        "name": "dst_location",
                        "type": "string"
                      },
                      {
                        "name": "dst_longitude",
                        "type": "int"
                      },
                      {
                        "name": "dst_region",
                        "type": "string"
                      },
                      {
                        "name": "dst_zipcode",
                        "type": "string"
                      },
                      {
                        "name": "dsthost",
                        "type": "string"
                      },
                      {
                        "name": "dstip",
                        "type": "string"
                      },
                      {
                        "name": "dstport",
                        "type": "int"
                      },
                      {
                        "name": "end_time",
                        "type": "string"
                      },
                      {
                        "name": "flow_status",
                        "type": "string"
                      },
                      {
                        "name": "hostname",
                        "type": "string"
                      },
                      {
                        "name": "ip_protocol",
                        "type": "string"
                      },
                      {
                        "name": "netskope_pop",
                        "type": "string"
                      },
                      {
                        "name": "network_session_id",
                        "type": "string"
                      },
                      {
                        "name": "num_sessions",
                        "type": "int"
                      },
                      {
                        "name": "numbytes",
                        "type": "int"
                      },
                      {
                        "name": "organization_unit",
                        "type": "string"
                      },
                      {
                        "name": "os",
                        "type": "string"
                      },
                      {
                        "name": "os_version",
                        "type": "string"
                      },
                      {
                        "name": "policy",
                        "type": "string"
                      },
                      {
                        "name": "pop_id",
                        "type": "string"
                      },
                      {
                        "name": "protocol",
                        "type": "string"
                      },
                      {
                        "name": "protocol_port",
                        "type": "string"
                      },
                      {
                        "name": "publisher_cn",
                        "type": "string"
                      },
                      {
                        "name": "publisher_name",
                        "type": "string"
                      },
                      {
                        "name": "sAMAccountName",
                        "type": "string"
                      },
                      {
                        "name": "server_bytes",
                        "type": "int"
                      },
                      {
                        "name": "server_packets",
                        "type": "int"
                      },
                      {
                        "name": "session_duration",
                        "type": "int"
                      },
                      {
                        "name": "site",
                        "type": "string"
                      },
                      {
                        "name": "src_country",
                        "type": "string"
                      },
                      {
                        "name": "src_geoip_src",
                        "type": "int"
                      },
                      {
                        "name": "src_latitude",
                        "type": "int"
                      },
                      {
                        "name": "src_location",
                        "type": "string"
                      },
                      {
                        "name": "src_longitude",
                        "type": "int"
                      },
                      {
                        "name": "src_region",
                        "type": "string"
                      },
                      {
                        "name": "src_zipcode",
                        "type": "string"
                      },
                      {
                        "name": "srcip",
                        "type": "string"
                      },
                      {
                        "name": "srcport",
                        "type": "int"
                      },
                      {
                        "name": "start_time",
                        "type": "string"
                      },
                      {
                        "name": "timestamp",
                        "type": "int"
                      },
                      {
                        "name": "total_packets",
                        "type": "int"
                      },
                      {
                        "name": "traffic_type",
                        "type": "string"
                      },
                      {
                        "name": "tunnel_id",
                        "type": "string"
                      },
                      {
                        "name": "tunnel_type",
                        "type": "string"
                      },
                      {
                        "name": "tunnel_up_time",
                        "type": "int"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "ur_normalized",
                        "type": "string"
                      },
                      {
                        "name": "user",
                        "type": "string"
                      },
                      {
                        "name": "userip",
                        "type": "string"
                      },
                      {
                        "name": "userkey",
                        "type": "string"
                      },
                      {
                        "name": "userPrincipalName",
                        "type": "string"
                      }
                    ]
                  },
                  "Custom-NetskopeEventsPage": {
                    "columns": [
                      {
                        "name": "_id",
                        "type": "string"
                      },
                      {
                        "name": "access_method",
                        "type": "string"
                      },
                      {
                        "name": "app",
                        "type": "string"
                      },
                      {
                        "name": "app_session_id",
                        "type": "int"
                      },
                      {
                        "name": "appcategory",
                        "type": "string"
                      },
                      {
                        "name": "browser",
                        "type": "string"
                      },
                      {
                        "name": "browser_session_id",
                        "type": "int"
                      },
                      {
                        "name": "browser_version",
                        "type": "string"
                      },
                      {
                        "name": "bypass_reason",
                        "type": "string"
                      },
                      {
                        "name": "bypass_traffic",
                        "type": "string"
                      },
                      {
                        "name": "category",
                        "type": "string"
                      },
                      {
                        "name": "cci",
                        "type": "int"
                      },
                      {
                        "name": "ccl",
                        "type": "string"
                      },
                      {
                        "name": "client_bytes",
                        "type": "int"
                      },
                      {
                        "name": "conn_duration",
                        "type": "int"
                      },
                      {
                        "name": "conn_endtime",
                        "type": "int"
                      },
                      {
                        "name": "conn_starttime",
                        "type": "int"
                      },
                      {
                        "name": "connection_id",
                        "type": "int"
                      },
                      {
                        "name": "CononicalName",
                        "type": "string"
                      },
                      {
                        "name": "count",
                        "type": "int"
                      },
                      {
                        "name": "device",
                        "type": "string"
                      },
                      {
                        "name": "domain",
                        "type": "string"
                      },
                      {
                        "name": "dst_country",
                        "type": "string"
                      },
                      {
                        "name": "dst_geoip_src",
                        "type": "int"
                      },
                      {
                        "name": "dst_latitude",
                        "type": "int"
                      },
                      {
                        "name": "dst_location",
                        "type": "string"
                      },
                      {
                        "name": "dst_longitude",
                        "type": "int"
                      },
                      {
                        "name": "dst_region",
                        "type": "string"
                      },
                      {
                        "name": "dst_timezone",
                        "type": "string"
                      },
                      {
                        "name": "dst_zipcode",
                        "type": "string"
                      },
                      {
                        "name": "dsthost",
                        "type": "string"
                      },
                      {
                        "name": "dstip",
                        "type": "string"
                      },
                      {
                        "name": "dstport",
                        "type": "int"
                      },
                      {
                        "name": "dynamic_classification",
                        "type": "string"
                      },
                      {
                        "name": "forward_to_proxy_profile",
                        "type": "string"
                      },
                      {
                        "name": "fromlogs",
                        "type": "string"
                      },
                      {
                        "name": "hostname",
                        "type": "string"
                      },
                      {
                        "name": "http_transaction_count",
                        "type": "int"
                      },
                      {
                        "name": "log_file_name",
                        "type": "string"
                      },
                      {
                        "name": "netskope_pop",
                        "type": "string"
                      },
                      {
                        "name": "network",
                        "type": "string"
                      },
                      {
                        "name": "numbytes",
                        "type": "int"
                      },
                      {
                        "name": "org",
                        "type": "string"
                      },
                      {
                        "name": "organization_unit",
                        "type": "string"
                      },
                      {
                        "name": "os",
                        "type": "string"
                      },
                      {
                        "name": "os_version",
                        "type": "string"
                      },
                      {
                        "name": "page",
                        "type": "string"
                      },
                      {
                        "name": "policy",
                        "type": "string"
                      },
                      {
                        "name": "protocol",
                        "type": "string"
                      },
                      {
                        "name": "req_cnt",
                        "type": "int"
                      },
                      {
                        "name": "request_id",
                        "type": "int"
                      },
                      {
                        "name": "resp_cnt",
                        "type": "int"
                      },
                      {
                        "name": "resp_content_len",
                        "type": "int"
                      },
                      {
                        "name": "resp_content_type",
                        "type": "string"
                      },
                      {
                        "name": "sAMAccountName",
                        "type": "string"
                      },
                      {
                        "name": "serial",
                        "type": "string"
                      },
                      {
                        "name": "server_bytes",
                        "type": "int"
                      },
                      {
                        "name": "sessionid",
                        "type": "string"
                      },
                      {
                        "name": "severity",
                        "type": "string"
                      },
                      {
                        "name": "sfwder",
                        "type": "string"
                      },
                      {
                        "name": "site",
                        "type": "string"
                      },
                      {
                        "name": "src_country",
                        "type": "string"
                      },
                      {
                        "name": "src_geoip_src",
                        "type": "int"
                      },
                      {
                        "name": "src_latitude",
                        "type": "int"
                      },
                      {
                        "name": "src_location",
                        "type": "string"
                      },
                      {
                        "name": "src_longitude",
                        "type": "int"
                      },
                      {
                        "name": "src_region",
                        "type": "string"
                      },
                      {
                        "name": "src_time",
                        "type": "string"
                      },
                      {
                        "name": "src_timezone",
                        "type": "string"
                      },
                      {
                        "name": "src_zipcode",
                        "type": "string"
                      },
                      {
                        "name": "srcip",
                        "type": "string"
                      },
                      {
                        "name": "ssl_decrypt_policy",
                        "type": "string"
                      },
                      {
                        "name": "suppression_end_time",
                        "type": "int"
                      },
                      {
                        "name": "suppression_start_time",
                        "type": "int"
                      },
                      {
                        "name": "timestamp",
                        "type": "int"
                      },
                      {
                        "name": "traffic_type",
                        "type": "string"
                      },
                      {
                        "name": "transaction_id",
                        "type": "int"
                      },
                      {
                        "name": "type",
                        "type": "string"
                      },
                      {
                        "name": "ur_normalized",
                        "type": "string"
                      },
                      {
                        "name": "url",
                        "type": "string"
                      },
                      {
                        "name": "user",
                        "type": "string"
                      },
                      {
                        "name": "user_generated",
                        "type": "string"
                      },
                      {
                        "name": "useragent",
                        "type": "string"
                      },
                      {
                        "name": "userip",
                        "type": "string"
                      },
                      {
                        "name": "userkey",
                        "type": "string"
                      },
                      {
                        "name": "userPrincipalName",
                        "type": "string"
                      }
                    ]
                  }
                },
                "destinations": {
                  "logAnalytics": [
                    {
                      "workspaceResourceId": "[variables('workspaceResourceId')]",
                      "name": "clv2ws1"
                    }
                  ]
                },
                "dataFlows": [
                  {
                    "streams": [
                      "Custom-NetskopeAlerts"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend TimeGenerated = datetime(1970-01-01) + timestamp * 1sec | project-rename count_i = ['count'], title_s = ['title'], type_s = ['type'] | project-away _id ",
                    "outputStream": "Custom-NetskopeAlerts_CL"
                  },
                  {
                    "streams": [
                      "Custom-NetskopeEventsApplication"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend TimeGenerated = datetime(1970-01-01) + timestamp * 1sec | project-rename count_i = ['count'], title_s = ['title'], type_s = ['type'] | project-away _id ",
                    "outputStream": "Custom-NetskopeEventsApplication_CL"
                  },
                  {
                    "streams": [
                      "Custom-NetskopeEventsAudit"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend TimeGenerated = datetime(1970-01-01) + timestamp * 1sec | project-rename count_i = ['count'], type_s = ['type'] | project-away _id ",
                    "outputStream": "Custom-NetskopeEventsAudit_CL"
                  },
                  {
                    "streams": [
                      "Custom-NetskopeEventsConnection"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend TimeGenerated = datetime(1970-01-01) + timestamp * 1sec | project-rename count_i = ['count'], type_s = ['type'] | project-away _id ",
                    "outputStream": "Custom-NetskopeEventsConnection_CL"
                  },
                  {
                    "streams": [
                      "Custom-NetskopeEventsDLP"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend TimeGenerated = datetime(1970-01-01) + timestamp * 1sec | project-rename title_s = ['title'] | project-away _id ",
                    "outputStream": "Custom-NetskopeEventsDLP_CL"
                  },
                  {
                    "streams": [
                      "Custom-NetskopeEventsEndpoint"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend TimeGenerated = datetime(1970-01-01) + timestamp * 1sec | project-rename type_s = ['type'] | project-away _id ",
                    "outputStream": "Custom-NetskopeEventsEndpoint_CL"
                  },
                  {
                    "streams": [
                      "Custom-NetskopeEventsInfrastructure"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend TimeGenerated = datetime(1970-01-01) + timestamp * 1sec | project-away _id ",
                    "outputStream": "Custom-NetskopeEventsInfrastructure_CL"
                  },
                  {
                    "streams": [
                      "Custom-NetskopeEventsNetwork"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend TimeGenerated = datetime(1970-01-01) + timestamp * 1sec | project-rename count_i = ['count'], type_s = ['type'] | project-away _id ",
                    "outputStream": "Custom-NetskopeEventsNetwork_CL"
                  },
                  {
                    "streams": [
                      "Custom-NetskopeEventsPage"
                    ],
                    "destinations": [
                      "clv2ws1"
                    ],
                    "transformKql": "source | extend TimeGenerated = datetime(1970-01-01) + timestamp * 1sec | project-rename count_i = ['count'], type_s = ['type'] | project-away _id ",
                    "outputStream": "Custom-NetskopeEventsPage_CL"
                  }
                ]
              }
            },
            {
              "name": "NetskopeAlerts_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "properties": {
                "schema": {
                  "name": "NetskopeAlerts_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "access_method",
                      "type": "string"
                    },
                    {
                      "name": "account_id",
                      "type": "string"
                    },
                    {
                      "name": "account_name",
                      "type": "string"
                    },
                    {
                      "name": "acked",
                      "type": "string"
                    },
                    {
                      "name": "action",
                      "type": "string"
                    },
                    {
                      "name": "activity",
                      "type": "string"
                    },
                    {
                      "name": "alert",
                      "type": "string"
                    },
                    {
                      "name": "alert_id",
                      "type": "string"
                    },
                    {
                      "name": "alert_name",
                      "type": "string"
                    },
                    {
                      "name": "alert_type",
                      "type": "string"
                    },
                    {
                      "name": "app",
                      "type": "string"
                    },
                    {
                      "name": "app_activity",
                      "type": "string"
                    },
                    {
                      "name": "app_session_id",
                      "type": "int"
                    },
                    {
                      "name": "appcategory",
                      "type": "string"
                    },
                    {
                      "name": "appsuite",
                      "type": "string"
                    },
                    {
                      "name": "asset_id",
                      "type": "string"
                    },
                    {
                      "name": "asset_object_id",
                      "type": "string"
                    },
                    {
                      "name": "breach_date",
                      "type": "int"
                    },
                    {
                      "name": "breach_description",
                      "type": "string"
                    },
                    {
                      "name": "breach_id",
                      "type": "string"
                    },
                    {
                      "name": "breach_media_references",
                      "type": "string"
                    },
                    {
                      "name": "breach_score",
                      "type": "string"
                    },
                    {
                      "name": "breach_target_references",
                      "type": "string"
                    },
                    {
                      "name": "browser",
                      "type": "string"
                    },
                    {
                      "name": "browser_session_id",
                      "type": "int"
                    },
                    {
                      "name": "browser_version",
                      "type": "string"
                    },
                    {
                      "name": "bypass_traffic",
                      "type": "string"
                    },
                    {
                      "name": "category",
                      "type": "string"
                    },
                    {
                      "name": "cci",
                      "type": "int"
                    },
                    {
                      "name": "ccl",
                      "type": "string"
                    },
                    {
                      "name": "client_bytes",
                      "type": "int"
                    },
                    {
                      "name": "compliance_standards",
                      "type": "dynamic"
                    },
                    {
                      "name": "conn_duration",
                      "type": "int"
                    },
                    {
                      "name": "conn_endtime",
                      "type": "int"
                    },
                    {
                      "name": "conn_starttime",
                      "type": "int"
                    },
                    {
                      "name": "connection_id",
                      "type": "int"
                    },
                    {
                      "name": "CononicalName",
                      "type": "string"
                    },
                    {
                      "name": "count_i",
                      "type": "int"
                    },
                    {
                      "name": "data_type",
                      "type": "string"
                    },
                    {
                      "name": "device",
                      "type": "string"
                    },
                    {
                      "name": "device_classification",
                      "type": "string"
                    },
                    {
                      "name": "dlp_file",
                      "type": "string"
                    },
                    {
                      "name": "dlp_incident_id",
                      "type": "int"
                    },
                    {
                      "name": "dlp_is_unique_count",
                      "type": "string"
                    },
                    {
                      "name": "dlp_mail_parent_id",
                      "type": "string"
                    },
                    {
                      "name": "dlp_parent_id",
                      "type": "int"
                    },
                    {
                      "name": "dlp_profile",
                      "type": "string"
                    },
                    {
                      "name": "dlp_rule",
                      "type": "string"
                    },
                    {
                      "name": "dlp_rule_count",
                      "type": "int"
                    },
                    {
                      "name": "dlp_rule_severity",
                      "type": "string"
                    },
                    {
                      "name": "dlp_unique_count",
                      "type": "int"
                    },
                    {
                      "name": "domain",
                      "type": "string"
                    },
                    {
                      "name": "dst_country",
                      "type": "string"
                    },
                    {
                      "name": "dst_geoip_src",
                      "type": "int"
                    },
                    {
                      "name": "dst_latitude",
                      "type": "int"
                    },
                    {
                      "name": "dst_location",
                      "type": "string"
                    },
                    {
                      "name": "dst_longitude",
                      "type": "int"
                    },
                    {
                      "name": "dst_region",
                      "type": "string"
                    },
                    {
                      "name": "dst_timezone",
                      "type": "string"
                    },
                    {
                      "name": "dst_zipcode",
                      "type": "string"
                    },
                    {
                      "name": "dstip",
                      "type": "string"
                    },
                    {
                      "name": "dsthost",
                      "type": "string"
                    },
                    {
                      "name": "dstport",
                      "type": "int"
                    },
                    {
                      "name": "email_source",
                      "type": "string"
                    },
                    {
                      "name": "event_type",
                      "type": "string"
                    },
                    {
                      "name": "evt_src_chnl",
                      "type": "string"
                    },
                    {
                      "name": "exposure",
                      "type": "string"
                    },
                    {
                      "name": "external_collaborator_count",
                      "type": "int"
                    },
                    {
                      "name": "external_email",
                      "type": "int"
                    },
                    {
                      "name": "file_cls_encrypted",
                      "type": "boolean"
                    },
                    {
                      "name": "file_lang",
                      "type": "string"
                    },
                    {
                      "name": "file_path",
                      "type": "string"
                    },
                    {
                      "name": "file_size",
                      "type": "int"
                    },
                    {
                      "name": "file_type",
                      "type": "string"
                    },
                    {
                      "name": "from_user",
                      "type": "string"
                    },
                    {
                      "name": "fromlogs",
                      "type": "string"
                    },
                    {
                      "name": "hostname",
                      "type": "string"
                    },
                    {
                      "name": "http_transaction_count",
                      "type": "int"
                    },
                    {
                      "name": "iaas_asset_tags",
                      "type": "dynamic"
                    },
                    {
                      "name": "iaas_remediated",
                      "type": "string"
                    },
                    {
                      "name": "instance",
                      "type": "string"
                    },
                    {
                      "name": "instance_id",
                      "type": "string"
                    },
                    {
                      "name": "internal_collaborator_count",
                      "type": "int"
                    },
                    {
                      "name": "justification_reason",
                      "type": "string"
                    },
                    {
                      "name": "justification_type",
                      "type": "string"
                    },
                    {
                      "name": "last_app",
                      "type": "string"
                    },
                    {
                      "name": "last_country",
                      "type": "string"
                    },
                    {
                      "name": "last_device",
                      "type": "string"
                    },
                    {
                      "name": "last_location",
                      "type": "string"
                    },
                    {
                      "name": "last_region",
                      "type": "string"
                    },
                    {
                      "name": "last_timestamp",
                      "type": "int"
                    },
                    {
                      "name": "log_file_name",
                      "type": "string"
                    },
                    {
                      "name": "malicious",
                      "type": "string"
                    },
                    {
                      "name": "malsite_category",
                      "type": "dynamic"
                    },
                    {
                      "name": "malsite_country",
                      "type": "string"
                    },
                    {
                      "name": "malsite_id",
                      "type": "string"
                    },
                    {
                      "name": "malsite_ip_host",
                      "type": "string"
                    },
                    {
                      "name": "malsite_latitude",
                      "type": "int"
                    },
                    {
                      "name": "malsite_longitude",
                      "type": "int"
                    },
                    {
                      "name": "malsite_region",
                      "type": "string"
                    },
                    {
                      "name": "managed_app",
                      "type": "string"
                    },
                    {
                      "name": "managementID",
                      "type": "string"
                    },
                    {
                      "name": "matched_username",
                      "type": "string"
                    },
                    {
                      "name": "md5",
                      "type": "string"
                    },
                    {
                      "name": "mime_type",
                      "type": "string"
                    },
                    {
                      "name": "modified",
                      "type": "int"
                    },
                    {
                      "name": "netskope_activity",
                      "type": "string"
                    },
                    {
                      "name": "netskope_pop",
                      "type": "string"
                    },
                    {
                      "name": "notify_template",
                      "type": "string"
                    },
                    {
                      "name": "nsdeviceuid",
                      "type": "string"
                    },
                    {
                      "name": "numbytes",
                      "type": "int"
                    },
                    {
                      "name": "object",
                      "type": "string"
                    },
                    {
                      "name": "object_id",
                      "type": "string"
                    },
                    {
                      "name": "object_type",
                      "type": "string"
                    },
                    {
                      "name": "org",
                      "type": "string"
                    },
                    {
                      "name": "organization_unit",
                      "type": "string"
                    },
                    {
                      "name": "orig_ty",
                      "type": "string"
                    },
                    {
                      "name": "orignal_file_path",
                      "type": "string"
                    },
                    {
                      "name": "os",
                      "type": "string"
                    },
                    {
                      "name": "os_version",
                      "type": "string"
                    },
                    {
                      "name": "other_categories",
                      "type": "dynamic"
                    },
                    {
                      "name": "outer_doc_type",
                      "type": "int"
                    },
                    {
                      "name": "owner",
                      "type": "string"
                    },
                    {
                      "name": "page",
                      "type": "string"
                    },
                    {
                      "name": "page_site",
                      "type": "string"
                    },
                    {
                      "name": "parent_id",
                      "type": "string"
                    },
                    {
                      "name": "password_type",
                      "type": "string"
                    },
                    {
                      "name": "policy",
                      "type": "string"
                    },
                    {
                      "name": "policy_actions",
                      "type": "dynamic"
                    },
                    {
                      "name": "policy_id",
                      "type": "string"
                    },
                    {
                      "name": "profile_id",
                      "type": "string"
                    },
                    {
                      "name": "protocol",
                      "type": "string"
                    },
                    {
                      "name": "referer",
                      "type": "string"
                    },
                    {
                      "name": "region_id",
                      "type": "string"
                    },
                    {
                      "name": "region_name",
                      "type": "string"
                    },
                    {
                      "name": "req_cnt",
                      "type": "int"
                    },
                    {
                      "name": "request_id",
                      "type": "int"
                    },
                    {
                      "name": "resource_category",
                      "type": "string"
                    },
                    {
                      "name": "resource_group",
                      "type": "string"
                    },
                    {
                      "name": "resp_cnt",
                      "type": "int"
                    },
                    {
                      "name": "sa_profile_id",
                      "type": "int"
                    },
                    {
                      "name": "sa_profile_name",
                      "type": "string"
                    },
                    {
                      "name": "sa_rule_id",
                      "type": "string"
                    },
                    {
                      "name": "sa_rule_name",
                      "type": "string"
                    },
                    {
                      "name": "sa_rule_severity",
                      "type": "string"
                    },
                    {
                      "name": "sAMAccountName",
                      "type": "string"
                    },
                    {
                      "name": "sanctioned_instance",
                      "type": "string"
                    },
                    {
                      "name": "scan_type",
                      "type": "string"
                    },
                    {
                      "name": "serial",
                      "type": "string"
                    },
                    {
                      "name": "server_bytes",
                      "type": "int"
                    },
                    {
                      "name": "sessionid",
                      "type": "string"
                    },
                    {
                      "name": "severity",
                      "type": "string"
                    },
                    {
                      "name": "severity_level",
                      "type": "string"
                    },
                    {
                      "name": "severity_level_id",
                      "type": "int"
                    },
                    {
                      "name": "sfwder",
                      "type": "string"
                    },
                    {
                      "name": "sha256",
                      "type": "string"
                    },
                    {
                      "name": "shared_domains",
                      "type": "string"
                    },
                    {
                      "name": "shared_with",
                      "type": "string"
                    },
                    {
                      "name": "site",
                      "type": "string"
                    },
                    {
                      "name": "src_country",
                      "type": "string"
                    },
                    {
                      "name": "src_geoip_src",
                      "type": "int"
                    },
                    {
                      "name": "src_latitude",
                      "type": "int"
                    },
                    {
                      "name": "src_location",
                      "type": "string"
                    },
                    {
                      "name": "src_longitude",
                      "type": "int"
                    },
                    {
                      "name": "src_region",
                      "type": "string"
                    },
                    {
                      "name": "src_time",
                      "type": "string"
                    },
                    {
                      "name": "src_timezone",
                      "type": "string"
                    },
                    {
                      "name": "src_zipcode",
                      "type": "string"
                    },
                    {
                      "name": "srcip",
                      "type": "string"
                    },
                    {
                      "name": "suppression_end_time",
                      "type": "int"
                    },
                    {
                      "name": "suppression_key",
                      "type": "string"
                    },
                    {
                      "name": "suppression_start_time",
                      "type": "int"
                    },
                    {
                      "name": "telemetry_app",
                      "type": "string"
                    },
                    {
                      "name": "threat_match_field",
                      "type": "string"
                    },
                    {
                      "name": "threat_match_value",
                      "type": "string"
                    },
                    {
                      "name": "threat_source_id",
                      "type": "int"
                    },
                    {
                      "name": "threshold",
                      "type": "int"
                    },
                    {
                      "name": "threshold_time",
                      "type": "int"
                    },
                    {
                      "name": "timestamp",
                      "type": "int"
                    },
                    {
                      "name": "title_s",
                      "type": "string"
                    },
                    {
                      "name": "to_object",
                      "type": "string"
                    },
                    {
                      "name": "total_collaborator_count",
                      "type": "int"
                    },
                    {
                      "name": "traffic_type",
                      "type": "string"
                    },
                    {
                      "name": "transaction_id",
                      "type": "int"
                    },
                    {
                      "name": "true_obj_category",
                      "type": "string"
                    },
                    {
                      "name": "true_obj_type",
                      "type": "string"
                    },
                    {
                      "name": "tss_mode",
                      "type": "string"
                    },
                    {
                      "name": "two_factor_auth",
                      "type": "string"
                    },
                    {
                      "name": "type_s",
                      "type": "string"
                    },
                    {
                      "name": "universal_connector",
                      "type": "string"
                    },
                    {
                      "name": "ur_normalized",
                      "type": "string"
                    },
                    {
                      "name": "url",
                      "type": "string"
                    },
                    {
                      "name": "user",
                      "type": "string"
                    },
                    {
                      "name": "user_generated",
                      "type": "string"
                    },
                    {
                      "name": "user_id",
                      "type": "string"
                    },
                    {
                      "name": "useragent",
                      "type": "string"
                    },
                    {
                      "name": "userip",
                      "type": "string"
                    },
                    {
                      "name": "userkey",
                      "type": "string"
                    },
                    {
                      "name": "userPrincipalName",
                      "type": "string"
                    },
                    {
                      "name": "web_universal_connector",
                      "type": "string"
                    }
                  ]
                }
              }
            },
            {
              "name": "NetskopeEventsApplication_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "properties": {
                "schema": {
                  "name": "NetskopeEventsApplication_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "access_method",
                      "type": "string"
                    },
                    {
                      "name": "action",
                      "type": "string"
                    },
                    {
                      "name": "activity",
                      "type": "string"
                    },
                    {
                      "name": "alert",
                      "type": "string"
                    },
                    {
                      "name": "alert_type",
                      "type": "string"
                    },
                    {
                      "name": "app",
                      "type": "string"
                    },
                    {
                      "name": "app_activity",
                      "type": "string"
                    },
                    {
                      "name": "app_session_id",
                      "type": "int"
                    },
                    {
                      "name": "appcategory",
                      "type": "string"
                    },
                    {
                      "name": "appsuite",
                      "type": "string"
                    },
                    {
                      "name": "audit_category",
                      "type": "string"
                    },
                    {
                      "name": "audit_type",
                      "type": "string"
                    },
                    {
                      "name": "browser",
                      "type": "string"
                    },
                    {
                      "name": "browser_session_id",
                      "type": "int"
                    },
                    {
                      "name": "browser_version",
                      "type": "string"
                    },
                    {
                      "name": "category",
                      "type": "string"
                    },
                    {
                      "name": "cci",
                      "type": "int"
                    },
                    {
                      "name": "ccl",
                      "type": "string"
                    },
                    {
                      "name": "channel_id",
                      "type": "string"
                    },
                    {
                      "name": "client_bytes",
                      "type": "int"
                    },
                    {
                      "name": "conn_duration",
                      "type": "int"
                    },
                    {
                      "name": "connection_id",
                      "type": "int"
                    },
                    {
                      "name": "CononicalName",
                      "type": "string"
                    },
                    {
                      "name": "count_i",
                      "type": "int"
                    },
                    {
                      "name": "custom_connector",
                      "type": "string"
                    },
                    {
                      "name": "data_center",
                      "type": "string"
                    },
                    {
                      "name": "data_type",
                      "type": "string"
                    },
                    {
                      "name": "device",
                      "type": "string"
                    },
                    {
                      "name": "device_classification",
                      "type": "string"
                    },
                    {
                      "name": "dlp_file",
                      "type": "string"
                    },
                    {
                      "name": "dlp_incident_id",
                      "type": "int"
                    },
                    {
                      "name": "dlp_is_unique_count",
                      "type": "string"
                    },
                    {
                      "name": "dlp_mail_parent_id",
                      "type": "string"
                    },
                    {
                      "name": "dlp_parent_id",
                      "type": "int"
                    },
                    {
                      "name": "dlp_profile",
                      "type": "string"
                    },
                    {
                      "name": "dlp_rule",
                      "type": "string"
                    },
                    {
                      "name": "dlp_rule_count",
                      "type": "int"
                    },
                    {
                      "name": "dlp_rule_severity",
                      "type": "string"
                    },
                    {
                      "name": "dlp_unique_count",
                      "type": "int"
                    },
                    {
                      "name": "dst_country",
                      "type": "string"
                    },
                    {
                      "name": "dst_geoip_src",
                      "type": "int"
                    },
                    {
                      "name": "dst_latitude",
                      "type": "int"
                    },
                    {
                      "name": "dst_location",
                      "type": "string"
                    },
                    {
                      "name": "dst_longitude",
                      "type": "int"
                    },
                    {
                      "name": "dst_region",
                      "type": "string"
                    },
                    {
                      "name": "dst_timezone",
                      "type": "string"
                    },
                    {
                      "name": "dst_zipcode",
                      "type": "string"
                    },
                    {
                      "name": "dsthost",
                      "type": "string"
                    },
                    {
                      "name": "dstip",
                      "type": "string"
                    },
                    {
                      "name": "dstport",
                      "type": "int"
                    },
                    {
                      "name": "exposure",
                      "type": "string"
                    },
                    {
                      "name": "file_lang",
                      "type": "string"
                    },
                    {
                      "name": "file_path",
                      "type": "string"
                    },
                    {
                      "name": "file_size",
                      "type": "int"
                    },
                    {
                      "name": "file_type",
                      "type": "string"
                    },
                    {
                      "name": "from_user",
                      "type": "string"
                    },
                    {
                      "name": "from_user_category",
                      "type": "string"
                    },
                    {
                      "name": "fromlogs",
                      "type": "string"
                    },
                    {
                      "name": "hostname",
                      "type": "string"
                    },
                    {
                      "name": "instance",
                      "type": "string"
                    },
                    {
                      "name": "instance_id",
                      "type": "string"
                    },
                    {
                      "name": "internal_collaborator_count",
                      "type": "int"
                    },
                    {
                      "name": "log_file_name",
                      "type": "string"
                    },
                    {
                      "name": "logintype",
                      "type": "string"
                    },
                    {
                      "name": "loginurl",
                      "type": "string"
                    },
                    {
                      "name": "managed_app",
                      "type": "string"
                    },
                    {
                      "name": "managementID",
                      "type": "string"
                    },
                    {
                      "name": "md5",
                      "type": "string"
                    },
                    {
                      "name": "mime_type",
                      "type": "string"
                    },
                    {
                      "name": "modified",
                      "type": "int"
                    },
                    {
                      "name": "netskope_activity",
                      "type": "string"
                    },
                    {
                      "name": "netskope_pop",
                      "type": "string"
                    },
                    {
                      "name": "notify_template",
                      "type": "string"
                    },
                    {
                      "name": "nsdeviceuid",
                      "type": "string"
                    },
                    {
                      "name": "numbytes",
                      "type": "int"
                    },
                    {
                      "name": "object",
                      "type": "string"
                    },
                    {
                      "name": "object_id",
                      "type": "string"
                    },
                    {
                      "name": "object_type",
                      "type": "string"
                    },
                    {
                      "name": "org",
                      "type": "string"
                    },
                    {
                      "name": "organization_unit",
                      "type": "string"
                    },
                    {
                      "name": "orignal_file_path",
                      "type": "string"
                    },
                    {
                      "name": "os",
                      "type": "string"
                    },
                    {
                      "name": "os_version",
                      "type": "string"
                    },
                    {
                      "name": "other_categories",
                      "type": "dynamic"
                    },
                    {
                      "name": "outer_doc_type",
                      "type": "int"
                    },
                    {
                      "name": "owner",
                      "type": "string"
                    },
                    {
                      "name": "page",
                      "type": "string"
                    },
                    {
                      "name": "page_site",
                      "type": "string"
                    },
                    {
                      "name": "parent_id",
                      "type": "string"
                    },
                    {
                      "name": "policy",
                      "type": "string"
                    },
                    {
                      "name": "policy_id",
                      "type": "string"
                    },
                    {
                      "name": "protocol",
                      "type": "string"
                    },
                    {
                      "name": "referer",
                      "type": "string"
                    },
                    {
                      "name": "req_cnt",
                      "type": "int"
                    },
                    {
                      "name": "request_id",
                      "type": "int"
                    },
                    {
                      "name": "resp_cnt",
                      "type": "int"
                    },
                    {
                      "name": "sAMAccountName",
                      "type": "string"
                    },
                    {
                      "name": "sanctioned_instance",
                      "type": "string"
                    },
                    {
                      "name": "scan_type",
                      "type": "string"
                    },
                    {
                      "name": "serial",
                      "type": "string"
                    },
                    {
                      "name": "server_bytes",
                      "type": "int"
                    },
                    {
                      "name": "sessionid",
                      "type": "string"
                    },
                    {
                      "name": "severity",
                      "type": "string"
                    },
                    {
                      "name": "sfwder",
                      "type": "string"
                    },
                    {
                      "name": "sha256",
                      "type": "string"
                    },
                    {
                      "name": "shared_with",
                      "type": "string"
                    },
                    {
                      "name": "site",
                      "type": "string"
                    },
                    {
                      "name": "smtp_to",
                      "type": "dynamic"
                    },
                    {
                      "name": "src_country",
                      "type": "string"
                    },
                    {
                      "name": "src_geoip_src",
                      "type": "int"
                    },
                    {
                      "name": "src_latitude",
                      "type": "int"
                    },
                    {
                      "name": "src_location",
                      "type": "string"
                    },
                    {
                      "name": "src_longitude",
                      "type": "int"
                    },
                    {
                      "name": "src_region",
                      "type": "string"
                    },
                    {
                      "name": "src_time",
                      "type": "string"
                    },
                    {
                      "name": "src_timezone",
                      "type": "string"
                    },
                    {
                      "name": "src_zipcode",
                      "type": "string"
                    },
                    {
                      "name": "srcip",
                      "type": "string"
                    },
                    {
                      "name": "suppression_end_time",
                      "type": "int"
                    },
                    {
                      "name": "suppression_key",
                      "type": "string"
                    },
                    {
                      "name": "suppression_start_time",
                      "type": "int"
                    },
                    {
                      "name": "telemetry_app",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "int"
                    },
                    {
                      "name": "title_s",
                      "type": "string"
                    },
                    {
                      "name": "to_user",
                      "type": "string"
                    },
                    {
                      "name": "total_collaborator_count",
                      "type": "int"
                    },
                    {
                      "name": "traffic_type",
                      "type": "string"
                    },
                    {
                      "name": "transaction_id",
                      "type": "int"
                    },
                    {
                      "name": "true_obj_category",
                      "type": "string"
                    },
                    {
                      "name": "true_obj_type",
                      "type": "string"
                    },
                    {
                      "name": "tss_mode",
                      "type": "string"
                    },
                    {
                      "name": "type_s",
                      "type": "string"
                    },
                    {
                      "name": "universal_connector",
                      "type": "string"
                    },
                    {
                      "name": "ur_normalized",
                      "type": "string"
                    },
                    {
                      "name": "url",
                      "type": "string"
                    },
                    {
                      "name": "user",
                      "type": "string"
                    },
                    {
                      "name": "user_category",
                      "type": "string"
                    },
                    {
                      "name": "user_id",
                      "type": "string"
                    },
                    {
                      "name": "useragent",
                      "type": "string"
                    },
                    {
                      "name": "userip",
                      "type": "string"
                    },
                    {
                      "name": "userkey",
                      "type": "string"
                    },
                    {
                      "name": "userPrincipalName",
                      "type": "string"
                    },
                    {
                      "name": "web_universal_connector",
                      "type": "string"
                    },
                    {
                      "name": "workspace",
                      "type": "string"
                    },
                    {
                      "name": "workspace_id",
                      "type": "string"
                    }
                  ]
                }
              }
            },
            {
              "name": "NetskopeEventsAudit_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "properties": {
                "schema": {
                  "name": "NetskopeEventsAudit_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "audit_log_event",
                      "type": "string"
                    },
                    {
                      "name": "ccl",
                      "type": "string"
                    },
                    {
                      "name": "count_i",
                      "type": "int"
                    },
                    {
                      "name": "organization_unit",
                      "type": "string"
                    },
                    {
                      "name": "sAMAccountName",
                      "type": "string"
                    },
                    {
                      "name": "severity_level",
                      "type": "int"
                    },
                    {
                      "name": "supporting_data",
                      "type": "dynamic"
                    },
                    {
                      "name": "timestamp",
                      "type": "int"
                    },
                    {
                      "name": "type_s",
                      "type": "string"
                    },
                    {
                      "name": "ur_normalized",
                      "type": "string"
                    },
                    {
                      "name": "user",
                      "type": "string"
                    },
                    {
                      "name": "userPrincipalName",
                      "type": "string"
                    }
                  ]
                }
              }
            },
            {
              "name": "NetskopeEventsConnection_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "properties": {
                "schema": {
                  "name": "NetskopeEventsConnection_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "access_method",
                      "type": "string"
                    },
                    {
                      "name": "app",
                      "type": "string"
                    },
                    {
                      "name": "app_session_id",
                      "type": "int"
                    },
                    {
                      "name": "appcategory",
                      "type": "string"
                    },
                    {
                      "name": "browser",
                      "type": "string"
                    },
                    {
                      "name": "browser_session_id",
                      "type": "int"
                    },
                    {
                      "name": "browser_version",
                      "type": "string"
                    },
                    {
                      "name": "bypass_reason",
                      "type": "string"
                    },
                    {
                      "name": "bypass_traffic",
                      "type": "string"
                    },
                    {
                      "name": "category",
                      "type": "string"
                    },
                    {
                      "name": "cci",
                      "type": "int"
                    },
                    {
                      "name": "ccl",
                      "type": "string"
                    },
                    {
                      "name": "client_bytes",
                      "type": "int"
                    },
                    {
                      "name": "conn_duration",
                      "type": "int"
                    },
                    {
                      "name": "conn_endtime",
                      "type": "int"
                    },
                    {
                      "name": "conn_starttime",
                      "type": "int"
                    },
                    {
                      "name": "connection_id",
                      "type": "int"
                    },
                    {
                      "name": "CononicalName",
                      "type": "string"
                    },
                    {
                      "name": "count_i",
                      "type": "int"
                    },
                    {
                      "name": "device",
                      "type": "string"
                    },
                    {
                      "name": "domain",
                      "type": "string"
                    },
                    {
                      "name": "dst_country",
                      "type": "string"
                    },
                    {
                      "name": "dst_geoip_src",
                      "type": "int"
                    },
                    {
                      "name": "dst_latitude",
                      "type": "int"
                    },
                    {
                      "name": "dst_location",
                      "type": "string"
                    },
                    {
                      "name": "dst_longitude",
                      "type": "int"
                    },
                    {
                      "name": "dst_region",
                      "type": "string"
                    },
                    {
                      "name": "dst_timezone",
                      "type": "string"
                    },
                    {
                      "name": "dst_zipcode",
                      "type": "string"
                    },
                    {
                      "name": "dsthost",
                      "type": "string"
                    },
                    {
                      "name": "dstip",
                      "type": "string"
                    },
                    {
                      "name": "dstport",
                      "type": "int"
                    },
                    {
                      "name": "dynamic_classification",
                      "type": "string"
                    },
                    {
                      "name": "forward_to_proxy_profile",
                      "type": "string"
                    },
                    {
                      "name": "fromlogs",
                      "type": "string"
                    },
                    {
                      "name": "hostname",
                      "type": "string"
                    },
                    {
                      "name": "http_transaction_count",
                      "type": "int"
                    },
                    {
                      "name": "log_file_name",
                      "type": "string"
                    },
                    {
                      "name": "netskope_pop",
                      "type": "string"
                    },
                    {
                      "name": "network",
                      "type": "string"
                    },
                    {
                      "name": "numbytes",
                      "type": "int"
                    },
                    {
                      "name": "org",
                      "type": "string"
                    },
                    {
                      "name": "organization_unit",
                      "type": "string"
                    },
                    {
                      "name": "os",
                      "type": "string"
                    },
                    {
                      "name": "os_version",
                      "type": "string"
                    },
                    {
                      "name": "page",
                      "type": "string"
                    },
                    {
                      "name": "policy",
                      "type": "string"
                    },
                    {
                      "name": "protocol",
                      "type": "string"
                    },
                    {
                      "name": "req_cnt",
                      "type": "int"
                    },
                    {
                      "name": "request_id",
                      "type": "int"
                    },
                    {
                      "name": "resp_cnt",
                      "type": "int"
                    },
                    {
                      "name": "resp_content_len",
                      "type": "int"
                    },
                    {
                      "name": "resp_content_type",
                      "type": "string"
                    },
                    {
                      "name": "sAMAccountName",
                      "type": "string"
                    },
                    {
                      "name": "serial",
                      "type": "string"
                    },
                    {
                      "name": "server_bytes",
                      "type": "int"
                    },
                    {
                      "name": "sessionid",
                      "type": "string"
                    },
                    {
                      "name": "severity",
                      "type": "string"
                    },
                    {
                      "name": "sfwder",
                      "type": "string"
                    },
                    {
                      "name": "site",
                      "type": "string"
                    },
                    {
                      "name": "src_country",
                      "type": "string"
                    },
                    {
                      "name": "src_geoip_src",
                      "type": "int"
                    },
                    {
                      "name": "src_latitude",
                      "type": "int"
                    },
                    {
                      "name": "src_location",
                      "type": "string"
                    },
                    {
                      "name": "src_longitude",
                      "type": "int"
                    },
                    {
                      "name": "src_region",
                      "type": "string"
                    },
                    {
                      "name": "src_time",
                      "type": "string"
                    },
                    {
                      "name": "src_timezone",
                      "type": "string"
                    },
                    {
                      "name": "src_zipcode",
                      "type": "string"
                    },
                    {
                      "name": "srcip",
                      "type": "string"
                    },
                    {
                      "name": "ssl_decrypt_policy",
                      "type": "string"
                    },
                    {
                      "name": "suppression_end_time",
                      "type": "int"
                    },
                    {
                      "name": "suppression_start_time",
                      "type": "int"
                    },
                    {
                      "name": "timestamp",
                      "type": "int"
                    },
                    {
                      "name": "traffic_type",
                      "type": "string"
                    },
                    {
                      "name": "transaction_id",
                      "type": "int"
                    },
                    {
                      "name": "type_s",
                      "type": "string"
                    },
                    {
                      "name": "ur_normalized",
                      "type": "string"
                    },
                    {
                      "name": "url",
                      "type": "string"
                    },
                    {
                      "name": "user",
                      "type": "string"
                    },
                    {
                      "name": "user_generated",
                      "type": "string"
                    },
                    {
                      "name": "useragent",
                      "type": "string"
                    },
                    {
                      "name": "userip",
                      "type": "string"
                    },
                    {
                      "name": "userkey",
                      "type": "string"
                    },
                    {
                      "name": "userPrincipalName",
                      "type": "string"
                    }
                  ]
                }
              }
            },
            {
              "name": "NetskopeEventsDLP_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "properties": {
                "schema": {
                  "name": "NetskopeEventsDLP_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "title_s",
                      "type": "string"
                    },
                    {
                      "name": "object",
                      "type": "string"
                    },
                    {
                      "name": "app",
                      "type": "string"
                    },
                    {
                      "name": "site",
                      "type": "string"
                    },
                    {
                      "name": "status",
                      "type": "string"
                    },
                    {
                      "name": "assignee",
                      "type": "string"
                    },
                    {
                      "name": "severity",
                      "type": "string"
                    },
                    {
                      "name": "instance_id",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "int"
                    },
                    {
                      "name": "exposure",
                      "type": "string"
                    },
                    {
                      "name": "acting_user",
                      "type": "string"
                    },
                    {
                      "name": "user",
                      "type": "string"
                    },
                    {
                      "name": "file_path",
                      "type": "string"
                    },
                    {
                      "name": "file_size",
                      "type": "int"
                    },
                    {
                      "name": "file_type",
                      "type": "string"
                    },
                    {
                      "name": "dlp_match_info",
                      "type": "dynamic"
                    },
                    {
                      "name": "inline_dlp_match_info",
                      "type": "dynamic"
                    },
                    {
                      "name": "access_method",
                      "type": "string"
                    },
                    {
                      "name": "activity",
                      "type": "string"
                    },
                    {
                      "name": "instance",
                      "type": "string"
                    },
                    {
                      "name": "url",
                      "type": "string"
                    },
                    {
                      "name": "object_type",
                      "type": "string"
                    },
                    {
                      "name": "owner",
                      "type": "string"
                    },
                    {
                      "name": "owner_pdl",
                      "type": "string"
                    },
                    {
                      "name": "file_lang",
                      "type": "string"
                    },
                    {
                      "name": "true_obj_category",
                      "type": "string"
                    },
                    {
                      "name": "true_obj_type",
                      "type": "string"
                    },
                    {
                      "name": "dlp_incident_id",
                      "type": "int"
                    },
                    {
                      "name": "latest_incident_id",
                      "type": "int"
                    },
                    {
                      "name": "dlp_parent_id",
                      "type": "int"
                    },
                    {
                      "name": "from_user",
                      "type": "string"
                    },
                    {
                      "name": "md5",
                      "type": "string"
                    },
                    {
                      "name": "connection_id",
                      "type": "int"
                    },
                    {
                      "name": "app_session_id",
                      "type": "int"
                    },
                    {
                      "name": "referer",
                      "type": "string"
                    },
                    {
                      "name": "dst_location",
                      "type": "string"
                    },
                    {
                      "name": "src_location",
                      "type": "string"
                    },
                    {
                      "name": "channel",
                      "type": "string"
                    },
                    {
                      "name": "to_user",
                      "type": "string"
                    },
                    {
                      "name": "cc",
                      "type": "string"
                    },
                    {
                      "name": "bcc",
                      "type": "string"
                    },
                    {
                      "name": "classification",
                      "type": "string"
                    },
                    {
                      "name": "user_id",
                      "type": "string"
                    },
                    {
                      "name": "destination_app",
                      "type": "string"
                    },
                    {
                      "name": "destination_instance_id",
                      "type": "string"
                    },
                    {
                      "name": "zip_file_id",
                      "type": "string"
                    },
                    {
                      "name": "original_file_snapshot_id",
                      "type": "string"
                    },
                    {
                      "name": "dlp_file",
                      "type": "string"
                    }
                  ]
                }
              }
            },
            {
              "name": "NetskopeEventsEndpoint_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "properties": {
                "schema": {
                  "name": "NetskopeEventsEndpoint_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "access_method",
                      "type": "string"
                    },
                    {
                      "name": "action",
                      "type": "string"
                    },
                    {
                      "name": "activity",
                      "type": "string"
                    },
                    {
                      "name": "activity_type",
                      "type": "string"
                    },
                    {
                      "name": "alert",
                      "type": "string"
                    },
                    {
                      "name": "alert_generated",
                      "type": "boolean"
                    },
                    {
                      "name": "alert_name",
                      "type": "string"
                    },
                    {
                      "name": "alert_type",
                      "type": "string"
                    },
                    {
                      "name": "app",
                      "type": "string"
                    },
                    {
                      "name": "computer_name",
                      "type": "string"
                    },
                    {
                      "name": "connection_type",
                      "type": "string"
                    },
                    {
                      "name": "destination_file_directory",
                      "type": "string"
                    },
                    {
                      "name": "destination_file_name",
                      "type": "string"
                    },
                    {
                      "name": "destination_file_path",
                      "type": "string"
                    },
                    {
                      "name": "device",
                      "type": "string"
                    },
                    {
                      "name": "device_id",
                      "type": "string"
                    },
                    {
                      "name": "device_name",
                      "type": "string"
                    },
                    {
                      "name": "device_sn",
                      "type": "string"
                    },
                    {
                      "name": "device_type",
                      "type": "string"
                    },
                    {
                      "name": "dlp_incident_id",
                      "type": "int"
                    },
                    {
                      "name": "dlp_profile",
                      "type": "string"
                    },
                    {
                      "name": "dlp_profile_name",
                      "type": "string"
                    },
                    {
                      "name": "dlp_rule",
                      "type": "string"
                    },
                    {
                      "name": "driver",
                      "type": "string"
                    },
                    {
                      "name": "event_recovered",
                      "type": "boolean"
                    },
                    {
                      "name": "executable_hash",
                      "type": "string"
                    },
                    {
                      "name": "executable_signed",
                      "type": "boolean"
                    },
                    {
                      "name": "file_origin",
                      "type": "string"
                    },
                    {
                      "name": "file_size",
                      "type": "int"
                    },
                    {
                      "name": "file_type",
                      "type": "string"
                    },
                    {
                      "name": "incident_id",
                      "type": "int"
                    },
                    {
                      "name": "justification",
                      "type": "string"
                    },
                    {
                      "name": "location",
                      "type": "string"
                    },
                    {
                      "name": "md5",
                      "type": "string"
                    },
                    {
                      "name": "os",
                      "type": "string"
                    },
                    {
                      "name": "os_details",
                      "type": "string"
                    },
                    {
                      "name": "os_user_name",
                      "type": "string"
                    },
                    {
                      "name": "pid",
                      "type": "string"
                    },
                    {
                      "name": "policy_action",
                      "type": "string"
                    },
                    {
                      "name": "policy_action_enforced",
                      "type": "string"
                    },
                    {
                      "name": "policy_name",
                      "type": "string"
                    },
                    {
                      "name": "policy_name_enforced",
                      "type": "string"
                    },
                    {
                      "name": "policy_version",
                      "type": "string"
                    },
                    {
                      "name": "port",
                      "type": "string"
                    },
                    {
                      "name": "printer_identifier",
                      "type": "string"
                    },
                    {
                      "name": "process_cert_subject",
                      "type": "string"
                    },
                    {
                      "name": "process_name",
                      "type": "string"
                    },
                    {
                      "name": "process_path",
                      "type": "string"
                    },
                    {
                      "name": "product_id",
                      "type": "string"
                    },
                    {
                      "name": "sha256",
                      "type": "string"
                    },
                    {
                      "name": "source_file_directory",
                      "type": "string"
                    },
                    {
                      "name": "source_file_name",
                      "type": "string"
                    },
                    {
                      "name": "sub_type",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "int"
                    },
                    {
                      "name": "type_s",
                      "type": "string"
                    },
                    {
                      "name": "unc_path",
                      "type": "string"
                    },
                    {
                      "name": "user",
                      "type": "string"
                    },
                    {
                      "name": "vendor_id",
                      "type": "string"
                    }
                  ]
                }
              }
            },
            {
              "name": "NetskopeEventsInfrastructure_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "properties": {
                "schema": {
                  "name": "NetskopeEventsInfrastructure_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "boolean_metric_value",
                      "type": "string"
                    },
                    {
                      "name": "hostname",
                      "type": "string"
                    },
                    {
                      "name": "metric_name",
                      "type": "string"
                    },
                    {
                      "name": "metric_true_count",
                      "type": "string"
                    },
                    {
                      "name": "metric_type",
                      "type": "string"
                    },
                    {
                      "name": "metric_value",
                      "type": "string"
                    },
                    {
                      "name": "package_version",
                      "type": "string"
                    },
                    {
                      "name": "serial",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "int"
                    }
                  ]
                }
              }
            },
            {
              "name": "NetskopeEventsNetwork_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "properties": {
                "schema": {
                  "name": "NetskopeEventsNetwork_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "access_method",
                      "type": "string"
                    },
                    {
                      "name": "action",
                      "type": "string"
                    },
                    {
                      "name": "app",
                      "type": "string"
                    },
                    {
                      "name": "appcategory",
                      "type": "string"
                    },
                    {
                      "name": "category",
                      "type": "string"
                    },
                    {
                      "name": "cci",
                      "type": "int"
                    },
                    {
                      "name": "ccl",
                      "type": "string"
                    },
                    {
                      "name": "client_bytes",
                      "type": "int"
                    },
                    {
                      "name": "client_packets",
                      "type": "int"
                    },
                    {
                      "name": "count_i",
                      "type": "int"
                    },
                    {
                      "name": "device",
                      "type": "string"
                    },
                    {
                      "name": "domain",
                      "type": "string"
                    },
                    {
                      "name": "dst_country",
                      "type": "string"
                    },
                    {
                      "name": "dst_geoip_src",
                      "type": "int"
                    },
                    {
                      "name": "dst_latitude",
                      "type": "int"
                    },
                    {
                      "name": "dst_location",
                      "type": "string"
                    },
                    {
                      "name": "dst_longitude",
                      "type": "int"
                    },
                    {
                      "name": "dst_region",
                      "type": "string"
                    },
                    {
                      "name": "dst_zipcode",
                      "type": "string"
                    },
                    {
                      "name": "dsthost",
                      "type": "string"
                    },
                    {
                      "name": "dstip",
                      "type": "string"
                    },
                    {
                      "name": "dstport",
                      "type": "int"
                    },
                    {
                      "name": "end_time",
                      "type": "string"
                    },
                    {
                      "name": "flow_status",
                      "type": "string"
                    },
                    {
                      "name": "hostname",
                      "type": "string"
                    },
                    {
                      "name": "ip_protocol",
                      "type": "string"
                    },
                    {
                      "name": "netskope_pop",
                      "type": "string"
                    },
                    {
                      "name": "network_session_id",
                      "type": "string"
                    },
                    {
                      "name": "num_sessions",
                      "type": "int"
                    },
                    {
                      "name": "numbytes",
                      "type": "int"
                    },
                    {
                      "name": "organization_unit",
                      "type": "string"
                    },
                    {
                      "name": "os",
                      "type": "string"
                    },
                    {
                      "name": "os_version",
                      "type": "string"
                    },
                    {
                      "name": "policy",
                      "type": "string"
                    },
                    {
                      "name": "pop_id",
                      "type": "string"
                    },
                    {
                      "name": "protocol",
                      "type": "string"
                    },
                    {
                      "name": "protocol_port",
                      "type": "string"
                    },
                    {
                      "name": "publisher_cn",
                      "type": "string"
                    },
                    {
                      "name": "publisher_name",
                      "type": "string"
                    },
                    {
                      "name": "sAMAccountName",
                      "type": "string"
                    },
                    {
                      "name": "server_bytes",
                      "type": "int"
                    },
                    {
                      "name": "server_packets",
                      "type": "int"
                    },
                    {
                      "name": "session_duration",
                      "type": "int"
                    },
                    {
                      "name": "site",
                      "type": "string"
                    },
                    {
                      "name": "src_country",
                      "type": "string"
                    },
                    {
                      "name": "src_geoip_src",
                      "type": "int"
                    },
                    {
                      "name": "src_latitude",
                      "type": "int"
                    },
                    {
                      "name": "src_location",
                      "type": "string"
                    },
                    {
                      "name": "src_longitude",
                      "type": "int"
                    },
                    {
                      "name": "src_region",
                      "type": "string"
                    },
                    {
                      "name": "src_zipcode",
                      "type": "string"
                    },
                    {
                      "name": "srcip",
                      "type": "string"
                    },
                    {
                      "name": "srcport",
                      "type": "int"
                    },
                    {
                      "name": "start_time",
                      "type": "string"
                    },
                    {
                      "name": "timestamp",
                      "type": "int"
                    },
                    {
                      "name": "total_packets",
                      "type": "int"
                    },
                    {
                      "name": "traffic_type",
                      "type": "string"
                    },
                    {
                      "name": "tunnel_id",
                      "type": "string"
                    },
                    {
                      "name": "tunnel_type",
                      "type": "string"
                    },
                    {
                      "name": "tunnel_up_time",
                      "type": "int"
                    },
                    {
                      "name": "type_s",
                      "type": "string"
                    },
                    {
                      "name": "ur_normalized",
                      "type": "string"
                    },
                    {
                      "name": "user",
                      "type": "string"
                    },
                    {
                      "name": "userip",
                      "type": "string"
                    },
                    {
                      "name": "userkey",
                      "type": "string"
                    },
                    {
                      "name": "userPrincipalName",
                      "type": "string"
                    }
                  ]
                }
              }
            },
            {
              "name": "NetskopeEventsPage_CL",
              "apiVersion": "2022-10-01",
              "type": "Microsoft.OperationalInsights/workspaces/tables",
              "properties": {
                "schema": {
                  "name": "NetskopeEventsPage_CL",
                  "columns": [
                    {
                      "name": "TimeGenerated",
                      "type": "datetime"
                    },
                    {
                      "name": "access_method",
                      "type": "string"
                    },
                    {
                      "name": "app",
                      "type": "string"
                    },
                    {
                      "name": "app_session_id",
                      "type": "int"
                    },
                    {
                      "name": "appcategory",
                      "type": "string"
                    },
                    {
                      "name": "browser",
                      "type": "string"
                    },
                    {
                      "name": "browser_session_id",
                      "type": "int"
                    },
                    {
                      "name": "browser_version",
                      "type": "string"
                    },
                    {
                      "name": "bypass_reason",
                      "type": "string"
                    },
                    {
                      "name": "bypass_traffic",
                      "type": "string"
                    },
                    {
                      "name": "category",
                      "type": "string"
                    },
                    {
                      "name": "cci",
                      "type": "int"
                    },
                    {
                      "name": "ccl",
                      "type": "string"
                    },
                    {
                      "name": "client_bytes",
                      "type": "int"
                    },
                    {
                      "name": "conn_duration",
                      "type": "int"
                    },
                    {
                      "name": "conn_endtime",
                      "type": "int"
                    },
                    {
                      "name": "conn_starttime",
                      "type": "int"
                    },
                    {
                      "name": "connection_id",
                      "type": "int"
                    },
                    {
                      "name": "CononicalName",
                      "type": "string"
                    },
                    {
                      "name": "count_i",
                      "type": "int"
                    },
                    {
                      "name": "device",
                      "type": "string"
                    },
                    {
                      "name": "domain",
                      "type": "string"
                    },
                    {
                      "name": "dst_country",
                      "type": "string"
                    },
                    {
                      "name": "dst_geoip_src",
                      "type": "int"
                    },
                    {
                      "name": "dst_latitude",
                      "type": "int"
                    },
                    {
                      "name": "dst_location",
                      "type": "string"
                    },
                    {
                      "name": "dst_longitude",
                      "type": "int"
                    },
                    {
                      "name": "dst_region",
                      "type": "string"
                    },
                    {
                      "name": "dst_timezone",
                      "type": "string"
                    },
                    {
                      "name": "dst_zipcode",
                      "type": "string"
                    },
                    {
                      "name": "dsthost",
                      "type": "string"
                    },
                    {
                      "name": "dstip",
                      "type": "string"
                    },
                    {
                      "name": "dstport",
                      "type": "int"
                    },
                    {
                      "name": "dynamic_classification",
                      "type": "string"
                    },
                    {
                      "name": "forward_to_proxy_profile",
                      "type": "string"
                    },
                    {
                      "name": "fromlogs",
                      "type": "string"
                    },
                    {
                      "name": "hostname",
                      "type": "string"
                    },
                    {
                      "name": "http_transaction_count",
                      "type": "int"
                    },
                    {
                      "name": "log_file_name",
                      "type": "string"
                    },
                    {
                      "name": "netskope_pop",
                      "type": "string"
                    },
                    {
                      "name": "network",
                      "type": "string"
                    },
                    {
                      "name": "numbytes",
                      "type": "int"
                    },
                    {
                      "name": "org",
                      "type": "string"
                    },
                    {
                      "name": "organization_unit",
                      "type": "string"
                    },
                    {
                      "name": "os",
                      "type": "string"
                    },
                    {
                      "name": "os_version",
                      "type": "string"
                    },
                    {
                      "name": "page",
                      "type": "string"
                    },
                    {
                      "name": "policy",
                      "type": "string"
                    },
                    {
                      "name": "protocol",
                      "type": "string"
                    },
                    {
                      "name": "req_cnt",
                      "type": "int"
                    },
                    {
                      "name": "request_id",
                      "type": "int"
                    },
                    {
                      "name": "resp_cnt",
                      "type": "int"
                    },
                    {
                      "name": "resp_content_len",
                      "type": "int"
                    },
                    {
                      "name": "resp_content_type",
                      "type": "string"
                    },
                    {
                      "name": "sAMAccountName",
                      "type": "string"
                    },
                    {
                      "name": "serial",
                      "type": "string"
                    },
                    {
                      "name": "server_bytes",
                      "type": "int"
                    },
                    {
                      "name": "sessionid",
                      "type": "string"
                    },
                    {
                      "name": "severity",
                      "type": "string"
                    },
                    {
                      "name": "sfwder",
                      "type": "string"
                    },
                    {
                      "name": "site",
                      "type": "string"
                    },
                    {
                      "name": "src_country",
                      "type": "string"
                    },
                    {
                      "name": "src_geoip_src",
                      "type": "int"
                    },
                    {
                      "name": "src_latitude",
                      "type": "int"
                    },
                    {
                      "name": "src_location",
                      "type": "string"
                    },
                    {
                      "name": "src_longitude",
                      "type": "int"
                    },
                    {
                      "name": "src_region",
                      "type": "string"
                    },
                    {
                      "name": "src_time",
                      "type": "string"
                    },
                    {
                      "name": "src_timezone",
                      "type": "string"
                    },
                    {
                      "name": "src_zipcode",
                      "type": "string"
                    },
                    {
                      "name": "srcip",
                      "type": "string"
                    },
                    {
                      "name": "ssl_decrypt_policy",
                      "type": "string"
                    },
                    {
                      "name": "suppression_end_time",
                      "type": "int"
                    },
                    {
                      "name": "suppression_start_time",
                      "type": "int"
                    },
                    {
                      "name": "timestamp",
                      "type": "int"
                    },
                    {
                      "name": "traffic_type",
                      "type": "string"
                    },
                    {
                      "name": "transaction_id",
                      "type": "int"
                    },
                    {
                      "name": "type_s",
                      "type": "string"
                    },
                    {
                      "name": "ur_normalized",
                      "type": "string"
                    },
                    {
                      "name": "url",
                      "type": "string"
                    },
                    {
                      "name": "user",
                      "type": "string"
                    },
                    {
                      "name": "user_generated",
                      "type": "string"
                    },
                    {
                      "name": "useragent",
                      "type": "string"
                    },
                    {
                      "name": "userip",
                      "type": "string"
                    },
                    {
                      "name": "userkey",
                      "type": "string"
                    },
                    {
                      "name": "userPrincipalName",
                      "type": "string"
                    }
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','dc','-', uniqueString(concat(variables('_solutionId'),'-','DataConnector','-',variables('_dataConnectorContentIdConnectorDefinition3'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',variables('_dataConnectorContentIdConnectorDefinition3'))]",
      "apiVersion": "2022-09-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectorDefinitions",
      "location": "[parameters('workspace-location')]",
      "kind": "Customizable",
      "properties": {
        "connectorUiConfig": {
          "id": "NetskopeCCP",
          "title": "Netskope Alerts and Events",
          "publisher": "Netskope",
          "descriptionMarkdown": "Netskope Security Alerts and Events",
          "graphQueriesTableName": "NetskopeAlerts_CL",
          "graphQueries": [
            {
              "metricName": "Total Netskope Alerts received",
              "legend": "Netskope Alerts",
              "baseQuery": "NetskopeAlerts_CL"
            },
            {
              "metricName": "Total Netskope Application Events",
              "legend": "Netskope Application Events",
              "baseQuery": "NetskopeEventsApplication_CL"
            },
            {
              "metricName": "Total Netskope Audit Events",
              "legend": "Netskope Audit Events",
              "baseQuery": "NetskopeEventsAudit_CL"
            },
            {
              "metricName": "Total Netskope Connection Events",
              "legend": "Netskope Connection Events",
              "baseQuery": "NetskopeEventsConnection_CL"
            },
            {
              "metricName": "Total Netskope DLP Events",
              "legend": "Netskope DLP Events",
              "baseQuery": "NetskopeEventsDLP_CL"
            },
            {
              "metricName": "Total Netskope Endpoint Events",
              "legend": "Netskope Endpoint Events",
              "baseQuery": "NetskopeEventsEndpoint_CL"
            },
            {
              "metricName": "Total Netskope Infrastructure Events",
              "legend": "Netskope Infrastructure Events",
              "baseQuery": "NetskopeEventsInfrastructure_CL"
            },
            {
              "metricName": "Total Netskope Network Events",
              "legend": "Netskope Network Events",
              "baseQuery": "NetskopeEventsNetwork_CL"
            },
            {
              "metricName": "Total Netskope Page Events",
              "legend": "Netskope Page Events",
              "baseQuery": "NetskopeEventsPage_CL"
            }
          ],
          "sampleQueries": [
            {
              "description": "Get Sample of Netskope events",
              "query": "NetskopeAlerts_CL\n | take 10"
            }
          ],
          "dataTypes": [
            {
              "name": "NetskopeAlerts_CL",
              "lastDataReceivedQuery": "NetskopeAlerts_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "NetskopeEventsApplication_CL",
              "lastDataReceivedQuery": "NetskopeEventsApplication_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "NetskopeEventsAudit_CL",
              "lastDataReceivedQuery": "NetskopeEventsAudit_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "NetskopeEventsConnection_CL",
              "lastDataReceivedQuery": "NetskopeEventsConnection_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "NetskopeEventsDLP_CL",
              "lastDataReceivedQuery": "NetskopeEventsDLP_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "NetskopeEventsEndpoint_CL",
              "lastDataReceivedQuery": "NetskopeEventsEndpoint_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "NetskopeEventsInfrastructure_CL",
              "lastDataReceivedQuery": "NetskopeEventsInfrastructure_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "NetskopeEventsNetwork_CL",
              "lastDataReceivedQuery": "NetskopeEventsNetwork_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            },
            {
              "name": "NetskopeEventsPage_CL",
              "lastDataReceivedQuery": "NetskopeEventsPage_CL \n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
            }
          ],
          "connectivityCriteria": [
            {
              "type": "HasDataConnectors"
            }
          ],
          "availability": {
            "isPreview": false
          },
          "permissions": {
            "resourceProvider": [
              {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "Read and Write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                  "write": true,
                  "read": true,
                  "delete": true
                }
              }
            ],
            "customs": [
              {
                "name": "Netskope organisation url",
                "description": "The Netskope data connector requires you to provide your organisation url. You can find your organisation url by signing into the Netskope portal."
              },
              {
                "name": "Netskope API key",
                "description": "The Netskope data connector requires you to provide a valid API key. You can create one by following the [Netskope documentation](https://docs.netskope.com/en/rest-api-v2-overview-312207/)."
              }
            ]
          },
          "instructionSteps": [
            {
              "title": "STEP 1 - Create a Netskope API key.",
              "description": "Follow the [Netskope documentation](https://docs.netskope.com/en/rest-api-v2-overview-312207/) for guidance on this step."
            },
            {
              "title": "STEP 2 - Enter your Netskope product Details",
              "description": "Enter your Netskope organisation url & API Token below:",
              "instructions": [
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "Organisation URL",
                    "placeholder": "Enter your organisation url",
                    "type": "text",
                    "name": "OrganisationURL"
                  }
                },
                {
                  "type": "Textbox",
                  "parameters": {
                    "label": "API Key",
                    "placeholder": "Enter your API Key",
                    "type": "password",
                    "name": "apikey"
                  }
                },
                {
                  "type": "InstructionStepsGroup",
                  "parameters": {
                    "instructionSteps": [
                      {
                        "title": "OPTIONAL: Specify the Index the API uses.",
                        "description": "**Configuring the index is optional and only required in advanced scenario's.** \n Netskope uses an [index](https://docs.netskope.com/en/using-the-rest-api-v2-dataexport-iterator-endpoints/#how-do-iterator-endpoints-function) to retrieve events. In some advanced cases (consuming the event in multiple Microsoft Sentinel workspaces, or pre-fatiguing the index to only retrieve recent data), a customer might want to have direct control over the index.",
                        "instructions": [
                          {
                            "type": "Textbox",
                            "parameters": {
                              "label": "Index",
                              "placeholder": "NetskopeCCP",
                              "type": "text",
                              "name": "Index"
                            }
                          }
                        ]
                      }
                    ]
                  }
                }
              ]
            },
            {
              "title": "STEP 3 - Click Connect",
              "description": "Verify all fields above were filled in correctly. Press the Connect to connect Netskope to Microsoft Sentinel.",
              "instructions": [
                {
                  "type": "ConnectionToggleButton",
                  "parameters": {
                    "connectLabel": "connect",
                    "name": "connect"
                  }
                }
              ]
            }
          ]
        }
      }
    },
    {
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnectorDefinition3')))]",
      "apiVersion": "2022-01-01-preview",
      "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
      "properties": {
        "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectorDefinitions', variables('_dataConnectorContentIdConnectorDefinition3'))]",
        "contentId": "[variables('_dataConnectorContentIdConnectorDefinition3')]",
        "kind": "DataConnector",
        "version": "[variables('dataConnectorCCPVersion')]",
        "source": {
          "sourceId": "[variables('_solutionId')]",
          "name": "[variables('_solutionName')]",
          "kind": "Solution"
        },
        "author": {
          "name": "Netskope"
        },
        "support": {
          "name": "Netskope",
          "tier": "Partner",
          "link": "https://www.netskope.com/services#support"
        },
        "dependencies": {
          "criteria": [
            {
              "version": "[variables('dataConnectorCCPVersion')]",
              "contentId": "[variables('_dataConnectorContentIdConnections3')]",
              "kind": "ResourcesDataConnector"
            }
          ]
        }
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentTemplates",
      "apiVersion": "2023-04-01-preview",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('dataConnectorTemplateNameConnections3'), variables('dataConnectorCCPVersion'))]",
      "location": "[parameters('workspace-location')]",
      "dependsOn": [
        "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/contentPackages', variables('_solutionId'))]"
      ],
      "properties": {
        "contentId": "[variables('_dataConnectorContentIdConnections3')]",
        "displayName": "Netskope Alerts and Events",
        "contentKind": "ResourcesDataConnector",
        "mainTemplate": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "[variables('dataConnectorCCPVersion')]",
          "parameters": {
            "connectorDefinitionName": {
              "defaultValue": "Netskope Alerts and Events",
              "type": "string",
              "minLength": 1
            },
            "workspace": {
              "defaultValue": "[parameters('workspace')]",
              "type": "string"
            },
            "dcrConfig": {
              "defaultValue": {
                "dataCollectionEndpoint": "data collection Endpoint",
                "dataCollectionRuleImmutableId": "data collection rule immutableId"
              },
              "type": "object"
            },
            "OrganisationURL": {
              "defaultValue": "OrganisationURL",
              "type": "string",
              "minLength": 1
            },
            "apikey": {
              "defaultValue": "apikey",
              "type": "string",
              "minLength": 1
            },
            "Index": {
              "defaultValue": "NetskopeCCP",
              "type": "string",
              "minLength": 1
            }
          },
          "variables": {
            "_dataConnectorContentIdConnections3": "[variables('_dataConnectorContentIdConnections3')]"
          },
          "resources": [
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('DataConnector-', variables('_dataConnectorContentIdConnections3')))]",
              "apiVersion": "2022-01-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/metadata",
              "properties": {
                "parentId": "[extensionResourceId(resourceId('Microsoft.OperationalInsights/workspaces', parameters('workspace')), 'Microsoft.SecurityInsights/dataConnectors', variables('_dataConnectorContentIdConnections3'))]",
                "contentId": "[variables('_dataConnectorContentIdConnections3')]",
                "kind": "ResourcesDataConnector",
                "version": "[variables('dataConnectorCCPVersion')]",
                "source": {
                  "sourceId": "[variables('_solutionId')]",
                  "name": "[variables('_solutionName')]",
                  "kind": "Solution"
                },
                "author": {
                  "name": "Netskope"
                },
                "support": {
                  "name": "Netskope",
                  "tier": "Partner",
                  "link": "https://www.netskope.com/services#support"
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsRemediation')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/remediation?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsUba')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/uba?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsSecurityAssessment')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/securityassessment?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsQuarantine')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/quarantine?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsPolicy')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/policy?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsMalware')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/malware?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsMalsite')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/malsite?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsDlp')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/dlp?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsCtep')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/ctep?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsWatchlist')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/watchlist?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsCompromisedCredentials')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/compromisedcredential?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsContent')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/content?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeAlertsDevice')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeAlerts_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeAlerts",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/alerts/device?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeEventsApplication')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeEventsApplication_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeEventsApplication",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/application?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeEventsAudit')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeEventsAudit_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeEventsAudit",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/audit?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeEventsConnection')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeEventsConnection_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeEventsConnection",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/connection?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeEventsDLP')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeEventsDLP_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeEventsDLP",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/incident?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeEventsEndpoint')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeEventsEndpoint_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeEventsEndpoint",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/endpoint?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeEventsInfrastructure')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeEventsInfrastructure_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeEventsInfrastructure",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/infrastructure?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeEventsNetwork')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeEventsNetwork_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeEventsNetwork",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/network?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            },
            {
              "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', 'NetskopeEventsPage')]",
              "apiVersion": "2023-02-01-preview",
              "type": "Microsoft.OperationalInsights/workspaces/providers/dataConnectors",
              "location": "[parameters('workspace-location')]",
              "kind": "RestApiPoller",
              "properties": {
                "connectorDefinitionName": "NetskopeCCP",
                "dataType": "NetskopeEventsPage_CL",
                "dcrConfig": {
                  "streamName": "Custom-NetskopeEventsPage",
                  "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
                  "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
                },
                "auth": {
                  "type": "APIKey",
                  "ApiKeyName": "Netskope-Api-Token",
                  "ApiKey": "[[parameters('apikey')]"
                },
                "request": {
                  "apiEndpoint": "[[concat('https://', parameters('OrganisationURL'), '/api/v2/events/dataexport/events/page?operation=next&index=', parameters('Index'))]",
                  "httpMethod": "GET",
                  "queryWindowInMin": 5,
                  "queryTimeFormat": "UnixTimestamp",
                  "rateLimitQps": 10,
                  "retryCount": 3,
                  "timeoutInSeconds": 60,
                  "headers": {
                    "Accept": "application/json"
                  }
                },
                "response": {
                  "eventsJsonPaths": [
                    "$.result"
                  ]
                }
              }
            }
          ]
        },
        "packageKind": "Solution",
        "packageVersion": "[variables('_solutionVersion')]",
        "packageName": "[variables('_solutionName')]",
        "contentProductId": "[concat(take(variables('_solutionId'), 50),'-','rdc','-', uniqueString(concat(variables('_solutionId'),'-','ResourcesDataConnector','-',variables('_dataConnectorContentIdConnections3'),'-', variables('dataConnectorCCPVersion'))))]",
        "packageId": "[variables('_solutionId')]",
        "contentSchemaVersion": "3.0.0",
        "version": "[variables('dataConnectorCCPVersion')]"
      }
    },
    {
      "type": "Microsoft.OperationalInsights/workspaces/providers/contentPackages",
      "apiVersion": "2023-04-01-preview",
      "location": "[parameters('workspace-location')]",
      "properties": {
        "version": "3.0.0",
        "kind": "Solution",
        "contentSchemaVersion": "3.0.0",
        "displayName": "Netskopev2",
        "publisherDisplayName": "Netskope",
        "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/Netskopev2/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>Netskope solution for Microsoft Sentinel enables you to ingest Netskope alerts and events into Microsoft Sentinel. The connector provides visibility into Netskope Platform Events and Alerts in Microsoft Sentinel to improve monitoring and investigation capabilities.</p>\n<p><strong>Data Connectors:</strong> 3, <strong>Workbooks:</strong> 1, <strong>Playbooks:</strong> 2</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
        "contentKind": "Solution",
        "contentProductId": "[variables('_solutioncontentProductId')]",
        "id": "[variables('_solutioncontentProductId')]",
        "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/Netskope.svg\" width=\"75px\" height=\"75px\">",
        "contentId": "[variables('_solutionId')]",
        "parentId": "[variables('_solutionId')]",
        "source": {
          "kind": "Solution",
          "name": "Netskopev2",
          "sourceId": "[variables('_solutionId')]"
        },
        "author": {
          "name": "Netskope"
        },
        "support": {
          "name": "Netskope",
          "tier": "Partner",
          "link": "https://www.netskope.com/services#support"
        },
        "dependencies": {
          "operator": "AND",
          "criteria": [
            {
              "kind": "Workbook",
              "contentId": "[variables('_workbookContentId1')]",
              "version": "[variables('workbookVersion1')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_NetskopeDataConnectorsTriggerSync')]",
              "version": "[variables('playbookVersion1')]"
            },
            {
              "kind": "Playbook",
              "contentId": "[variables('_NetskopeWebTxErrorEmail')]",
              "version": "[variables('playbookVersion2')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId1')]",
              "version": "[variables('dataConnectorVersion1')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentId2')]",
              "version": "[variables('dataConnectorVersion2')]"
            },
            {
              "kind": "DataConnector",
              "contentId": "[variables('_dataConnectorContentIdConnections3')]",
              "version": "[variables('dataConnectorCCPVersion')]"
            }
          ]
        },
        "firstPublishDate": "2024-03-18",
        "lastPublishDate": "2024-03-18",
        "providers": [
          "Netskope"
        ],
        "categories": {
          "domains": [
            "Security - Network"
          ]
        }
      },
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/', variables('_solutionId'))]"
    }
  ],
  "outputs": {}
}
