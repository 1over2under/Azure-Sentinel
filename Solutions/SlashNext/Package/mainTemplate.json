{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "author": "SlashNext - support@slashnext.com",
    "comments": "Solution template for SlashNext"
  },
  "parameters": {
    "location": {
      "type": "string",
      "minLength": 1,
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
      }
    },
    "workspace-location": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "[concat('Region to deploy solution resources -- separate from location selection',parameters('location'))]"
      }
    },
    "workspace": {
      "defaultValue": "",
      "type": "string",
      "metadata": {
        "description": "Workspace name for Log Analytics where Microsoft Sentinel is setup"
      }
    }
  },
  "variables": {
    "email": "support@slashnext.com",
    "_email": "[variables('email')]",
    "_solutionName": "SlashNext",
    "_solutionVersion": "3.0.0",
    "solutionId": "slashnext1598548183597.slashnext-weblog-assessment-for-microsoft-sentinel",
    "_solutionId": "[variables('solutionId')]",
    "_solutioncontentProductId": "[concat(take(variables('_solutionId'),50),'-','sl','-', uniqueString(concat(variables('_solutionId'),'-','Solution','-',variables('_solutionId'),'-', variables('_solutionVersion'))))]"
  },
  "resources": [{
    "type": "Microsoft.SecurityInsights/solutions",
    "apiVersion": "2023-04-01-preview",
    "location": "[parameters('workspace-location')]",
    "properties": {
      "version": "3.0.0",
      "kind": "Solution",
      "contentSchemaVersion": "3.0.0",
      "displayName": "SlashNext",
      "publisherDisplayName": "SlashNext",
      "descriptionHtml": "<p><strong>Note:</strong> Please refer to the following before installing the solution:</p>\n<p>• Review the solution <a href=\"https://github.com/Azure/Azure-Sentinel/tree/master/Solutions/SlashNext/ReleaseNotes.md\">Release Notes</a></p>\n<p>• There may be <a href=\"https://aka.ms/sentinelsolutionsknownissues\">known issues</a> pertaining to this Solution, please refer to them before installing.</p>\n<p>SlashNext URL Investigation Connector is based upon its Real-time Phishing Defense (RPD) APIs which are connected to SlashNext real-time threat intelligence database, continuously updated with the latest phishing threats. SlashNext RPD APIs are designed to be very fast and give accurate binary verdict on each enrichment request to ease its integration in any phishing Incident Response (IR) or SOAR environment.</p>\n<p><a href=\"https://aka.ms/azuresentinel\">Learn more about Microsoft Sentinel</a> | <a href=\"https://aka.ms/azuresentinelsolutionsdoc\">Learn more about Solutions</a></p>\n",
      "contentKind": "Solution",
      "contentProductId": "[variables('_solutioncontentProductId')]",
      "id": "[variables('_solutioncontentProductId')]",
      "icon": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/slashnext-logo.svg\" width=\"75px\"height=\"75px\">",
      "contentId": "[variables('_solutionId')]",
      "parentId": "[variables('_solutionId')]",
      "source": {
        "kind": "Solution",
        "name": "SlashNext",
        "sourceId": "[variables('_solutionId')]"
      },
      "author": {
        "name": "SlashNext",
        "email": "[variables('_email')]"
      },
      "support": {
        "name": "SlashNext",
        "email": "support@slashnext.com",
        "tier": "Partner",
        "link": "https://support@slashnext.com"
      },
      "firstPublishDate": "2022-08-12",
      "lastPublishDate": "2022-08-12",
      "providers": [
        "SlashNext"
      ],
      "categories": {
        "domains": [
          "Security - Network",
          "Security - Automation (SOAR)"
        ]
      }
    },
    "name": "[variables('_solutionId')]"
  }],
  "outputs": {}
}
