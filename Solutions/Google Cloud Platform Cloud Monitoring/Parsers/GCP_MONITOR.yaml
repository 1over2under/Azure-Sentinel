id: d2972be4-978f-41fb-88e7-e0c10569a49f
Function:
  Title: Parser for GCP_MONITOR
  Version: '1.0.0'
  LastUpdated: '2023-08-23'
Category: Microsoft Sentinel Parser
FunctionName: GCP_MONITOR
FunctionAlias: GCP_MONITOR
FunctionQuery: |
  let GCP_Monitoring_View = view () {
  GCP_MONITORING_CL
  | extend EventVendor = 'GCP'
  | extend EventProduct = 'Cloud Monitoring'
  | extend
        MetricLabelsInstanceName=metric_labels_instance_name_s,
        MetricType=metric_type_s,
        ResourceType=resource_type_s,
        ResourceLabelsProjectId=resource_labels_project_id_s,
        ResourceLabelsInstanceId=resource_labels_instance_id_s,
        ResourceLabelsZone=resource_labels_zone_s,
        MetricKind=metricKind_s,
        ValueType=valueType_s,
        IntervalStartTime=interval_startTime_t,
        IntervalEndTime=interval_endTime_t,
        ValueInt64Value=value_int64Value_d
  };
  let GCP_MonitoringV2_View = view () {
  GCP_MONITORINGV2_CL
  | extend MetricLabels= todynamic(MetricLabels)
  | extend MetricType= todynamic(MetricType)
  | extend Resource = todynamic(Resource)
  | extend MetricKind = todynamic(MetricKind)
  | extend ValueType = todynamic(ValueType)
  | extend Points = todynamic(Points)
  | extend EventVendor = 'GCP'
  | extend EventProduct = 'Cloud Monitoring'
  | extend MetricLabelsInstanceName = tostring(MetricLabels.instance_name), ResourceType = tostring(Resource.type), ResourceLabelsProjectId = tostring(Resource.labels.project_id), ResourceLabelsInstanceId = tostring(Resource.labels.instance_id), ResourceLabelsZone = tostring(Resource.labels.zone), IntervalStartTime = tostring(Points.interval.startTime), IntervalEndTime = tostring(Points.interval.endTime), ValueInt64Value = tostring(ValueType.int64Value)
  };
  union isfuzzy = true
  (GCP_Monitoring_View),
  (GCP_MonitoringV2_View)
  | project MetricLabelsInstanceName, MetricType, ResourceType, ResourceLabelsProjectId, ResourceLabelsInstanceId, ResourceLabelsZone, MetricKind, ValueType, IntervalStartTime, IntervalEndTime, ValueInt64Value