{
    "name": "StyxViewEndpointTemplateConnectorDefinition",
    "apiVersion": "2022-09-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
    "location": "{{location}}",
    "kind": "Customizable",
    "properties": {
        "connectorUiConfig": {
            "id": "StyxViewEndpointTemplateConnectorDefinition",
            "title": "StyxView Alerts (via Codeless Connector Platform)",
            "publisher": "Styx Intelligence",
            "descriptionMarkdown": "The [StyxView Alerts](https://styxintel.com/) data connector provides the capability to ingest StyxView alerts into Microsoft Sentinel.",
            "graphQueriesTableName": "[variables('styxViewAlertsTableName')]",
            "graphQueries": [
                {
                    "metricName": "Total alerts received",
                    "legend": "StyxView Alert logs",
                    "baseQuery": "StyxViewAlerts_CL"
                }
            ],
            "sampleQueries": [
                {
                    "description": "Get a sample of StyxView Alert logs",
                    "query": "StyxViewAlerts_CL\n| take 10"
                }
            ],
            "dataTypes": [
                {
                    "name": "StyxViewAlerts_CL",
                    "lastDataReceivedQuery": "StyxViewAlerts_CL\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
                }
            ],
            "connectivityCriteria": [
                {
                    "type": "HasDataConnectors"
                }
            ],
            "availability": {
                "isPreview": false
            },
            "permissions": {
                "resourceProvider": [
                    {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                            "write": true,
                            "read": true,
                            "delete": true
                        }
                    }
                ],
                "customs": [
                    {
                        "name": "StyxView Alert API access",
                        "description": "Access to the StyxView Alerts API through an API key is required."
                    }
                ]
            },
            "instructionSteps": [
                {
                    "description": "Contact Styx Intelligence Support (support.team@styxintel.com) to get access to an API key.",
                    "instructions": [
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "API Token",
                                "placeholder": "API Token",
                                "type": "password",
                                "name": "APIKey"
                            }
                        },
                        {
                            "parameters": {
                                "label": "toggle",
                                "name": "toggle"
                            },
                            "type": "ConnectionToggleButton"
                        }
                    ],
                    "title": "Connect to StyxView Alerts API to start collecting alert logs in Microsoft Sentinel"
                }
            ]
        }
    }
}