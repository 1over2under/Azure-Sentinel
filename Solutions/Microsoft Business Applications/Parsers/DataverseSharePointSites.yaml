Contentkind: Function
Description: DataverseSharePointSites
Function:
  Title: DataverseSharePointSites
  Version: 3.2.0
  LastUpdated: '2024-11-18'
Category: MSBizAppsFunctions
FunctionName: DataverseSharePointSites
FunctionParams:
  - Name: MSBizAppsConfigurationWatchlistAlias
    Type: string
    Default: 'MSBizApps-Configuration'
FunctionQuery: |
  let DataverseSharepointSites_definition = datatable (
      InstanceUrl: string,
      SharePointUrl: string
  ) [
      '_', '_'
  ];
  let DataverseSharepointSites_data = (
      _GetWatchlist(MSBizAppsConfigurationWatchlistAlias)
      | where SearchKey == "SharePoint"
      | extend Data = todynamic(Data)
      | project
          InstanceUrl = tostring(Data.InstanceUrl),
          SharePointUrl = tostring(Data.SharePointUrl)
      );
  DataverseSharepointSites_data
  | union isfuzzy = true (DataverseSharepointSites_definition)
  | where InstanceUrl != '_'
  | extend InstanceUrl = tolower(iff(InstanceUrl endswith '/', InstanceUrl, strcat(InstanceUrl, '/')))
  | extend SharePointUrl = tolower(iff(SharePointUrl endswith '/', SharePointUrl, strcat(SharePointUrl, '/')))
  | project InstanceUrl, SharePointUrl
