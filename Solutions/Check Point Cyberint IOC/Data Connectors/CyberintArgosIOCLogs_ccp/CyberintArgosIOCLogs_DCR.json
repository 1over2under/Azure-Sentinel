{
  "properties": {
    "dataCollectionEndpointId": "[concat('/subscriptions/',parameters('subscription'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Insights/dataCollectionEndpoints/',parameters('workspace'))]",
    "streamDeclarations": {
      "Custom-iocsent_CL": {
        "columns": [
          {
            "name": "detected_activity",
            "type": "string"
          },
          {
            "name": "ioc_type",
            "type": "string"
          },
          {
            "name": "ioc_value",
            "type": "string"
          },
          {
            "name": "observation_date",
            "type": "datetime"
          },
          {
            "name": "severity_score",
            "type": "int"
          },
          {
            "name": "confidence",
            "type": "int"
          },
          {
            "name": "description",
            "type": "string"
          }
        ]
      }
    },
    "dataSources": {},
    "destinations": {
      "logAnalytics": [
        {
          "workspaceResourceId": "[variables('workspaceResourceId')]",
          "name": "ioc-sent"
        }
      ]
    },
    "dataFlows": [
      {
        "streams": ["Custom-iocsent_CL"],
        "destinations": ["ioc-sent"],
        "transformKql": "source\n| extend TimeGenerated = todatetime(observation_date)\n| project-away observation_date\n\n",
        "outputStream": "Custom-iocsent_CL"
      }
    ]
  },
  "location": "[parameters('workspace-location')]",
  "kind": null,
  "id": "/subscriptions/4adc55c1-0415-44be-8959-46bef0c3abcb/resourceGroups/ioc-sent-tst/providers/Microsoft.Insights/dataCollectionRules/Microsoft-Sentinel-ioc-sent-f7c6d25c-a62",
  "name": "Microsoft-Sentinel-ioc-sent-f7c6d25c-a62",
  "type": "Microsoft.Insights/dataCollectionRules",
  "apiVersion": "2022-06-01"
}
