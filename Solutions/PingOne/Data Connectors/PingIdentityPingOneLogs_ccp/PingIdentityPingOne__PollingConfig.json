[
  {
      "type": "Microsoft.SecurityInsights/dataConnectors",
      "apiVersion": "2025-03-01",
      "name": "PingOneUsersPoller",
      "kind": "RestApiPoller",
      "properties": {
          "connectorDefinitionName": "PingIdentityPingOneLogsCCPDefinition",
          "dataType": "PingOne_Users_CL",
          "auth":  {
            "type": "OAuth2",
            "ClientId": "[[parameters('clientId')]",
            "ClientSecret": "[[parameters('clientSecret')]",
            "grantType": "client_credentials",
            "tokenEndpoint": "[[concat('https://auth.pingone.com/',parameters('environmentId'),'/as/token')]",
            "tokenEndpointHeaders": {
              "Content-Type": "application/x-www-form-urlencoded"
            }
          },
          "request": {
              "apiEndpoint": "https://api.pingone.com/v1/environments/{{environmentId}}/users",
              "httpMethod": "GET",
              "queryWindowInMin": 10,
              "queryTimeFormat": "yyyy-MM-ddTHH:mm:ss.000000+00:00",      
              "headers": {
                      "Accept": "application/json",
                      "User-Agent": "Scuba"
              }
          },
          "response": {
        "eventsJsonPaths": [
          "$._embedded.users"
        ],
        "format": "json"
      },
          "dcrConfig": {
              "streamName": "Custom-PingOne_Users_CL",
              "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
              "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
          },
          "paging": {
        "pagingType": "LinkHeader",
        "linkHeaderTokenJsonPath": "$._links.next.href"
      }
      }
  },
  {
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2025-03-01",
    "name": "PingOneAuditActivitiesPoller",
    "kind": "RestApiPoller",
    "properties": {
        "connectorDefinitionName": "PingIdentityPingOneLogsCCPDefinition",
        "dataType": "PingOne_AuditActivities_CL",
        "auth":  {
            "type": "OAuth2",
            "ClientId": "[[parameters('clientId')]",
            "ClientSecret": "[[parameters('clientSecret')]",
            "grantType": "client_credentials",
            "tokenEndpoint": "[[concat('https://auth.pingone.com/',parameters('environmentId'),'/as/token')]",
            "tokenEndpointHeaders": {
              "Content-Type": "application/x-www-form-urlencoded"
            }
          },
        "request": {
            "apiEndpoint": "https://api.pingone.com/v1/environments/{{environmentId}}/activities",
            "httpMethod": "GET",
            "queryWindowInMin": 10,
            "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",     
            "headers": {
                    "Accept": "application/json",
                    "User-Agent": "Scuba"
            }
        },
        "response": {
      "eventsJsonPaths": [
        "$._embedded.activities"
      ],
      "format": "json"
    },
        "dcrConfig": {
            "streamName": "Custom-PingOne_AuditActivities_CL",
            "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
            "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}"
        },
        "paging": {
      "pagingType": "LinkHeader",
      "linkHeaderTokenJsonPath": "$._links.next.href"
    }
    }
}
]