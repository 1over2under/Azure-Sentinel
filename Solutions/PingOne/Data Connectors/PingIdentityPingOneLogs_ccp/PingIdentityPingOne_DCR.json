[
  {
    "name": "PingOneDCR",
    "apiVersion": "2023-03-11",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
      "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
      "streamDeclarations": {
        "Custom-PingOne_Users_CL": {
          "columns": [
            {
              "name": "id",
              "type": "string"
            },
            {
              "name": "email",
              "type": "string"
            },
            {
              "name": "emailVerified",
              "type": "boolean"
            },
            {
              "name": "enabled",
              "type": "boolean"
            }
          ]
        },
        "Custom-PingOne_AuditActivities_CL": {
          "columns": [
            { "name": "id", "type": "string" },
            { "name": "correlationId", "type": "string" }
          ]
        }
      },
      "destinations": {
        "logAnalytics": [
          {
            "workspaceResourceId": "{{workspaceResourceId}}",
            "name": "clv2ws1"
          }
        ]
      },
      "dataFlows": [
        {
          "streams": [
            "Custom-PingOne_Users_CL"
          ],
          "destinations": [
            "clv2ws1"
          ],
          "transformKql": "source | extend Id = tostring(id), Email = tostring(email), EmailVerified = tobool(emailVerified), Enabled = tobool(enabled), TimeGenerated = now()| project Id, Email, EmailVerified, Enabled, TimeGenerated",
          "outputStream": "Custom-PingOne_Users_CL"
        },
        {
          "streams": [
            "Custom-PingOne_AuditActivities_CL"
          ],
          "destinations": [
            "clv2ws1"
          ],
       "transformKql": "source | extend Id = tostring(id),  CorrelationId = tostring(correlationId), TimeGenerated = now() | project Id, CorrelationId, TimeGenerated",
       "outputStream": "Custom-PingOne_AuditActivities_CL"
        }
      ]
    }
  }
]