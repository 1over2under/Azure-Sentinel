{
  "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
  "apiVersion": "2025-03-01",
  "name": "PingIdentityPingOneLogsCCPDefinition",
  "location": "{{location}}",
  "kind": "Customizable",
  "properties": {
    "connectorUiConfig": {
      "id": "PingIdentityPingOneLogsCCPDefinition",
      "title": "Ping One",
      "publisher": "Microsoft",
      "descriptionMarkdown": "This connector ingests **user data** and **audit activity logs** from the PingOne Identity platform into Microsoft Sentinel using a codeless connector.",
      "graphQueriesTableName": "PingOne_Users_CL",
      "graphQueries": [
        {
          "metricName": "Total user events received",
          "legend": "User Events",
          "baseQuery": "PingOne_Users_CL"
        },
        {
          "metricName": "Total audit events received",
          "legend": "Audit Events",
          "baseQuery": "PingOne_AuditActivities_CL"
        }
      ],
      "sampleQueries": [
        {
          "description": "Get sample user events",
          "query": "PingOne_Users_CL\n | take 10"
        },
        {
          "description": "Get sample audit activity events",
          "query": "PingOne_AuditActivities_CL\n | take 10"
        }
      ],
      "dataTypes": [
        {
          "name": "PingOne_Users_CL",
          "lastDataReceivedQuery": "PingOne_Users_CL\n | where TimeGenerated > ago(12h)\n | summarize Time=max(TimeGenerated)"
        },
        {
          "name": "PingOne_AuditActivities_CL",
          "lastDataReceivedQuery": "PingOne_AuditActivities_CL\n | where TimeGenerated > ago(12h)\n | summarize Time=max(TimeGenerated)"
        }
      ],
      "connectivityCriteria": [
        {
          "type": "HasDataConnectors"
        }
      ],
      "availability": {
        "isPreview": false
      },
      "permissions": {
        "resourceProvider": [
          {
            "provider": "Microsoft.OperationalInsights/workspaces",
            "permissionsDisplayText": "Read and Write permissions are required.",
            "providerDisplayName": "Workspace",
            "scope": "Workspace",
            "requiredPermissions": {
              "read": true,
              "write": true,
              "delete": false,
              "action": false
            }
          }
        ]
      },
      "instructionSteps": [
        {
          "title": "Connect Ping One connector to Microsoft Sentinel",
          "instructions": [
            {
              "type": "Markdown",
              "parameters": {
                "content": "To gather data from Ping One, you need to provide the following resources"
              }
            },
            {
              "type": "Markdown",
              "parameters": {
                "content": "#### 1. Client Credentials \n You'll need client credentials, including your client id and client secret."
              }
            },
            {
              "type": "Markdown",
              "parameters": {
                "content": "#### 2. Environment Id  \n To generate token and gather logs from user and audit activities endpoint"
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Client ID",
                "placeholder": "Enter ID of the client",
                "type": "text",
                "name": "clientId",
                "required": true
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Client Secret",
                "placeholder": "Enter your secret key",
                "type": "password",
                "name": "clientSecret",
                "required": true
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Environment ID",
                "placeholder": "Enter your environment Id ",
                "type": "text",
                "name": "environmentId",
                "required": true
              }
            },
            {
              "type": "ConnectionToggleButton",
              "parameters": {
                "connectLabel": "Connect",
                "name": "toggle"
              }
            }
          ]
        }
      ]
    }
  }
}