{
    "id": "AzureResourceGraph",
    "title": "Azure Resource Graph",
    "publisher": "Microsoft",
    "descriptionMarkdown": "Azure Resource Graph connector gives richer insights into Azure events by supplementing details about Azure subscriptions and Azure resources.",
    "logo": "https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Workbooks/Images/Logos/office365_logo.svg",
    "graphQueries": [
        {
            "metricName": "Total data received",
            "legend": "Azure Resource Graph User Activity logs",
            "baseQuery": "MicrosoftAuditEventLogs\n| where EventProduct == \"AzureMicrosoft_test\""
        }
    ],
    "sampleQueries": [
        {
            "description": "Get a sample of Azure Resource Graph User Activity logs",
            "query": "MicrosoftAuditEventLogs\n | where EventProduct == \"AzureMicrosoft_test\" | take 10"
        }
    ],
    "dataTypes": [
        {
            "name": "MicrosoftAuditEventLogs",
            "lastDataReceivedQuery": "MicrosoftAuditEventLogs\n | where EventProduct == \"AzureMicrosoft_test\" |summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
        }
    ],
    "connectivityCriteria": [
        {
            "type": "HasDataConnectors"
        }
    ],
    "permissions": {
        "tenant": [
            "GlobalAdmin"
        ],
        "custom": [
            {
                "name": "Policy",
                "description": "owner role permission on Azure subscriptions"
            }
        ]
    },
    "instructionSteps": [
        {
            "description": "Connect Azure Resource Graph to Microsoft Sentinel",
            "instructions": [
                {
                    "type": "Markdown",
                    "parameters": {
                        "content": "✔ Resources\n\n ✔ resourcecontainers\n\n ✔ authorizationresources"
                    }
                }
            ]
        }
    ]
}