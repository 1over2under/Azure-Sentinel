
{
  "id": "b608e714-b3ec-4380-b666-1aa781513ab4",
    "name": "KeeperSecurityPushConnectorPolling",
    "apiVersion": "2023-02-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "kind": "Push",
    "properties": {
      "connectorDefinitionName": "KeeperSecurityPush2",
      "dcrConfig": {
        "streamName": "Custom-KeeperSecurityEventNewLogs",
        "dataCollectionEndpoint": "[[parameters('dcrConfig').dataCollectionEndpoint]",
        "dataCollectionRuleImmutableId": "[[parameters('dcrConfig').dataCollectionRuleImmutableId]"
      },
      "auth": {
        "type": "Push",
        "AppId": "[[parameters('auth').appId]",
        "ServicePrincipalId": "[[parameters('auth').servicePrincipalId]"
      },
      "request": {
        "RetryCount":1
      },
      "response": {
        "eventsJsonPaths": [
          "$.messages"
        ]
      }
    }
  }
  