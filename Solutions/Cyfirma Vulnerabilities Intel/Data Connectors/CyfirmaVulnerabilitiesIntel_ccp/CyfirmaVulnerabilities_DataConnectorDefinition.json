{
    "name": "CyfirmaVulnerabilitiesIntelDC",
    "apiVersion": "2024-01-01-preview",
    "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
    "kind": "Customizable",
    "properties": {
        "connectorUiConfig": {
            "id": "CyfirmaVulnerabilitiesIntelDC",
            "title": "Cyfirma Vulnerabilities Intellegence Connector",
            "publisher": "Microsoft",
            "isConnectivityCriteriasMatchSome": false,
            "descriptionMarkdown": "The Cyfirma Vulnerabilities Intellegence data connector enables seamless log ingestion from the DeCYFIR API into Microsoft Sentinel. Built on the Microsoft Sentinel Codeless Connector Platform, it leverages the DeCYFIR Alerts API to retrieve logs. Additionally, it supports DCR-based [ingestion time transformations](https://docs.microsoft.com/azure/azure-monitor/logs/custom-logs-overview), which parse security data into a custom table during ingestion. This eliminates the need for query-time parsing, enhancing performance and efficiency.",
            "graphQueries": [
                {
                    "metricName": "Total Cyfirma Vulnerabilities logs received",
                    "legend": "Cyfirma Vulnerabilities Logs",
                    "baseQuery": "CyfirmaVulnerabilities_CL"
                }
            ],
            "sampleQueries": [
                {
                    "description": "Get Sample of Vulnerabilities logs",
                    "query": "CyfirmaVulnerabilities_CL | take 10"
                }
            ],
            "dataTypes": [
                {
                    "name": "CyfirmaVulnerabilities_CL",
                    "lastDataReceivedQuery": "CyfirmaVulnerabilities_CL\n | where TimeGenerated > ago(5m) | summarize Time = max(TimeGenerated)\n  | where isnotempty(Time)"
                }
            ],
            "connectivityCriteria": [
                {
                    "type": "HasDataConnectors",
                    "value": null
                }
            ],
            "availability": {
                "status": 1,
                "isPreview": false
            },
            "permissions": {
                "tenant": null,
                "licenses": null,
                "resourceProvider": [
                    {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                            "read": true,
                            "write": true,
                            "delete": true,
                            "action": false
                        }
                    }
                ]
            },
            "instructionSteps": [
                {
                    "innerSteps": null,
                    "title": "Cyfirma Vulnerabilities Intellegence Connector",
                    "description": "This connector provides the Vulnerabilities logs from Cyfirma Vulnerabilities Intellegence. The connector uses the DeCYFIR API to retrieve logs and supports DCR-based ingestion time transformations, parsing security data into a custom table during ingestion. This eliminates the need for query-time parsing, enhancing performance and efficiency.",
                    "descriptionMarkdown": "This connector provides the Vulnerabilities logs from Cyfirma Vulnerabilities Intellegence. The connector uses the DeCYFIR API to retrieve logs and supports DCR-based ingestion time transformations, parsing security data into a custom table during ingestion. This eliminates the need for query-time parsing, enhancing performance and efficiency.",
                    "estimatedTime": "5 minutes",
                    "icon": "https://www.microsoft.com/favicon.ico",
                    "instructions": [
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "DeCYFIR/DeTCT API URL",
                                "placeholder": "https://decyfir.cyfirma.com",
                                "type": "text",
                                "name": "cyfirmaAPIURL",
                                "defaultValue": "https://decyfir.cyfirma.com",
                                "description": "DeCYFIR/DeTCT API URL. Default is https://decyfir.cyfirma.com"
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Cyfirma API Key",
                                "placeholder": "Cyfirma API Key",
                                "type": "password",
                                "name": "cyfirmaAPIKey"
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "API Delta",
                                "placeholder": "API Delta",
                                "type": "text",
                                "name": "apiDelta",
                                "defaultValue": "false",
                                "description": ""
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Vendor-Associated Vulnerabilities",
                                "placeholder": "Is Org associate Vendors",
                                "type": "text",
                                "name": "isVendor",
                                "defaultValue": "false",
                                "description": "Vendor-Associated Vulnerabilities"
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Product-Associated Vulnerabilities",
                                "placeholder": "API Delta",
                                "type": "text",
                                "name": "isProduct",
                                "defaultValue": "false",
                                "description": "Product-Associated Vulnerabilities"
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Product with Version-Associated Vulnerabilities",
                                "placeholder": "API Delta",
                                "type": "text",
                                "name": "isVersion",
                                "defaultValue": "false",
                                "description": "Product with Version-Associated Vulnerabilities"
                            }
                        },
                        {
                            "type": "ConnectionToggleButton",
                            "parameters": {
                                "connectLabel": "Connect",
                                "name": "toggle"
                            }
                        }
                    ]
                }
            ]
        }
    }
}