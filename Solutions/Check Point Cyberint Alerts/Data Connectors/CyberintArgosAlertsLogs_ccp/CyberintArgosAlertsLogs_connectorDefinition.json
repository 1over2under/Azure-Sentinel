{
  "name": "CheckPointCyberintSentinelConnectorDefinition",
  "apiVersion": "2022-09-01-preview",
  "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
  "location": "{{location}}",
  "kind": "Customizable",
  "properties": {
    "connectorUiConfig": {
      "id": "CheckPointCyberintSentinelConnectorDefinition",
      "title": "Check Point Cyberint Alerts Connector",
      "publisher": "Checkpoint Cyberint",
      "descriptionMarkdown": "Cyberint, a Check Point company, provides a Sentinel integration to streamline critical Alerts and bring enriched threat intelligence from the Infinity External Risk Management solution into Sentinel. This simplifies the process of tracking the status of tickets with automatic sync updates across systems. Using this new integration for Sentinel, existing Cyberint and Sentinel customers can easily pull logs based on Cyberint's findings into Sentinel platform.",
      "graphQueriesTableName": "argsentdc_CL",
      "graphQueries": [
        {
          "metricName": "Alerts received",
          "legend": "My data connector alerts",
          "baseQuery": "{{graphQueriesTableName}}"
        }
      ],
      "sampleQueries": [
        {
          "description": "All alert logs",
          "query": "{{graphQueriesTableName}} \n | take 10"
        }
      ],
      "dataTypes": [
        {
          "name": "{{graphQueriesTableName}}",
          "lastDataReceivedQuery": "{{graphQueriesTableName}} \n | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
        }
      ],
      "connectivityCriteria": [
        {
          "type": "HasDataConnectors"
        }
      ],
      "permissions": {
        "resourceProvider": [
          {
            "provider": "Microsoft.OperationalInsights/workspaces",
            "permissionsDisplayText": "Read and Write permissions are required.",
            "providerDisplayName": "Workspace",
            "scope": "Workspace",
            "requiredPermissions": {
              "write": true,
              "read": true,
              "delete": true
            }
          }
        ],
        "customs": [
          {
            "name": "Check Point Cyberint API Key and Domain Name",
            "description": "The connector API key and domain is required"
          }
        ]
      },
      "instructionSteps": [
        {
          "title": "Connect Checkpoint Cyberint Alerts to Microsoft Sentinel",
          "description": "To enable the connector provide the required information below and click on Connect.\n>",
          "instructions": [
            {
              "type": "Textbox",
              "parameters": {
                "label": "Domain name",
                "placeholder": "Domain name",
                "type": "text",
                "name": "domainname"
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "API key",
                "placeholder": "API key",
                "type": "text",
                "name": "apikey"
              }
            },
            {
              "type": "ConnectionToggleButton",
              "parameters": {
                "connectLabel": "Connect",
                "name": "Connect"
              }
            }
          ]
        }
      ]
    }
  }
}