[{
    "name": "QualysVMDCR",
    "apiVersion": "2021-09-01-preview",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
      "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
      "streamDeclarations": {
        "Custom-QualysVM": {
          "columns": [
            {
              "name": "HOST_LIST_VM_DETECTION_OUTPUT",
              "type": "dynamic",
              "description": "description if any"
            },
            {
                "name": "TimeGenerated",
                "type": "datetime",
                "description": "description if any"
              }
          ]
        }
      },
      "destinations": {
        "logAnalytics": [
          {
            "workspaceResourceId": "{{workspaceResourceId}}",
            "name": "clv2ws1"
          }
        ]
      },
      "dataFlows": [
        {
          "streams": [
            "Custom-QualysVM"
          ],
          "destinations": [
            "clv2ws1"
          ],
          "transformKql": "source | extend Output = parse_xml(HOST_LIST_VM_DETECTION_OUTPUT) | extend HostID = tostring(Output['RESPONSE']['HOST_LIST']['HOST']['ID']) | extend TimeGenerated = now() | project-away HOST_LIST_VM_DETECTION_OUTPUT",
          "outputStream": "Custom-Qualys_HostDetectionV2_CL"
        }
      ]
    }
  }]