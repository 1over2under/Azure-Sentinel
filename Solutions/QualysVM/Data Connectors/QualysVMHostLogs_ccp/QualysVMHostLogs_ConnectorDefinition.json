{
  "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
  "apiVersion": "2022-09-01-preview",
  "name": "QualysVMLogsCCPDefinition",
  "location": "{{location}}",
  "kind": "Customizable",
  "properties": {
    "connectorUiConfig": {
      "id": "QualysVMLogsCCPDefinition",
      "title": "Qualys Vulnerability Management",
      "publisher": "Microsoft",
      "descriptionMarkdown": "The [Qualys Vulnerability Management (VM)](https://www.qualys.com/apps/vulnerability-management/) data connector provides the capability to ingest vulnerability host detection data into Microsoft Sentinel through the Qualys API. The connector provides visibility into host detection data from vulerability scans.",
      "graphQueriesTableName": "Qualys_HostDetectionV2_CL",
      "graphQueries": [
        {
          "metricName": "Total events received",
          "legend": "Qualys Host Detection Logs",
          "baseQuery": "{{graphQueriesTableName}}"
        }
      ],
      "sampleQueries": [
        {
          "description": "Get Sample of Qualys Host Detection logs",
          "query": "{{graphQueriesTableName}}\n | take 10"
        }
      ],
      "dataTypes": [
        {
          "name": "{{graphQueriesTableName}}",
          "lastDataReceivedQuery": "{{graphQueriesTableName}}\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
        }
      ],
      "connectivityCriteria": [
        {
          "type": "HasDataConnectors"
        }
      ],
      "availability": {
        "status": 1,
        "isPreview": false
      },
      "permissions": {
        "resourceProvider": [
          {
            "provider": "Microsoft.OperationalInsights/workspaces",
            "permissionsDisplayText": "Read and Write permissions are required.",
            "providerDisplayName": "Workspace",
            "scope": "Workspace",
            "requiredPermissions": {
              "read": true,
              "write": true,
              "delete": true,
              "action": false
            }
          }
        ]
      },
      "instructionSteps": [
        {
          "title": "Connect Qualys Vulnerability Management to Microsoft Sentinel",
          "instructions": [
            {
              "type": "Markdown",
              "parameters": {
                "content": ">**NOTE:** To Collect the data from Qualys VM, you are required to provide the below mentioned resources."
              }
            },
            {
              "type": "Markdown",
              "parameters": {
                "content": "#### 1. API Credentials \n Qualys API credentials such as Username and Password are required to collect the data from the platform."
              }
            },
            {
              "type": "Markdown",
              "parameters": {
                "content": "#### 2. API Server URL \n Quays API server URL for your region is required to collect the data from the platform. You can check the exact API server URL for your region [here](https://www.qualys.com/platform-identification/)"
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Qualys API User Name",
                "placeholder": "Enter UserName",
                "type": "text",
                "name": "username"
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Qualys API Password",
                "placeholder": "Enter password",
                "type": "password",
                "name": "password"
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Qualys API Server URL",
                "placeholder": "Enter API Server URL",
                "type": "text",
                "name": "apiServerUrl"
              }
            },
            {
              "type": "ConnectionToggleButton",
              "parameters": {
                "connectLabel": "Connect",
                "name": "toggle"
              }
            }
          ]
        }
      ]
    }
  }
}